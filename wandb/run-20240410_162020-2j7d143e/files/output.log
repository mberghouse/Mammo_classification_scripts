
  4%|███▍                                                                               | 3/73 [00:01<00:27,  2.57it/s]
Sequential(
  (0): DaVit(
    (stem): Stem(
      (conv): Conv2d(3, 128, kernel_size=(7, 7), stride=(4, 4), padding=(3, 3))
      (norm): LayerNorm2d((128,), eps=1e-05, elementwise_affine=True)
    )
    (stages): Sequential(
      (0): DaVitStage(
        (downsample): Identity()
        (blocks): Sequential(
          (0): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=128)
                (act): Identity()
              )
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): Identity()
              (cpe2): ConvPosEnc(
                (proj): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=128)
                (act): Identity()
              )
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): Identity()
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=128)
                (act): Identity()
              )
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (proj): Linear(in_features=128, out_features=128, bias=True)
              )
              (drop_path1): Identity()
              (cpe2): ConvPosEnc(
                (proj): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=128)
                (act): Identity()
              )
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): Identity()
            )
          )
        )
      )
      (1): DaVitStage(
        (downsample): Downsample(
          (norm): LayerNorm2d((128,), eps=1e-05, elementwise_affine=True)
          (conv): Conv2d(128, 256, kernel_size=(2, 2), stride=(2, 2))
        )
        (blocks): Sequential(
          (0): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=256)
                (act): Identity()
              )
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.045)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=256)
                (act): Identity()
              )
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.045)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=256)
                (act): Identity()
              )
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (proj): Linear(in_features=256, out_features=256, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.045)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=256)
                (act): Identity()
              )
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.045)
            )
          )
        )
      )
      (2): DaVitStage(
        (downsample): Downsample(
          (norm): LayerNorm2d((256,), eps=1e-05, elementwise_affine=True)
          (conv): Conv2d(256, 512, kernel_size=(2, 2), stride=(2, 2))
        )
        (blocks): Sequential(
          (0): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.091)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.091)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.091)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.091)
            )
          )
          (1): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.136)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.136)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.136)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.136)
            )
          )
          (2): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.182)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.182)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.182)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.182)
            )
          )
          (3): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.227)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.227)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.227)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.227)
            )
          )
          (4): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.273)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.273)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.273)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.273)
            )
          )
          (5): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.318)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.318)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.318)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.318)
            )
          )
          (6): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.364)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.364)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.364)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.364)
            )
          )
          (7): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.409)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.409)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.409)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.409)
            )
          )
          (8): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.455)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.455)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.455)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.455)
            )
          )
        )
      )
      (3): DaVitStage(
        (downsample): Downsample(
          (norm): LayerNorm2d((512,), eps=1e-05, elementwise_affine=True)
          (conv): Conv2d(512, 1024, kernel_size=(2, 2), stride=(2, 2))
        )
        (blocks): Sequential(
          (0): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=1024)
                (act): Identity()
              )
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.500)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=1024)
                (act): Identity()
              )
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.500)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=1024)
                (act): Identity()
              )
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.500)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=1024)
                (act): Identity()
              )
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.500)
            )
          )
        )
      )
    )
    (norm_pre): Identity()
    (head): NormMlpClassifierHead(
      (global_pool): SelectAdaptivePool2d(pool_type=avg, flatten=Identity())
      (norm): LayerNorm2d((1024,), eps=1e-05, elementwise_affine=True)
      (flatten): Flatten(start_dim=1, end_dim=-1)
      (pre_logits): Identity()
      (drop): Dropout(p=0.0, inplace=False)
      (fc): Linear(in_features=1024, out_features=1, bias=True)
    )
  )
  (1): Sigmoid()
)
Starting training...
--------------------










100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:21<00:00,  3.32it/s]
 67%|██████████████████████████████████████████████████████▋                           | 12/18 [00:01<00:00,  8.80it/s]
New threshold is 0.42630836367607117
train F1 is 0.4819047749042511
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.84it/s]
  4%|███▍                                                                               | 3/73 [00:01<00:23,  3.01it/s]
New threshold is 0.47823014855384827
val F1 is 0.4728682041168213
Epoch 1/100, learning rate: 1.989745091059581e-05
Train Loss: 0.6823, Train Acc: 0.5334, Train f1: 0.4819, Train Precision: 0.4486, Train Recall: 0.5206, Train AUC: 0.5231
Valitadion Loss: 0.6860, Validation Acc: 0.5245, Vall f1: 0.4729, Val Precision: 0.4388, Val Recall: 0.5126, Val AUC: 0.5154










100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:21<00:00,  3.36it/s]
 56%|█████████████████████████████████████████████▌                                    | 10/18 [00:01<00:00,  8.66it/s]
New threshold is 0.4266878366470337
train F1 is 0.46061813831329346
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.91it/s]
  3%|██▎                                                                                | 2/73 [00:00<00:26,  2.69it/s]
New threshold is 0.43863213062286377
val F1 is 0.5243445634841919
Epoch 2/100, learning rate: 1.9591906905635932e-05
Train Loss: 0.6802, Train Acc: 0.5360, Train f1: 0.4606, Train Precision: 0.4468, Train Recall: 0.4753, Train AUC: 0.5342
Valitadion Loss: 0.6724, Validation Acc: 0.5559, Vall f1: 0.5243, Val Precision: 0.4730, Val Recall: 0.5882, Val AUC: 0.5842










100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:21<00:00,  3.36it/s]
 44%|████████████████████████████████████▉                                              | 8/18 [00:00<00:01,  8.71it/s]
New threshold is 0.4376876652240753
train F1 is 0.4966442883014679
val for epoch 3
New threshold is 0.44371068477630615
val F1 is 0.4910714328289032
Epoch 3/100, learning rate: 1.908963463733e-05
Train Loss: 0.6728, Train Acc: 0.5497, Train f1: 0.4966, Train Precision: 0.4650, Train Recall: 0.5329, Train AUC: 0.5619
Valitadion Loss: 0.6732, Validation Acc: 0.6014, Vall f1: 0.4911, Val Precision: 0.5238, Val Recall: 0.4622, Val AUC: 0.5801
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.98it/s]










 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:20<00:00,  3.37it/s]
New threshold is 0.4270169138908386
train F1 is 0.4941634237766266
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:21<00:00,  3.36it/s]
 44%|████████████████████████████████████▉                                              | 8/18 [00:00<00:01,  8.90it/s]
New threshold is 0.4001343846321106
val F1 is 0.523809552192688
Epoch 4/100, learning rate: 1.8400935618942642e-05
Train Loss: 0.6744, Train Acc: 0.5540, Train f1: 0.4942, Train Precision: 0.4686, Train Recall: 0.5226, Train AUC: 0.5594
Valitadion Loss: 0.6667, Validation Acc: 0.5804, Vall f1: 0.5238, Val Precision: 0.4962, Val Recall: 0.5546, Val AUC: 0.5987
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.89it/s]










 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:20<00:00,  3.36it/s]
New threshold is 0.4307175278663635
train F1 is 0.5267103910446167
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:21<00:00,  3.35it/s]
 44%|████████████████████████████████████▉                                              | 8/18 [00:00<00:01,  8.64it/s]
New threshold is 0.4157276451587677
val F1 is 0.5468164682388306
Epoch 5/100, learning rate: 1.7539934942621955e-05
Train Loss: 0.6679, Train Acc: 0.5669, Train f1: 0.5267, Train Precision: 0.4836, Train Recall: 0.5782, Train AUC: 0.5905
Valitadion Loss: 0.6644, Validation Acc: 0.5769, Vall f1: 0.5468, Val Precision: 0.4932, Val Recall: 0.6134, Val AUC: 0.6105
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.88it/s]










 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:20<00:01,  3.37it/s]
New threshold is 0.41981276869773865
train F1 is 0.5376128554344177
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:21<00:00,  3.35it/s]
 33%|███████████████████████████▋                                                       | 6/18 [00:00<00:01,  8.78it/s]
New threshold is 0.45269864797592163
val F1 is 0.5387755036354065
Epoch 6/100, learning rate: 1.65242915763175e-05
Train Loss: 0.6568, Train Acc: 0.6046, Train f1: 0.5376, Train Precision: 0.5245, Train Recall: 0.5514, Train AUC: 0.6238
Valitadion Loss: 0.6511, Validation Acc: 0.6049, Vall f1: 0.5388, Val Precision: 0.5238, Val Recall: 0.5546, Val AUC: 0.6389
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.97it/s]










 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:20<00:01,  3.40it/s]
New threshold is 0.43188172578811646
train F1 is 0.5792452692985535
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:21<00:00,  3.36it/s]
 33%|███████████████████████████▋                                                       | 6/18 [00:00<00:01,  9.03it/s]
New threshold is 0.42928817868232727
val F1 is 0.60447758436203
Epoch 7/100, learning rate: 1.5374836181545594e-05
Train Loss: 0.6488, Train Acc: 0.6175, Train f1: 0.5792, Train Precision: 0.5348, Train Recall: 0.6317, Train AUC: 0.6473
Valitadion Loss: 0.6549, Validation Acc: 0.6294, Vall f1: 0.6045, Val Precision: 0.5436, Val Recall: 0.6807, Val AUC: 0.6501
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.97it/s]










 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:20<00:01,  3.39it/s]
New threshold is 0.4145438075065613
train F1 is 0.5941343307495117
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:21<00:00,  3.35it/s]
 22%|██████████████████▍                                                                | 4/18 [00:00<00:01,  8.63it/s]
New threshold is 0.3708820044994354
val F1 is 0.5619834661483765
Epoch 8/100, learning rate: 1.411514388029391e-05
Train Loss: 0.6390, Train Acc: 0.6321, Train f1: 0.5941, Train Precision: 0.5499, Train Recall: 0.6461, Train AUC: 0.6665
Valitadion Loss: 0.6580, Validation Acc: 0.6294, Vall f1: 0.5620, Val Precision: 0.5528, Val Recall: 0.5714, Val AUC: 0.6568
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.84it/s]










 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:20<00:01,  3.36it/s]
New threshold is 0.43348515033721924
train F1 is 0.6056603789329529
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:21<00:00,  3.34it/s]
 17%|█████████████▊                                                                     | 3/18 [00:00<00:01,  8.58it/s]
New threshold is 0.3768513798713684
val F1 is 0.5945945978164673
Epoch 9/100, learning rate: 1.277105073353882e-05
Train Loss: 0.6314, Train Acc: 0.6415, Train f1: 0.6057, Train Precision: 0.5592, Train Recall: 0.6605, Train AUC: 0.6790
Valitadion Loss: 0.6481, Validation Acc: 0.6329, Vall f1: 0.5946, Val Precision: 0.5500, Val Recall: 0.6471, Val AUC: 0.6693
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.27it/s]











 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:22<00:00,  3.19it/s]
New threshold is 0.4102179706096649
train F1 is 0.6199262142181396
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:22<00:00,  3.18it/s]
 44%|████████████████████████████████████▉                                              | 8/18 [00:00<00:01,  8.27it/s]
New threshold is 0.476203054189682
val F1 is 0.5968992114067078
Epoch 10/100, learning rate: 1.137012384831351e-05
Train Loss: 0.6212, Train Acc: 0.6467, Train f1: 0.6199, Train Precision: 0.5619, Train Recall: 0.6914, Train AUC: 0.6935
Valitadion Loss: 0.6449, Validation Acc: 0.6364, Vall f1: 0.5969, Val Precision: 0.5540, Val Recall: 0.6471, Val AUC: 0.6723
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.39it/s]











 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:22<00:00,  3.19it/s]
New threshold is 0.45190492272377014
train F1 is 0.6172106862068176
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:22<00:00,  3.19it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 14/18 [00:01<00:00,  8.03it/s]
New threshold is 0.5079812407493591
val F1 is 0.5925925970077515
Epoch 11/100, learning rate: 9.941095981334956e-06
Train Loss: 0.6100, Train Acc: 0.6681, Train f1: 0.6172, Train Precision: 0.5943, Train Recall: 0.6420, Train AUC: 0.7110
Valitadion Loss: 0.6586, Validation Acc: 0.6154, Vall f1: 0.5926, Val Precision: 0.5298, Val Recall: 0.6723, Val AUC: 0.6626
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.30it/s]










 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:21<00:01,  3.19it/s]
New threshold is 0.43479159474372864
train F1 is 0.6452223062515259
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:22<00:00,  3.19it/s]
 17%|█████████████▊                                                                     | 3/18 [00:00<00:01,  7.79it/s]
New threshold is 0.3504655659198761

100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.28it/s]
Epoch 12/100, learning rate: 8.513276235366988e-06
Train Loss: 0.5986, Train Acc: 0.6784, Train f1: 0.6452, Train Precision: 0.5972, Train Recall: 0.7016, Train AUC: 0.7296
Valitadion Loss: 0.6509, Validation Acc: 0.6399, Vall f1: 0.6084, Val Precision: 0.5556, Val Recall: 0.6723, Val AUC: 0.6820
train for epoch 13










 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:21<00:01,  3.19it/s]
New threshold is 0.44170013070106506
train F1 is 0.658349335193634
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:22<00:00,  3.18it/s]
 39%|████████████████████████████████▎                                                  | 7/18 [00:00<00:01,  8.19it/s]
New threshold is 0.44891753792762756
val F1 is 0.6240601539611816
Epoch 13/100, learning rate: 7.115948934830289e-06
Train Loss: 0.5887, Train Acc: 0.6947, Train f1: 0.6583, Train Precision: 0.6169, Train Recall: 0.7058, Train AUC: 0.7463
Valitadion Loss: 0.6399, Validation Acc: 0.6503, Vall f1: 0.6241, Val Precision: 0.5646, Val Recall: 0.6975, Val AUC: 0.6957
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.32it/s]











 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:22<00:00,  3.20it/s]
New threshold is 0.4465085566043854
train F1 is 0.667313277721405
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:22<00:00,  3.18it/s]
 56%|█████████████████████████████████████████████▌                                    | 10/18 [00:01<00:00,  8.54it/s]
New threshold is 0.42524462938308716
val F1 is 0.6117647290229797
Epoch 14/100, learning rate: 5.777773009611733e-06
Train Loss: 0.5827, Train Acc: 0.7058, Train f1: 0.6673, Train Precision: 0.6312, Train Recall: 0.7078, Train AUC: 0.7502
Valitadion Loss: 0.6458, Validation Acc: 0.6538, Vall f1: 0.6118, Val Precision: 0.5735, Val Recall: 0.6555, Val AUC: 0.6881
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.46it/s]











100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:22<00:00,  3.18it/s]
New threshold is 0.4625820815563202
train F1 is 0.6467181444168091
val for epoch 15
 89%|████████████████████████████████████████████████████████████████████████▉         | 16/18 [00:01<00:00,  8.53it/s]
New threshold is 0.4807979166507721
val F1 is 0.6360152959823608
Epoch 15/100, learning rate: 4.526194205602367e-06
Train Loss: 0.5897, Train Acc: 0.6861, Train f1: 0.6467, Train Precision: 0.6091, Train Recall: 0.6893, Train AUC: 0.7431
Valitadion Loss: 0.6331, Validation Acc: 0.6678, Vall f1: 0.6360, Val Precision: 0.5845, Val Recall: 0.6975, Val AUC: 0.7000
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.34it/s]










 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:21<00:01,  3.18it/s]
New threshold is 0.43821263313293457
train F1 is 0.6736441254615784
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:22<00:00,  3.17it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.15it/s]
  0%|                                                                                           | 0/73 [00:00<?, ?it/s]
New threshold is 0.499936580657959
val F1 is 0.6225680708885193
Epoch 16/100, learning rate: 3.3868821774194157e-06
Train Loss: 0.5713, Train Acc: 0.7058, Train f1: 0.6736, Train Precision: 0.6265, Train Recall: 0.7284, Train AUC: 0.7629
Valitadion Loss: 0.6373, Validation Acc: 0.6608, Vall f1: 0.6226, Val Precision: 0.5797, Val Recall: 0.6723, Val AUC: 0.7025











 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:21<00:01,  3.19it/s]
New threshold is 0.3996415138244629
train F1 is 0.6917562484741211
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:22<00:00,  3.17it/s]
 39%|████████████████████████████████▎                                                  | 7/18 [00:00<00:01,  8.20it/s]
New threshold is 0.5295932292938232
val F1 is 0.6352941393852234
Epoch 17/100, learning rate: 2.383204008438719e-06
Train Loss: 0.5677, Train Acc: 0.7050, Train f1: 0.6918, Train Precision: 0.6127, Train Recall: 0.7942, Train AUC: 0.7665
Valitadion Loss: 0.6310, Validation Acc: 0.6748, Vall f1: 0.6353, Val Precision: 0.5956, Val Recall: 0.6807, Val AUC: 0.7093
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.30it/s]











 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:22<00:00,  3.17it/s]
New threshold is 0.44099393486976624
train F1 is 0.6812143921852112
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.16it/s]
 61%|██████████████████████████████████████████████████                                | 11/18 [00:01<00:00,  8.20it/s]
New threshold is 0.46439746022224426
val F1 is 0.6384615302085876
Epoch 18/100, learning rate: 1.5357449561463067e-06
Train Loss: 0.5644, Train Acc: 0.7118, Train f1: 0.6812, Train Precision: 0.6320, Train Recall: 0.7387, Train AUC: 0.7706
Valitadion Loss: 0.6267, Validation Acc: 0.6713, Vall f1: 0.6385, Val Precision: 0.5887, Val Recall: 0.6975, Val AUC: 0.7131
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.25it/s]











 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:22<00:00,  3.19it/s]
New threshold is 0.4389820396900177
train F1 is 0.6967741847038269
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.16it/s]
 50%|█████████████████████████████████████████▌                                         | 9/18 [00:01<00:01,  8.19it/s]
New threshold is 0.4369947016239166
val F1 is 0.6384615302085876
Epoch 19/100, learning rate: 8.618862522352262e-07
Train Loss: 0.5627, Train Acc: 0.7178, Train f1: 0.6968, Train Precision: 0.6311, Train Recall: 0.7778, Train AUC: 0.7732
Valitadion Loss: 0.6254, Validation Acc: 0.6713, Vall f1: 0.6385, Val Precision: 0.5887, Val Recall: 0.6975, Val AUC: 0.7157
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.23it/s]











 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:22<00:00,  3.19it/s]
New threshold is 0.41562625765800476
train F1 is 0.6877323389053345
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.17it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 13/18 [00:01<00:00,  8.49it/s]
New threshold is 0.4425746202468872
val F1 is 0.6360152959823608
Epoch 20/100, learning rate: 3.754486166911455e-07
Train Loss: 0.5620, Train Acc: 0.7118, Train f1: 0.6877, Train Precision: 0.6271, Train Recall: 0.7613, Train AUC: 0.7726
Valitadion Loss: 0.6275, Validation Acc: 0.6678, Vall f1: 0.6360, Val Precision: 0.5845, Val Recall: 0.6975, Val AUC: 0.7143
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.26it/s]










 92%|███████████████████████████████████████████████████████████████████████████▎      | 67/73 [00:21<00:01,  3.18it/s]
New threshold is 0.44470927119255066
train F1 is 0.6773282885551453
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:22<00:00,  3.18it/s]
 11%|█████████▏                                                                         | 2/18 [00:00<00:01,  8.04it/s]
New threshold is 0.44776755571365356

100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.36it/s]
Epoch 21/100, learning rate: 8.640879732829682e-08
Train Loss: 0.5653, Train Acc: 0.7058, Train f1: 0.6773, Train Precision: 0.6239, Train Recall: 0.7407, Train AUC: 0.7701
Valitadion Loss: 0.6267, Validation Acc: 0.6713, Vall f1: 0.6412, Val Precision: 0.5874, Val Recall: 0.7059, Val AUC: 0.7152
train for epoch 22










 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:21<00:01,  3.19it/s]
New threshold is 0.4278602600097656
train F1 is 0.6839186549186707
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.17it/s]
 22%|██████████████████▍                                                                | 4/18 [00:00<00:01,  8.14it/s]
New threshold is 0.3526809513568878
val F1 is 0.6461538672447205
Epoch 22/100, learning rate: 1.9999826511370455e-05
Train Loss: 0.5619, Train Acc: 0.7067, Train f1: 0.6839, Train Precision: 0.6208, Train Recall: 0.7613, Train AUC: 0.7716
Valitadion Loss: 0.6360, Validation Acc: 0.6783, Vall f1: 0.6462, Val Precision: 0.5957, Val Recall: 0.7059, Val AUC: 0.7188
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.22it/s]











 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:21<00:01,  3.18it/s]
New threshold is 0.44124874472618103
train F1 is 0.6461251378059387
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.17it/s]
 39%|████████████████████████████████▎                                                  | 7/18 [00:00<00:01,  8.26it/s]
New threshold is 0.42023202776908875
val F1 is 0.6279069781303406
Epoch 23/100, learning rate: 1.9969938804795108e-05
Train Loss: 0.5897, Train Acc: 0.6750, Train f1: 0.6461, Train Precision: 0.5915, Train Recall: 0.7119, Train AUC: 0.7375
Valitadion Loss: 0.6201, Validation Acc: 0.6643, Vall f1: 0.6279, Val Precision: 0.5827, Val Recall: 0.6807, Val AUC: 0.7206
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.33it/s]











 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:22<00:00,  3.18it/s]
New threshold is 0.4317675232887268
train F1 is 0.6413662433624268
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.17it/s]
 67%|██████████████████████████████████████████████████████▋                           | 12/18 [00:01<00:00,  8.35it/s]
New threshold is 0.4855773448944092
val F1 is 0.6328125
Epoch 24/100, learning rate: 1.98888649930018e-05
Train Loss: 0.5834, Train Acc: 0.6758, Train f1: 0.6414, Train Precision: 0.5951, Train Recall: 0.6955, Train AUC: 0.7431
Valitadion Loss: 0.6282, Validation Acc: 0.6713, Vall f1: 0.6328, Val Precision: 0.5912, Val Recall: 0.6807, Val AUC: 0.7209
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.23it/s]










 90%|██████████████████████████████████████████████████████████████████████████▏       | 66/73 [00:20<00:02,  3.18it/s]
New threshold is 0.41706526279449463
train F1 is 0.6859205961227417

100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.16it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 16/18 [00:01<00:00,  8.20it/s]
New threshold is 0.6293155550956726
val F1 is 0.629482090473175
Epoch 25/100, learning rate: 1.975702131253422e-05
Train Loss: 0.5625, Train Acc: 0.7015, Train f1: 0.6859, Train Precision: 0.6109, Train Recall: 0.7819, Train AUC: 0.7674
Valitadion Loss: 0.6337, Validation Acc: 0.6748, Vall f1: 0.6295, Val Precision: 0.5985, Val Recall: 0.6639, Val AUC: 0.7346
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.17it/s]










 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:21<00:01,  3.17it/s]
New threshold is 0.4207550287246704
train F1 is 0.6869955062866211
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.17it/s]
 17%|█████████████▊                                                                     | 3/18 [00:00<00:01,  8.02it/s]
New threshold is 0.4595525562763214
val F1 is 0.6403161883354187
Epoch 26/100, learning rate: 1.9575084654692447e-05
Train Loss: 0.5495, Train Acc: 0.7007, Train f1: 0.6870, Train Precision: 0.6089, Train Recall: 0.7881, Train AUC: 0.7848
Valitadion Loss: 0.6152, Validation Acc: 0.6818, Vall f1: 0.6403, Val Precision: 0.6045, Val Recall: 0.6807, Val AUC: 0.7347
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.20it/s]











 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:21<00:01,  3.19it/s]
New threshold is 0.44566458463668823
train F1 is 0.6923800706863403
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.16it/s]
 39%|████████████████████████████████▎                                                  | 7/18 [00:00<00:01,  8.33it/s]
New threshold is 0.48398086428642273
val F1 is 0.6507936716079712
Epoch 27/100, learning rate: 1.9343989090342975e-05
Train Loss: 0.5476, Train Acc: 0.7196, Train f1: 0.6924, Train Precision: 0.6378, Train Recall: 0.7572, Train AUC: 0.7865
Valitadion Loss: 0.6137, Validation Acc: 0.6923, Vall f1: 0.6508, Val Precision: 0.6165, Val Recall: 0.6891, Val AUC: 0.7423
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.28it/s]











 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:22<00:00,  3.18it/s]
New threshold is 0.43709301948547363
train F1 is 0.6869069933891296
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.16it/s]
 50%|█████████████████████████████████████████▌                                         | 9/18 [00:01<00:01,  8.31it/s]
New threshold is 0.27158090472221375
val F1 is 0.6513410210609436
Epoch 28/100, learning rate: 1.9064921074357497e-05
Train Loss: 0.5525, Train Acc: 0.7170, Train f1: 0.6869, Train Precision: 0.6373, Train Recall: 0.7449, Train AUC: 0.7821
Valitadion Loss: 0.6395, Validation Acc: 0.6818, Vall f1: 0.6513, Val Precision: 0.5986, Val Recall: 0.7143, Val AUC: 0.7480
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.29it/s]











 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:22<00:00,  3.20it/s]
New threshold is 0.45171305537223816
train F1 is 0.7120921015739441
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.17it/s]
 61%|██████████████████████████████████████████████████                                | 11/18 [00:01<00:00,  8.11it/s]
New threshold is 0.21498654782772064
val F1 is 0.671875
Epoch 29/100, learning rate: 1.873931335430099e-05
Train Loss: 0.5304, Train Acc: 0.7427, Train f1: 0.7121, Train Precision: 0.6673, Train Recall: 0.7634, Train AUC: 0.8037
Valitadion Loss: 0.6424, Validation Acc: 0.7063, Vall f1: 0.6719, Val Precision: 0.6277, Val Recall: 0.7227, Val AUC: 0.7577
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.13it/s]











 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:22<00:00,  3.17it/s]
New threshold is 0.4599623680114746
train F1 is 0.6987242102622986
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.16it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 13/18 [00:01<00:00,  8.21it/s]
New threshold is 0.6107397079467773
val F1 is 0.6693227291107178
Epoch 30/100, learning rate: 1.836883761464222e-05
Train Loss: 0.5343, Train Acc: 0.7367, Train f1: 0.6987, Train Precision: 0.6679, Train Recall: 0.7325, Train AUC: 0.8010
Valitadion Loss: 0.6069, Validation Acc: 0.7098, Vall f1: 0.6693, Val Precision: 0.6364, Val Recall: 0.7059, Val AUC: 0.7629
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.17it/s]










 92%|███████████████████████████████████████████████████████████████████████████▎      | 67/73 [00:21<00:01,  3.17it/s]
New threshold is 0.5270894765853882
train F1 is 0.694473385810852
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.16it/s]

 94%|█████████████████████████████████████████████████████████████████████████████▍    | 17/18 [00:02<00:00,  8.30it/s]
New threshold is 0.21436654031276703
val F1 is 0.6996197700500488
Epoch 31/100, learning rate: 1.7955395894251545e-05
Train Loss: 0.5220, Train Acc: 0.7487, Train f1: 0.6945, Train Precision: 0.7040, Train Recall: 0.6852, Train AUC: 0.8123
Valitadion Loss: 0.6303, Validation Acc: 0.7238, Vall f1: 0.6996, Val Precision: 0.6389, Val Recall: 0.7731, Val AUC: 0.7736
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.17it/s]










 92%|███████████████████████████████████████████████████████████████████████████▎      | 67/73 [00:21<00:01,  3.16it/s]
New threshold is 0.42827680706977844
train F1 is 0.7010506391525269
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.15it/s]

 94%|█████████████████████████████████████████████████████████████████████████████▍    | 17/18 [00:02<00:00,  8.11it/s]
New threshold is 0.28894713521003723
val F1 is 0.6985294222831726
Epoch 32/100, learning rate: 1.7501110821249063e-05
Train Loss: 0.5236, Train Acc: 0.7316, Train f1: 0.7011, Train Precision: 0.6542, Train Recall: 0.7551, Train AUC: 0.8080
Valitadion Loss: 0.5926, Validation Acc: 0.7133, Vall f1: 0.6985, Val Precision: 0.6209, Val Recall: 0.7983, Val AUC: 0.7691
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.01it/s]










 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:21<00:01,  3.14it/s]
New threshold is 0.44420504570007324
train F1 is 0.7216699719429016
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.15it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.18it/s]
  0%|                                                                                           | 0/73 [00:00<?, ?it/s]
New threshold is 0.3146034777164459
val F1 is 0.7126436829566956
Epoch 33/100, learning rate: 1.7008314715337748e-05
Train Loss: 0.5037, Train Acc: 0.7599, Train f1: 0.7217, Train Precision: 0.6981, Train Recall: 0.7469, Train AUC: 0.8299
Valitadion Loss: 0.5950, Validation Acc: 0.7378, Vall f1: 0.7126, Val Precision: 0.6549, Val Recall: 0.7815, Val AUC: 0.7736











 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:21<00:01,  3.19it/s]
New threshold is 0.390147864818573
train F1 is 0.7327823638916016
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.15it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.09it/s]
  0%|                                                                                           | 0/73 [00:00<?, ?it/s]
New threshold is 0.14200443029403687
val F1 is 0.6798418760299683
Epoch 34/100, learning rate: 1.6479537613570692e-05
Train Loss: 0.4977, Train Acc: 0.7504, Train f1: 0.7328, Train Precision: 0.6617, Train Recall: 0.8210, Train AUC: 0.8311
Valitadion Loss: 0.7294, Validation Acc: 0.7168, Vall f1: 0.6798, Val Precision: 0.6418, Val Recall: 0.7227, Val AUC: 0.7593











 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:22<00:00,  3.17it/s]
New threshold is 0.4784923493862152
train F1 is 0.7250509262084961
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.15it/s]
 44%|████████████████████████████████████▉                                              | 8/18 [00:01<00:01,  7.98it/s]
New threshold is 0.38920727372169495
val F1 is 0.6535432934761047
Epoch 35/100, learning rate: 1.5917494281028725e-05
Train Loss: 0.4916, Train Acc: 0.7684, Train f1: 0.7251, Train Precision: 0.7177, Train Recall: 0.7325, Train AUC: 0.8375
Valitadion Loss: 0.5944, Validation Acc: 0.6923, Vall f1: 0.6535, Val Precision: 0.6148, Val Recall: 0.6975, Val AUC: 0.7635
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.08it/s]











 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:22<00:00,  3.18it/s]
New threshold is 0.4603002667427063
train F1 is 0.7390438318252563
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.16it/s]
 67%|██████████████████████████████████████████████████████▋                           | 12/18 [00:01<00:00,  8.13it/s]
New threshold is 0.4883425831794739
val F1 is 0.640625
Epoch 36/100, learning rate: 1.532507027309615e-05
Train Loss: 0.4742, Train Acc: 0.7753, Train f1: 0.7390, Train Precision: 0.7162, Train Recall: 0.7634, Train AUC: 0.8516
Valitadion Loss: 0.6297, Validation Acc: 0.6783, Vall f1: 0.6406, Val Precision: 0.5985, Val Recall: 0.6891, Val AUC: 0.7501
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.13it/s]











100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.15it/s]
New threshold is 0.47319063544273376
train F1 is 0.7570183873176575
val for epoch 37
 83%|████████████████████████████████████████████████████████████████████▎             | 15/18 [00:01<00:00,  8.10it/s]
New threshold is 0.37208953499794006
val F1 is 0.6867924332618713
Epoch 37/100, learning rate: 1.470530712089148e-05
Train Loss: 0.4683, Train Acc: 0.7847, Train f1: 0.7570, Train Precision: 0.7148, Train Recall: 0.8045, Train AUC: 0.8515
Valitadion Loss: 0.5773, Validation Acc: 0.7098, Vall f1: 0.6868, Val Precision: 0.6233, Val Recall: 0.7647, Val AUC: 0.7799
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.07it/s]











 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:22<00:00,  3.16it/s]
New threshold is 0.40193119645118713
train F1 is 0.7609108090400696
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.15it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 14/18 [00:01<00:00,  8.04it/s]
New threshold is 0.3891288936138153
val F1 is 0.6848248839378357
Epoch 38/100, learning rate: 1.4061386715911841e-05
Train Loss: 0.4393, Train Acc: 0.7839, Train f1: 0.7609, Train Precision: 0.7060, Train Recall: 0.8251, Train AUC: 0.8764
Valitadion Loss: 0.6006, Validation Acc: 0.7168, Vall f1: 0.6848, Val Precision: 0.6377, Val Recall: 0.7395, Val AUC: 0.7749
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.04it/s]











100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.12it/s]
New threshold is 0.4728910028934479
train F1 is 0.7706237435340881
val for epoch 39
 78%|███████████████████████████████████████████████████████████████▊                  | 14/18 [00:01<00:00,  7.43it/s]
New threshold is 0.5888916850090027
val F1 is 0.6798418760299683
Epoch 39/100, learning rate: 1.3396614974060996e-05
Train Loss: 0.4413, Train Acc: 0.8045, Train f1: 0.7706, Train Precision: 0.7539, Train Recall: 0.7881, Train AUC: 0.8727
Valitadion Loss: 0.6274, Validation Acc: 0.7168, Vall f1: 0.6798, Val Precision: 0.6418, Val Recall: 0.7227, Val AUC: 0.7691
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  7.81it/s]











100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.12it/s]
New threshold is 0.40346914529800415
train F1 is 0.7626310586929321
val for epoch 40
 83%|████████████████████████████████████████████████████████████████████▎             | 15/18 [00:01<00:00,  7.87it/s]
New threshold is 0.47905945777893066
val F1 is 0.6976743936538696
Epoch 40/100, learning rate: 1.2714404862930523e-05
Train Loss: 0.4464, Train Acc: 0.7864, Train f1: 0.7626, Train Precision: 0.7105, Train Recall: 0.8230, Train AUC: 0.8697
Valitadion Loss: 0.5819, Validation Acc: 0.7273, Vall f1: 0.6977, Val Precision: 0.6475, Val Recall: 0.7563, Val AUC: 0.7767
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  7.92it/s]










 92%|███████████████████████████████████████████████████████████████████████████▎      | 67/73 [00:21<00:01,  3.13it/s]
New threshold is 0.43533429503440857
train F1 is 0.7762646079063416
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.13it/s]

 89%|████████████████████████████████████████████████████████████████████████▉         | 16/18 [00:02<00:00,  8.03it/s]
New threshold is 0.20075149834156036
val F1 is 0.7191011309623718
Epoch 41/100, learning rate: 1.2018258879472905e-05
Train Loss: 0.4327, Train Acc: 0.8027, Train f1: 0.7763, Train Precision: 0.7362, Train Recall: 0.8210, Train AUC: 0.8779
Valitadion Loss: 0.6204, Validation Acc: 0.7378, Vall f1: 0.7191, Val Precision: 0.6486, Val Recall: 0.8067, Val AUC: 0.7769
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  8.02it/s]











100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.12it/s]
New threshold is 0.4046855568885803
train F1 is 0.792934238910675
val for epoch 42
 83%|████████████████████████████████████████████████████████████████████▎             | 15/18 [00:01<00:00,  8.07it/s]
New threshold is 0.5141072869300842
val F1 is 0.6694560647010803
Epoch 42/100, learning rate: 1.1311751068026944e-05
Train Loss: 0.4012, Train Acc: 0.8190, Train f1: 0.7929, Train Precision: 0.7580, Train Recall: 0.8313, Train AUC: 0.9006
Valitadion Loss: 0.6155, Validation Acc: 0.7238, Vall f1: 0.6695, Val Precision: 0.6667, Val Recall: 0.6723, Val AUC: 0.7816
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  7.97it/s]











100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.12it/s]
New threshold is 0.4205189645290375
train F1 is 0.7941747307777405
val for epoch 43
 83%|████████████████████████████████████████████████████████████████████▎             | 15/18 [00:01<00:00,  8.00it/s]
New threshold is 0.5157176852226257
val F1 is 0.6852589845657349
Epoch 43/100, learning rate: 1.0598508671015642e-05
Train Loss: 0.4172, Train Acc: 0.8182, Train f1: 0.7942, Train Precision: 0.7518, Train Recall: 0.8416, Train AUC: 0.8880
Valitadion Loss: 0.6367, Validation Acc: 0.7238, Vall f1: 0.6853, Val Precision: 0.6515, Val Recall: 0.7227, Val AUC: 0.7732
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  7.93it/s]











100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.10it/s]
New threshold is 0.4311262369155884
train F1 is 0.8075772523880005
val for epoch 44
 78%|███████████████████████████████████████████████████████████████▊                  | 14/18 [00:01<00:00,  7.45it/s]
New threshold is 0.4040023982524872
val F1 is 0.7049808502197266
Epoch 44/100, learning rate: 9.882193506522859e-06
Train Loss: 0.3893, Train Acc: 0.8345, Train f1: 0.8076, Train Precision: 0.7834, Train Recall: 0.8333, Train AUC: 0.9064
Valitadion Loss: 0.6066, Validation Acc: 0.7308, Vall f1: 0.7050, Val Precision: 0.6479, Val Recall: 0.7731, Val AUC: 0.7807
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  7.51it/s]











 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:23<00:01,  3.04it/s]
New threshold is 0.4429195821285248
train F1 is 0.8047571778297424
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:24<00:00,  2.98it/s]
 33%|███████████████████████████▋                                                       | 6/18 [00:00<00:01,  7.71it/s]
New threshold is 0.6413823962211609
val F1 is 0.6996197700500488
Epoch 45/100, learning rate: 9.166483168356895e-06
Train Loss: 0.3835, Train Acc: 0.8310, Train f1: 0.8048, Train Precision: 0.7763, Train Recall: 0.8354, Train AUC: 0.9075
Valitadion Loss: 0.6950, Validation Acc: 0.7238, Vall f1: 0.6996, Val Precision: 0.6389, Val Recall: 0.7731, Val AUC: 0.7624
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  7.70it/s]











 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:22<00:01,  3.07it/s]
New threshold is 0.37669840455055237
train F1 is 0.8068506121635437
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.08it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  7.83it/s]
  0%|                                                                                           | 0/73 [00:00<?, ?it/s]
New threshold is 0.3408561050891876
val F1 is 0.6935483813285828
Epoch 46/100, learning rate: 8.455052145120891e-06
Train Loss: 0.3889, Train Acc: 0.8259, Train f1: 0.8069, Train Precision: 0.7504, Train Recall: 0.8724, Train AUC: 0.9040
Valitadion Loss: 0.6587, Validation Acc: 0.7343, Vall f1: 0.6935, Val Precision: 0.6667, Val Recall: 0.7227, Val AUC: 0.7747











100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.05it/s]
  0%|                                                                                           | 0/18 [00:00<?, ?it/s]
New threshold is 0.40087684988975525
train F1 is 0.815891444683075

 83%|████████████████████████████████████████████████████████████████████▎             | 15/18 [00:01<00:00,  7.95it/s]
New threshold is 0.31648722290992737
val F1 is 0.6875
Epoch 47/100, learning rate: 7.751552955225432e-06
Train Loss: 0.3687, Train Acc: 0.8370, Train f1: 0.8159, Train Precision: 0.7711, Train Recall: 0.8663, Train AUC: 0.9159
Valitadion Loss: 0.6638, Validation Acc: 0.7203, Vall f1: 0.6875, Val Precision: 0.6423, Val Recall: 0.7395, Val AUC: 0.7684
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  7.82it/s]











 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:23<00:00,  3.10it/s]
New threshold is 0.44281119108200073
train F1 is 0.8047571778297424
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:24<00:00,  3.02it/s]
 56%|█████████████████████████████████████████████▌                                    | 10/18 [00:01<00:01,  7.88it/s]
New threshold is 0.23095187544822693
val F1 is 0.7148289084434509
Epoch 48/100, learning rate: 7.059597394697126e-06
Train Loss: 0.3811, Train Acc: 0.8310, Train f1: 0.8048, Train Precision: 0.7763, Train Recall: 0.8354, Train AUC: 0.9081
Valitadion Loss: 0.6433, Validation Acc: 0.7378, Vall f1: 0.7148, Val Precision: 0.6528, Val Recall: 0.7899, Val AUC: 0.7797
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  7.68it/s]











 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:22<00:01,  2.97it/s]
New threshold is 0.431477814912796
train F1 is 0.8259587287902832
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:24<00:00,  3.02it/s]
 22%|██████████████████▍                                                                | 4/18 [00:00<00:01,  7.82it/s]
New threshold is 0.3638570010662079
val F1 is 0.7045454382896423
Epoch 49/100, learning rate: 6.382737994057677e-06
Train Loss: 0.3565, Train Acc: 0.8482, Train f1: 0.8260, Train Precision: 0.7910, Train Recall: 0.8642, Train AUC: 0.9208
Valitadion Loss: 0.6690, Validation Acc: 0.7273, Vall f1: 0.7045, Val Precision: 0.6414, Val Recall: 0.7815, Val AUC: 0.7682
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  7.94it/s]











100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.06it/s]
  6%|████▌                                                                              | 1/18 [00:00<00:02,  6.95it/s]
New threshold is 0.4402349889278412
train F1 is 0.8284023404121399

 89%|████████████████████████████████████████████████████████████████████████▉         | 16/18 [00:02<00:00,  6.84it/s]
New threshold is 0.2028980553150177
val F1 is 0.7081711888313293
Epoch 50/100, learning rate: 5.724449779474729e-06
Train Loss: 0.3475, Train Acc: 0.8508, Train f1: 0.8284, Train Precision: 0.7955, Train Recall: 0.8642, Train AUC: 0.9252
Valitadion Loss: 0.6829, Validation Acc: 0.7378, Vall f1: 0.7082, Val Precision: 0.6594, Val Recall: 0.7647, Val AUC: 0.7809
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  7.28it/s]
 14%|███████████▏                                                                      | 10/73 [00:03<00:20,  3.05it/s]
 22%|█████████████████▉                                                                | 16/73 [00:05<00:18,  3.08it/s]
 30%|████████████████████████▋                                                         | 22/73 [00:07<00:16,  3.12it/s]
 40%|████████████████████████████████▌                                                 | 29/73 [00:09<00:14,  3.13it/s]
 48%|███████████████████████████████████████▎                                          | 35/73 [00:11<00:12,  3.13it/s]
 56%|██████████████████████████████████████████████                                    | 41/73 [00:13<00:10,  3.14it/s]
 64%|████████████████████████████████████████████████████▊                             | 47/73 [00:15<00:08,  3.11it/s]
 73%|███████████████████████████████████████████████████████████▌                      | 53/73 [00:17<00:06,  3.11it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 60/73 [00:19<00:04,  3.11it/s]
 90%|██████████████████████████████████████████████████████████████████████████▏       | 66/73 [00:21<00:02,  3.13it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:23<00:00,  3.10it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:23<00:00,  3.10it/s]
New threshold is 0.40610963106155396
train F1 is 0.822265625
 78%|███████████████████████████████████████████████████████████████▊                  | 14/18 [00:01<00:00,  7.94it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 14/18 [00:01<00:00,  7.94it/s]
New threshold is 0.5065752863883972
val F1 is 0.7007874250411987
Epoch 51/100, learning rate: 5.088112431823452e-06
Train Loss: 0.3448, Train Acc: 0.8439, Train f1: 0.8223, Train Precision: 0.7825, Train Recall: 0.8663, Train AUC: 0.9262
Valitadion Loss: 0.6758, Validation Acc: 0.7343, Vall f1: 0.7008, Val Precision: 0.6593, Val Recall: 0.7479, Val AUC: 0.7789
  4%|███▍                                                                               | 3/73 [00:01<00:25,  2.75it/s]
 14%|███████████▏                                                                      | 10/73 [00:03<00:20,  3.11it/s]
 22%|█████████████████▉                                                                | 16/73 [00:05<00:18,  3.12it/s]
 30%|████████████████████████▋                                                         | 22/73 [00:07<00:16,  3.09it/s]
 38%|███████████████████████████████▍                                                  | 28/73 [00:09<00:14,  3.09it/s]
 47%|██████████████████████████████████████▏                                           | 34/73 [00:11<00:12,  3.13it/s]
 56%|██████████████████████████████████████████████                                    | 41/73 [00:13<00:10,  3.11it/s]
 64%|████████████████████████████████████████████████████▊                             | 47/73 [00:15<00:08,  3.12it/s]
 73%|███████████████████████████████████████████████████████████▌                      | 53/73 [00:17<00:06,  3.13it/s]
 81%|██████████████████████████████████████████████████████████████████▎               | 59/73 [00:19<00:04,  3.10it/s]
 90%|██████████████████████████████████████████████████████████████████████████▏       | 66/73 [00:21<00:02,  3.13it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:23<00:00,  3.09it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:23<00:00,  3.09it/s]
New threshold is 0.4300614297389984
train F1 is 0.8410661220550537
 72%|███████████████████████████████████████████████████████████▏                      | 13/18 [00:01<00:00,  7.95it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 13/18 [00:01<00:00,  7.95it/s]
New threshold is 0.17139457166194916
val F1 is 0.7196969985961914
Epoch 52/100, learning rate: 4.476992935255127e-06
Train Loss: 0.3394, Train Acc: 0.8619, Train f1: 0.8411, Train Precision: 0.8083, Train Recall: 0.8765, Train AUC: 0.9291
Valitadion Loss: 0.6754, Validation Acc: 0.7413, Vall f1: 0.7197, Val Precision: 0.6552, Val Recall: 0.7983, Val AUC: 0.7866
  3%|██▎                                                                                | 2/73 [00:00<00:27,  2.58it/s]
 11%|█████████                                                                          | 8/73 [00:02<00:21,  3.06it/s]
 21%|████████████████▊                                                                 | 15/73 [00:05<00:18,  3.09it/s]
 29%|███████████████████████▌                                                          | 21/73 [00:06<00:16,  3.12it/s]
 37%|██████████████████████████████▎                                                   | 27/73 [00:08<00:14,  3.11it/s]
 45%|█████████████████████████████████████                                             | 33/73 [00:10<00:13,  3.07it/s]
 53%|███████████████████████████████████████████▊                                      | 39/73 [00:12<00:10,  3.10it/s]
 63%|███████████████████████████████████████████████████▋                              | 46/73 [00:15<00:08,  3.08it/s]
 71%|██████████████████████████████████████████████████████████▍                       | 52/73 [00:16<00:06,  3.11it/s]
 79%|█████████████████████████████████████████████████████████████████▏                | 58/73 [00:18<00:04,  3.10it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 64/73 [00:20<00:02,  3.05it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:22<00:00,  3.08it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:22<00:00,  3.08it/s]
New threshold is 0.43858444690704346
train F1 is 0.8295566439628601
 50%|█████████████████████████████████████████▌                                         | 9/18 [00:01<00:01,  7.79it/s]
 50%|█████████████████████████████████████████▌                                         | 9/18 [00:01<00:01,  7.79it/s]
New threshold is 0.1357012391090393
val F1 is 0.7076923251152039
Epoch 53/100, learning rate: 3.894228804355683e-06
Train Loss: 0.3375, Train Acc: 0.8516, Train f1: 0.8296, Train Precision: 0.7958, Train Recall: 0.8663, Train AUC: 0.9300
Valitadion Loss: 0.7140, Validation Acc: 0.7343, Vall f1: 0.7077, Val Precision: 0.6525, Val Recall: 0.7731, Val AUC: 0.7809
  1%|█▏                                                                                 | 1/73 [00:00<00:35,  2.04it/s]
 11%|█████████                                                                          | 8/73 [00:02<00:21,  3.09it/s]
 19%|███████████████▋                                                                  | 14/73 [00:04<00:19,  3.09it/s]
 27%|██████████████████████▍                                                           | 20/73 [00:06<00:17,  3.11it/s]
 36%|█████████████████████████████▏                                                    | 26/73 [00:08<00:15,  3.12it/s]
 45%|█████████████████████████████████████                                             | 33/73 [00:10<00:12,  3.12it/s]
 53%|███████████████████████████████████████████▊                                      | 39/73 [00:12<00:10,  3.10it/s]
 62%|██████████████████████████████████████████████████▌                               | 45/73 [00:14<00:09,  3.09it/s]
 70%|█████████████████████████████████████████████████████████▎                        | 51/73 [00:16<00:07,  3.10it/s]
 78%|████████████████████████████████████████████████████████████████                  | 57/73 [00:18<00:05,  3.10it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 64/73 [00:20<00:02,  3.11it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:22<00:00,  3.10it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:22<00:00,  3.10it/s]
New threshold is 0.4112909436225891
train F1 is 0.8227227926254272
 39%|████████████████████████████████▎                                                  | 7/18 [00:00<00:01,  7.74it/s]
 39%|████████████████████████████████▎                                                  | 7/18 [00:00<00:01,  7.74it/s]
New threshold is 0.2799912393093109
val F1 is 0.6987951993942261
Epoch 54/100, learning rate: 3.3428119760067316e-06
Train Loss: 0.3323, Train Acc: 0.8448, Train f1: 0.8227, Train Precision: 0.7850, Train Recall: 0.8642, Train AUC: 0.9313
Valitadion Loss: 0.6686, Validation Acc: 0.7378, Vall f1: 0.6988, Val Precision: 0.6692, Val Recall: 0.7311, Val AUC: 0.7847
  1%|█▏                                                                                 | 1/73 [00:00<00:36,  1.98it/s]
 10%|███████▉                                                                           | 7/73 [00:02<00:21,  3.03it/s]
 18%|██████████████▌                                                                   | 13/73 [00:04<00:19,  3.10it/s]
 26%|█████████████████████▎                                                            | 19/73 [00:06<00:17,  3.11it/s]
 36%|█████████████████████████████▏                                                    | 26/73 [00:08<00:15,  3.09it/s]
 44%|███████████████████████████████████▉                                              | 32/73 [00:10<00:13,  3.12it/s]
 52%|██████████████████████████████████████████▋                                       | 38/73 [00:12<00:11,  3.10it/s]
 60%|█████████████████████████████████████████████████▍                                | 44/73 [00:14<00:09,  3.10it/s]
 68%|████████████████████████████████████████████████████████▏                         | 50/73 [00:16<00:07,  3.08it/s]
 78%|████████████████████████████████████████████████████████████████                  | 57/73 [00:18<00:05,  3.09it/s]
 86%|██████████████████████████████████████████████████████████████████████▊           | 63/73 [00:20<00:03,  3.09it/s]
 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:22<00:01,  3.09it/s]
 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:22<00:01,  3.09it/s]
New threshold is 0.4753597676753998
train F1 is 0.8336713910102844
 28%|███████████████████████                                                            | 5/18 [00:00<00:01,  7.77it/s]
 28%|███████████████████████                                                            | 5/18 [00:00<00:01,  7.77it/s]
New threshold is 0.23565158247947693
val F1 is 0.703125
Epoch 55/100, learning rate: 2.8255734486489703e-06
Train Loss: 0.3340, Train Acc: 0.8593, Train f1: 0.8337, Train Precision: 0.8220, Train Recall: 0.8457, Train AUC: 0.9314
Valitadion Loss: 0.6760, Validation Acc: 0.7343, Vall f1: 0.7031, Val Precision: 0.6569, Val Recall: 0.7563, Val AUC: 0.7843
  0%|                                                                                           | 0/73 [00:00<?, ?it/s]
  8%|██████▊                                                                            | 6/73 [00:02<00:21,  3.05it/s]
 16%|█████████████▍                                                                    | 12/73 [00:04<00:19,  3.09it/s]
 25%|████████████████████▏                                                             | 18/73 [00:05<00:17,  3.11it/s]
 34%|████████████████████████████                                                      | 25/73 [00:08<00:15,  3.11it/s]
 42%|██████████████████████████████████▊                                               | 31/73 [00:10<00:13,  3.11it/s]
 51%|█████████████████████████████████████████▌                                        | 37/73 [00:12<00:11,  3.08it/s]
 59%|████████████████████████████████████████████████▎                                 | 43/73 [00:14<00:09,  3.10it/s]
 68%|████████████████████████████████████████████████████████▏                         | 50/73 [00:16<00:07,  3.11it/s]
 77%|██████████████████████████████████████████████████████████████▉                   | 56/73 [00:18<00:05,  3.11it/s]
 85%|█████████████████████████████████████████████████████████████████████▋            | 62/73 [00:20<00:03,  3.09it/s]
 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:22<00:01,  3.11it/s]
 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:22<00:01,  3.11it/s]
New threshold is 0.440225750207901
train F1 is 0.8277227878570557
 17%|█████████████▊                                                                     | 3/18 [00:00<00:02,  7.42it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 15/18 [00:01<00:00,  7.94it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 15/18 [00:01<00:00,  7.94it/s]
New threshold is 0.37326517701148987
val F1 is 0.6959999799728394
Epoch 56/100, learning rate: 2.3451687478107256e-06
Train Loss: 0.3430, Train Acc: 0.8508, Train f1: 0.8277, Train Precision: 0.7977, Train Recall: 0.8601, Train AUC: 0.9272
Valitadion Loss: 0.6847, Validation Acc: 0.7343, Vall f1: 0.6960, Val Precision: 0.6641, Val Recall: 0.7311, Val AUC: 0.7789
  5%|████▌                                                                              | 4/73 [00:01<00:23,  2.88it/s]
 14%|███████████▏                                                                      | 10/73 [00:03<00:20,  3.05it/s]
 22%|█████████████████▉                                                                | 16/73 [00:05<00:18,  3.08it/s]
 30%|████████████████████████▋                                                         | 22/73 [00:07<00:16,  3.07it/s]
 40%|████████████████████████████████▌                                                 | 29/73 [00:09<00:14,  3.09it/s]
 48%|███████████████████████████████████████▎                                          | 35/73 [00:11<00:12,  3.11it/s]
 56%|██████████████████████████████████████████████                                    | 41/73 [00:13<00:10,  3.11it/s]
 64%|████████████████████████████████████████████████████▊                             | 47/73 [00:15<00:08,  3.09it/s]
 73%|███████████████████████████████████████████████████████████▌                      | 53/73 [00:17<00:06,  3.08it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 60/73 [00:19<00:04,  3.10it/s]
 90%|██████████████████████████████████████████████████████████████████████████▏       | 66/73 [00:21<00:02,  3.09it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:23<00:00,  3.07it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:23<00:00,  3.07it/s]
New threshold is 0.4671739935874939
train F1 is 0.8289205431938171
 67%|██████████████████████████████████████████████████████▋                           | 12/18 [00:01<00:00,  7.72it/s]
 67%|██████████████████████████████████████████████████████▋                           | 12/18 [00:01<00:00,  7.72it/s]
New threshold is 0.24804751574993134
val F1 is 0.7067669034004211
Epoch 57/100, learning rate: 1.9040642925221363e-06
Train Loss: 0.3446, Train Acc: 0.8559, Train f1: 0.8289, Train Precision: 0.8206, Train Recall: 0.8374, Train AUC: 0.9247
Valitadion Loss: 0.6735, Validation Acc: 0.7273, Vall f1: 0.7068, Val Precision: 0.6395, Val Recall: 0.7899, Val AUC: 0.7824
  4%|███▍                                                                               | 3/73 [00:01<00:25,  2.75it/s]
 12%|██████████▏                                                                        | 9/73 [00:03<00:20,  3.06it/s]
 21%|████████████████▊                                                                 | 15/73 [00:05<00:18,  3.10it/s]
 29%|███████████████████████▌                                                          | 21/73 [00:06<00:16,  3.08it/s]
 38%|███████████████████████████████▍                                                  | 28/73 [00:09<00:14,  3.08it/s]
 47%|██████████████████████████████████████▏                                           | 34/73 [00:11<00:12,  3.12it/s]
 55%|████████████████████████████████████████████▉                                     | 40/73 [00:13<00:10,  3.06it/s]
 63%|███████████████████████████████████████████████████▋                              | 46/73 [00:15<00:08,  3.11it/s]
 71%|██████████████████████████████████████████████████████████▍                       | 52/73 [00:16<00:06,  3.09it/s]
 81%|██████████████████████████████████████████████████████████████████▎               | 59/73 [00:19<00:04,  3.09it/s]
 89%|█████████████████████████████████████████████████████████████████████████         | 65/73 [00:21<00:02,  3.08it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:23<00:00,  3.08it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:23<00:00,  3.08it/s]
New threshold is 0.3941320776939392
train F1 is 0.8474903702735901
 56%|█████████████████████████████████████████████▌                                    | 10/18 [00:01<00:01,  7.58it/s]
 56%|█████████████████████████████████████████████▌                                    | 10/18 [00:01<00:01,  7.58it/s]
New threshold is 0.15271590650081635
val F1 is 0.7153284549713135
Epoch 58/100, learning rate: 1.5045247326105404e-06
Train Loss: 0.3180, Train Acc: 0.8645, Train f1: 0.8475, Train Precision: 0.7982, Train Recall: 0.9033, Train AUC: 0.9375
Valitadion Loss: 0.6831, Validation Acc: 0.7273, Vall f1: 0.7153, Val Precision: 0.6323, Val Recall: 0.8235, Val AUC: 0.7825
  3%|██▎                                                                                | 2/73 [00:00<00:27,  2.55it/s]
 11%|█████████                                                                          | 8/73 [00:02<00:21,  3.06it/s]
 19%|███████████████▋                                                                  | 14/73 [00:04<00:19,  3.09it/s]
 27%|██████████████████████▍                                                           | 20/73 [00:06<00:17,  3.08it/s]
 37%|██████████████████████████████▎                                                   | 27/73 [00:08<00:14,  3.09it/s]
 45%|█████████████████████████████████████                                             | 33/73 [00:10<00:12,  3.11it/s]
 53%|███████████████████████████████████████████▊                                      | 39/73 [00:12<00:11,  3.07it/s]
 62%|██████████████████████████████████████████████████▌                               | 45/73 [00:14<00:09,  3.09it/s]
 70%|█████████████████████████████████████████████████████████▎                        | 51/73 [00:16<00:07,  3.09it/s]
 78%|████████████████████████████████████████████████████████████████                  | 57/73 [00:18<00:05,  3.07it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 64/73 [00:20<00:02,  3.06it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:22<00:00,  3.05it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:22<00:00,  3.05it/s]
New threshold is 0.43439072370529175
train F1 is 0.8474576473236084
 39%|████████████████████████████████▎                                                  | 7/18 [00:00<00:01,  7.51it/s]
 39%|████████████████████████████████▎                                                  | 7/18 [00:00<00:01,  7.51it/s]
New threshold is 0.218199223279953
val F1 is 0.6996197700500488
Epoch 59/100, learning rate: 1.1486013218878658e-06
Train Loss: 0.3085, Train Acc: 0.8688, Train f1: 0.8475, Train Precision: 0.8221, Train Recall: 0.8745, Train AUC: 0.9428
Valitadion Loss: 0.6800, Validation Acc: 0.7238, Vall f1: 0.6996, Val Precision: 0.6389, Val Recall: 0.7731, Val AUC: 0.7829
  1%|█▏                                                                                 | 1/73 [00:00<00:36,  1.99it/s]
 10%|███████▉                                                                           | 7/73 [00:02<00:22,  2.99it/s]
 18%|██████████████▌                                                                   | 13/73 [00:04<00:19,  3.07it/s]
 26%|█████████████████████▎                                                            | 19/73 [00:06<00:17,  3.07it/s]
 34%|████████████████████████████                                                      | 25/73 [00:08<00:15,  3.10it/s]
 42%|██████████████████████████████████▊                                               | 31/73 [00:10<00:13,  3.10it/s]
 51%|█████████████████████████████████████████▌                                        | 37/73 [00:12<00:11,  3.05it/s]
 60%|█████████████████████████████████████████████████▍                                | 44/73 [00:14<00:09,  2.98it/s]
 68%|████████████████████████████████████████████████████████▏                         | 50/73 [00:16<00:07,  3.07it/s]
 77%|██████████████████████████████████████████████████████████████▉                   | 56/73 [00:18<00:05,  3.03it/s]
 85%|█████████████████████████████████████████████████████████████████████▋            | 62/73 [00:20<00:03,  3.09it/s]
 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:22<00:01,  3.09it/s]
 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:22<00:01,  3.09it/s]
New threshold is 0.37560567259788513
train F1 is 0.853515625
 17%|█████████████▊                                                                     | 3/18 [00:00<00:01,  7.52it/s]
 17%|█████████████▊                                                                     | 3/18 [00:00<00:01,  7.52it/s]
New threshold is 0.30961403250694275
val F1 is 0.6926069855690002
Epoch 60/100, learning rate: 8.381213869226201e-07
Train Loss: 0.3082, Train Acc: 0.8714, Train f1: 0.8535, Train Precision: 0.8123, Train Recall: 0.8992, Train AUC: 0.9433
Valitadion Loss: 0.6826, Validation Acc: 0.7238, Vall f1: 0.6926, Val Precision: 0.6449, Val Recall: 0.7479, Val AUC: 0.7837
  0%|                                                                                           | 0/73 [00:00<?, ?it/s]
  7%|█████▋                                                                             | 5/73 [00:01<00:23,  2.95it/s]
 15%|████████████▎                                                                     | 11/73 [00:03<00:20,  3.06it/s]
 23%|███████████████████                                                               | 17/73 [00:05<00:18,  3.06it/s]
 33%|██████████████████████████▉                                                       | 24/73 [00:07<00:15,  3.09it/s]
 41%|█████████████████████████████████▋                                                | 30/73 [00:09<00:14,  3.05it/s]
 49%|████████████████████████████████████████▍                                         | 36/73 [00:11<00:12,  3.08it/s]
 58%|███████████████████████████████████████████████▏                                  | 42/73 [00:13<00:10,  3.08it/s]
 66%|█████████████████████████████████████████████████████▉                            | 48/73 [00:15<00:08,  3.08it/s]
 75%|█████████████████████████████████████████████████████████████▊                    | 55/73 [00:18<00:05,  3.09it/s]
 84%|████████████████████████████████████████████████████████████████████▌             | 61/73 [00:19<00:03,  3.07it/s]
 92%|███████████████████████████████████████████████████████████████████████████▎      | 67/73 [00:21<00:01,  3.06it/s]
 92%|███████████████████████████████████████████████████████████████████████████▎      | 67/73 [00:21<00:01,  3.06it/s]
New threshold is 0.452633798122406
train F1 is 0.841791033744812
  0%|                                                                                           | 0/18 [00:00<?, ?it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 15/18 [00:01<00:00,  7.89it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 15/18 [00:01<00:00,  7.89it/s]
New threshold is 0.2324681580066681
val F1 is 0.701886773109436
Epoch 61/100, learning rate: 5.746789454643014e-07
Train Loss: 0.3300, Train Acc: 0.8636, Train f1: 0.8418, Train Precision: 0.8150, Train Recall: 0.8704, Train AUC: 0.9318
Valitadion Loss: 0.6786, Validation Acc: 0.7238, Vall f1: 0.7019, Val Precision: 0.6370, Val Recall: 0.7815, Val AUC: 0.7837
  5%|████▌                                                                              | 4/73 [00:01<00:24,  2.85it/s]
 14%|███████████▏                                                                      | 10/73 [00:03<00:20,  3.07it/s]
 22%|█████████████████▉                                                                | 16/73 [00:05<00:18,  3.06it/s]
 30%|████████████████████████▋                                                         | 22/73 [00:07<00:16,  3.06it/s]
 38%|███████████████████████████████▍                                                  | 28/73 [00:09<00:14,  3.06it/s]
 48%|███████████████████████████████████████▎                                          | 35/73 [00:11<00:12,  3.07it/s]
 56%|██████████████████████████████████████████████                                    | 41/73 [00:13<00:10,  3.01it/s]
 64%|████████████████████████████████████████████████████▊                             | 47/73 [00:15<00:08,  3.02it/s]
 73%|███████████████████████████████████████████████████████████▌                      | 53/73 [00:17<00:06,  2.94it/s]
 81%|██████████████████████████████████████████████████████████████████▎               | 59/73 [00:19<00:04,  2.99it/s]
 89%|█████████████████████████████████████████████████████████████████████████         | 65/73 [00:21<00:02,  3.03it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:23<00:00,  3.08it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:23<00:00,  3.08it/s]
New threshold is 0.3838304281234741
train F1 is 0.8509804010391235
 56%|█████████████████████████████████████████████▌                                    | 10/18 [00:01<00:01,  7.82it/s]
 56%|█████████████████████████████████████████████▌                                    | 10/18 [00:01<00:01,  7.82it/s]
New threshold is 0.18304497003555298
val F1 is 0.7111111283302307
Epoch 62/100, learning rate: 3.596265226855932e-07
Train Loss: 0.3080, Train Acc: 0.8696, Train f1: 0.8510, Train Precision: 0.8127, Train Recall: 0.8930, Train AUC: 0.9424
Valitadion Loss: 0.6803, Validation Acc: 0.7273, Vall f1: 0.7111, Val Precision: 0.6358, Val Recall: 0.8067, Val AUC: 0.7838
  3%|██▎                                                                                | 2/73 [00:00<00:28,  2.50it/s]
 11%|█████████                                                                          | 8/73 [00:02<00:21,  3.05it/s]
 19%|███████████████▋                                                                  | 14/73 [00:04<00:19,  3.08it/s]
 29%|███████████████████████▌                                                          | 21/73 [00:06<00:16,  3.10it/s]
 37%|██████████████████████████████▎                                                   | 27/73 [00:08<00:15,  2.95it/s]
 45%|█████████████████████████████████████                                             | 33/73 [00:10<00:13,  3.06it/s]
 53%|███████████████████████████████████████████▊                                      | 39/73 [00:12<00:11,  3.01it/s]
 62%|██████████████████████████████████████████████████▌                               | 45/73 [00:14<00:09,  3.03it/s]
 70%|█████████████████████████████████████████████████████████▎                        | 51/73 [00:16<00:07,  2.98it/s]
 78%|████████████████████████████████████████████████████████████████                  | 57/73 [00:18<00:05,  3.07it/s]
 86%|██████████████████████████████████████████████████████████████████████▊           | 63/73 [00:20<00:03,  2.92it/s]
 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:22<00:01,  3.06it/s]
 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:22<00:01,  3.06it/s]
New threshold is 0.5077177286148071
train F1 is 0.8515864610671997
 28%|███████████████████████                                                            | 5/18 [00:00<00:01,  7.72it/s]
 28%|███████████████████████                                                            | 5/18 [00:00<00:01,  7.72it/s]
New threshold is 0.20663517713546753
val F1 is 0.7089552283287048
Epoch 63/100, learning rate: 1.9406820725818456e-07
Train Loss: 0.3133, Train Acc: 0.8756, Train f1: 0.8516, Train Precision: 0.8473, Train Recall: 0.8560, Train AUC: 0.9406
Valitadion Loss: 0.6806, Validation Acc: 0.7273, Vall f1: 0.7090, Val Precision: 0.6376, Val Recall: 0.7983, Val AUC: 0.7829
  0%|                                                                                           | 0/73 [00:00<?, ?it/s]
  8%|██████▊                                                                            | 6/73 [00:02<00:22,  2.97it/s]
 16%|█████████████▍                                                                    | 12/73 [00:04<00:19,  3.06it/s]
 25%|████████████████████▏                                                             | 18/73 [00:06<00:17,  3.06it/s]
 33%|██████████████████████████▉                                                       | 24/73 [00:08<00:16,  3.05it/s]
 42%|██████████████████████████████████▊                                               | 31/73 [00:10<00:13,  3.05it/s]
 51%|█████████████████████████████████████████▌                                        | 37/73 [00:12<00:11,  3.10it/s]
 59%|████████████████████████████████████████████████▎                                 | 43/73 [00:14<00:09,  3.07it/s]
 67%|███████████████████████████████████████████████████████                           | 49/73 [00:16<00:07,  3.05it/s]
 75%|█████████████████████████████████████████████████████████████▊                    | 55/73 [00:18<00:05,  3.08it/s]
 84%|████████████████████████████████████████████████████████████████████▌             | 61/73 [00:20<00:03,  3.08it/s]
 92%|███████████████████████████████████████████████████████████████████████████▎      | 67/73 [00:22<00:01,  3.07it/s]
 92%|███████████████████████████████████████████████████████████████████████████▎      | 67/73 [00:22<00:01,  3.07it/s]
New threshold is 0.4367578625679016
train F1 is 0.8665997982025146
  6%|████▌                                                                              | 1/18 [00:00<00:02,  7.38it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 17/18 [00:02<00:00,  7.71it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 17/18 [00:02<00:00,  7.71it/s]
New threshold is 0.19930332899093628
val F1 is 0.7067669034004211
Epoch 64/100, learning rate: 7.885398291257302e-08
Train Loss: 0.2966, Train Acc: 0.8859, Train f1: 0.8666, Train Precision: 0.8454, Train Recall: 0.8889, Train AUC: 0.9482
Valitadion Loss: 0.6814, Validation Acc: 0.7273, Vall f1: 0.7068, Val Precision: 0.6395, Val Recall: 0.7899, Val AUC: 0.7833
  5%|████▌                                                                              | 4/73 [00:01<00:23,  2.89it/s]
 15%|████████████▎                                                                     | 11/73 [00:03<00:20,  3.09it/s]
 23%|███████████████████                                                               | 17/73 [00:05<00:18,  3.10it/s]
 32%|█████████████████████████▊                                                        | 23/73 [00:07<00:16,  3.10it/s]
 40%|████████████████████████████████▌                                                 | 29/73 [00:09<00:14,  3.09it/s]
 48%|███████████████████████████████████████▎                                          | 35/73 [00:11<00:12,  3.12it/s]
 58%|███████████████████████████████████████████████▏                                  | 42/73 [00:13<00:10,  3.08it/s]
 66%|█████████████████████████████████████████████████████▉                            | 48/73 [00:15<00:08,  3.10it/s]
 74%|████████████████████████████████████████████████████████████▋                     | 54/73 [00:17<00:06,  3.08it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 60/73 [00:19<00:04,  3.09it/s]
 90%|██████████████████████████████████████████████████████████████████████████▏       | 66/73 [00:21<00:02,  3.10it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.07it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.07it/s]
New threshold is 0.4219025671482086
train F1 is 0.8443113565444946
 78%|███████████████████████████████████████████████████████████████▊                  | 14/18 [00:01<00:00,  7.82it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 14/18 [00:01<00:00,  7.82it/s]
New threshold is 0.20120790600776672
val F1 is 0.7067669034004211
Epoch 65/100, learning rate: 1.4575364583924625e-08
Train Loss: 0.3221, Train Acc: 0.8662, Train f1: 0.8443, Train Precision: 0.8198, Train Recall: 0.8704, Train AUC: 0.9362
Valitadion Loss: 0.6813, Validation Acc: 0.7273, Vall f1: 0.7068, Val Precision: 0.6395, Val Recall: 0.7899, Val AUC: 0.7833
  5%|████▌                                                                              | 4/73 [00:01<00:24,  2.87it/s]
 14%|███████████▏                                                                      | 10/73 [00:03<00:20,  3.06it/s]
 22%|█████████████████▉                                                                | 16/73 [00:05<00:18,  3.11it/s]
 30%|████████████████████████▋                                                         | 22/73 [00:07<00:16,  3.08it/s]
 38%|███████████████████████████████▍                                                  | 28/73 [00:09<00:14,  3.09it/s]
 47%|██████████████████████████████████████▏                                           | 34/73 [00:11<00:12,  3.06it/s]
 55%|████████████████████████████████████████████▉                                     | 40/73 [00:13<00:10,  3.06it/s]
 64%|████████████████████████████████████████████████████▊                             | 47/73 [00:15<00:08,  3.06it/s]
 73%|███████████████████████████████████████████████████████████▌                      | 53/73 [00:17<00:06,  3.09it/s]
 81%|██████████████████████████████████████████████████████████████████▎               | 59/73 [00:19<00:04,  3.10it/s]
 89%|█████████████████████████████████████████████████████████████████████████         | 65/73 [00:21<00:02,  3.08it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:23<00:00,  3.06it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:23<00:00,  3.06it/s]
New threshold is 0.3892684876918793
train F1 is 0.8328445553779602
 61%|██████████████████████████████████████████████████                                | 11/18 [00:01<00:00,  7.73it/s]
 61%|██████████████████████████████████████████████████                                | 11/18 [00:01<00:00,  7.73it/s]
New threshold is 0.08335506170988083
val F1 is 0.6904761791229248
Epoch 66/100, learning rate: 1.999960965199438e-05
Train Loss: 0.3210, Train Acc: 0.8533, Train f1: 0.8328, Train Precision: 0.7933, Train Recall: 0.8765, Train AUC: 0.9365
Valitadion Loss: 0.8235, Validation Acc: 0.7273, Vall f1: 0.6905, Val Precision: 0.6541, Val Recall: 0.7311, Val AUC: 0.7788
  3%|██▎                                                                                | 2/73 [00:00<00:28,  2.47it/s]
 11%|█████████                                                                          | 8/73 [00:02<00:22,  2.92it/s]
 19%|███████████████▋                                                                  | 14/73 [00:04<00:19,  3.00it/s]
 27%|██████████████████████▍                                                           | 20/73 [00:06<00:17,  2.95it/s]
 36%|█████████████████████████████▏                                                    | 26/73 [00:08<00:15,  3.01it/s]
 44%|███████████████████████████████████▉                                              | 32/73 [00:10<00:13,  2.99it/s]
 52%|██████████████████████████████████████████▋                                       | 38/73 [00:12<00:11,  3.00it/s]
 60%|█████████████████████████████████████████████████▍                                | 44/73 [00:14<00:09,  3.05it/s]
 68%|████████████████████████████████████████████████████████▏                         | 50/73 [00:16<00:07,  3.02it/s]
 77%|██████████████████████████████████████████████████████████████▉                   | 56/73 [00:18<00:05,  2.97it/s]
 85%|█████████████████████████████████████████████████████████████████████▋            | 62/73 [00:20<00:03,  2.96it/s]
 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:22<00:01,  3.02it/s]
 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:22<00:01,  3.02it/s]
New threshold is 0.40117210149765015
train F1 is 0.8203125
 17%|█████████████▊                                                                     | 3/18 [00:00<00:02,  7.16it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  7.38it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  7.38it/s]
New threshold is 0.3346899747848511
val F1 is 0.6935483813285828
Epoch 67/100, learning rate: 1.9990024829013005e-05
Train Loss: 0.3607, Train Acc: 0.8422, Train f1: 0.8203, Train Precision: 0.7807, Train Recall: 0.8642, Train AUC: 0.9167
Valitadion Loss: 0.6909, Validation Acc: 0.7343, Vall f1: 0.6935, Val Precision: 0.6667, Val Recall: 0.7227, Val AUC: 0.7782
  7%|█████▋                                                                             | 5/73 [00:01<00:24,  2.79it/s]
 15%|████████████▎                                                                     | 11/73 [00:03<00:20,  2.97it/s]
 23%|███████████████████                                                               | 17/73 [00:05<00:18,  3.08it/s]
 32%|█████████████████████████▊                                                        | 23/73 [00:07<00:16,  3.07it/s]
 40%|████████████████████████████████▌                                                 | 29/73 [00:09<00:14,  3.02it/s]
 48%|███████████████████████████████████████▎                                          | 35/73 [00:11<00:12,  3.05it/s]
 56%|██████████████████████████████████████████████                                    | 41/73 [00:13<00:10,  3.02it/s]
 64%|████████████████████████████████████████████████████▊                             | 47/73 [00:15<00:08,  3.04it/s]
 73%|███████████████████████████████████████████████████████████▌                      | 53/73 [00:17<00:06,  3.05it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 60/73 [00:19<00:04,  3.07it/s]
 90%|██████████████████████████████████████████████████████████████████████████▏       | 66/73 [00:21<00:02,  3.06it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:23<00:00,  3.10it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:23<00:00,  3.10it/s]
New threshold is 0.4594046175479889
train F1 is 0.8125633001327515
 67%|██████████████████████████████████████████████████████▋                           | 12/18 [00:01<00:00,  7.76it/s]
 67%|██████████████████████████████████████████████████████▋                           | 12/18 [00:01<00:00,  7.76it/s]
New threshold is 0.2222650796175003
val F1 is 0.682539701461792
Epoch 68/100, learning rate: 1.996761358205663e-05
Train Loss: 0.3591, Train Acc: 0.8413, Train f1: 0.8126, Train Precision: 0.8004, Train Recall: 0.8251, Train AUC: 0.9178
Valitadion Loss: 0.6993, Validation Acc: 0.7203, Vall f1: 0.6825, Val Precision: 0.6466, Val Recall: 0.7227, Val AUC: 0.7726
  4%|███▍                                                                               | 3/73 [00:01<00:25,  2.74it/s]
 12%|██████████▏                                                                        | 9/73 [00:03<00:20,  3.06it/s]
 21%|████████████████▊                                                                 | 15/73 [00:05<00:18,  3.05it/s]
 29%|███████████████████████▌                                                          | 21/73 [00:07<00:16,  3.07it/s]
 37%|██████████████████████████████▎                                                   | 27/73 [00:08<00:15,  3.06it/s]
 47%|██████████████████████████████████████▏                                           | 34/73 [00:11<00:12,  3.05it/s]
 55%|████████████████████████████████████████████▉                                     | 40/73 [00:13<00:10,  3.08it/s]
 63%|███████████████████████████████████████████████████▋                              | 46/73 [00:15<00:08,  3.07it/s]
 71%|██████████████████████████████████████████████████████████▍                       | 52/73 [00:17<00:06,  3.06it/s]
 79%|█████████████████████████████████████████████████████████████████▏                | 58/73 [00:19<00:04,  3.09it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 64/73 [00:20<00:02,  3.09it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:23<00:00,  3.07it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:23<00:00,  3.07it/s]
New threshold is 0.37541481852531433
train F1 is 0.817829430103302
 50%|█████████████████████████████████████████▌                                         | 9/18 [00:01<00:01,  7.71it/s]
 50%|█████████████████████████████████████████▌                                         | 9/18 [00:01<00:01,  7.71it/s]
New threshold is 0.21695534884929657
val F1 is 0.7022900581359863
Epoch 69/100, learning rate: 1.993240468544511e-05
Train Loss: 0.3654, Train Acc: 0.8388, Train f1: 0.8178, Train Precision: 0.7729, Train Recall: 0.8683, Train AUC: 0.9143
Valitadion Loss: 0.6682, Validation Acc: 0.7273, Vall f1: 0.7023, Val Precision: 0.6434, Val Recall: 0.7731, Val AUC: 0.7868
  1%|█▏                                                                                 | 1/73 [00:00<00:36,  1.99it/s]
 11%|█████████                                                                          | 8/73 [00:02<00:21,  3.02it/s]
 19%|███████████████▋                                                                  | 14/73 [00:04<00:19,  3.05it/s]
 27%|██████████████████████▍                                                           | 20/73 [00:06<00:17,  3.08it/s]
 36%|█████████████████████████████▏                                                    | 26/73 [00:08<00:15,  3.07it/s]
 44%|███████████████████████████████████▉                                              | 32/73 [00:10<00:13,  3.07it/s]
 52%|██████████████████████████████████████████▋                                       | 38/73 [00:12<00:11,  3.10it/s]
 60%|█████████████████████████████████████████████████▍                                | 44/73 [00:14<00:09,  3.07it/s]
 70%|█████████████████████████████████████████████████████████▎                        | 51/73 [00:16<00:07,  3.07it/s]
 78%|████████████████████████████████████████████████████████████████                  | 57/73 [00:18<00:05,  3.02it/s]
 86%|██████████████████████████████████████████████████████████████████████▊           | 63/73 [00:20<00:03,  3.01it/s]
 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:22<00:01,  3.06it/s]
 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:22<00:01,  3.06it/s]
New threshold is 0.44372519850730896
train F1 is 0.8324974775314331
 22%|██████████████████▍                                                                | 4/18 [00:00<00:01,  7.54it/s]
  0%|                                                                                           | 0/73 [00:00<?, ?it/s]
  0%|                                                                                           | 0/73 [00:00<?, ?it/s]
New threshold is 0.12106417119503021
val F1 is 0.6934306621551514
Epoch 70/100, learning rate: 1.9884443344697534e-05
Train Loss: 0.3292, Train Acc: 0.8568, Train f1: 0.8325, Train Precision: 0.8121, Train Recall: 0.8539, Train AUC: 0.9326
Valitadion Loss: 0.7054, Validation Acc: 0.7063, Vall f1: 0.6934, Val Precision: 0.6129, Val Recall: 0.7983, Val AUC: 0.7771
  8%|██████▊                                                                            | 6/73 [00:02<00:22,  2.98it/s]
 16%|█████████████▍                                                                    | 12/73 [00:04<00:20,  3.04it/s]
 25%|████████████████████▏                                                             | 18/73 [00:06<00:18,  3.05it/s]
 33%|██████████████████████████▉                                                       | 24/73 [00:08<00:16,  3.02it/s]
 41%|█████████████████████████████████▋                                                | 30/73 [00:10<00:14,  3.02it/s]
 49%|████████████████████████████████████████▍                                         | 36/73 [00:11<00:12,  3.03it/s]
 58%|███████████████████████████████████████████████▏                                  | 42/73 [00:13<00:10,  3.04it/s]
 66%|█████████████████████████████████████████████████████▉                            | 48/73 [00:15<00:08,  3.02it/s]
 74%|████████████████████████████████████████████████████████████▋                     | 54/73 [00:17<00:06,  2.99it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 60/73 [00:19<00:04,  3.03it/s]
 90%|██████████████████████████████████████████████████████████████████████████▏       | 66/73 [00:21<00:02,  3.04it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:24<00:00,  3.02it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:24<00:00,  3.02it/s]
New threshold is 0.43506669998168945
train F1 is 0.8244734406471252
 72%|███████████████████████████████████████████████████████████▏                      | 13/18 [00:01<00:00,  7.70it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 13/18 [00:01<00:00,  7.70it/s]
New threshold is 0.4115159511566162
val F1 is 0.6996197700500488
Epoch 71/100, learning rate: 1.9823791138491856e-05
Train Loss: 0.3590, Train Acc: 0.8499, Train f1: 0.8245, Train Precision: 0.8043, Train Recall: 0.8457, Train AUC: 0.9179
Valitadion Loss: 0.6835, Validation Acc: 0.7238, Vall f1: 0.6996, Val Precision: 0.6389, Val Recall: 0.7731, Val AUC: 0.7770
  4%|███▍                                                                               | 3/73 [00:01<00:25,  2.71it/s]
 12%|██████████▏                                                                        | 9/73 [00:03<00:21,  3.01it/s]
 21%|████████████████▊                                                                 | 15/73 [00:05<00:19,  3.02it/s]
 29%|███████████████████████▌                                                          | 21/73 [00:07<00:17,  3.02it/s]
 37%|██████████████████████████████▎                                                   | 27/73 [00:09<00:15,  2.92it/s]
 45%|█████████████████████████████████████                                             | 33/73 [00:11<00:13,  2.95it/s]
 53%|███████████████████████████████████████████▊                                      | 39/73 [00:13<00:11,  2.92it/s]
 62%|██████████████████████████████████████████████████▌                               | 45/73 [00:15<00:09,  2.92it/s]
 70%|█████████████████████████████████████████████████████████▎                        | 51/73 [00:17<00:07,  2.94it/s]
 78%|████████████████████████████████████████████████████████████████                  | 57/73 [00:19<00:05,  2.93it/s]
 85%|█████████████████████████████████████████████████████████████████████▋            | 62/73 [00:21<00:03,  2.91it/s]
 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:23<00:01,  2.80it/s]
 17%|█████████████▊                                                                     | 3/18 [00:00<00:02,  7.48it/s]
 17%|█████████████▊                                                                     | 3/18 [00:00<00:02,  7.48it/s]
New threshold is 0.35569998621940613
train F1 is 0.8246445655822754
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  7.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  7.60it/s]
New threshold is 0.23188360035419464
val F1 is 0.6771653294563293
Epoch 72/100, learning rate: 1.9750525939602574e-05
Train Loss: 0.3544, Train Acc: 0.8413, Train f1: 0.8246, Train Precision: 0.7645, Train Recall: 0.8951, Train AUC: 0.9206
Valitadion Loss: 0.6788, Validation Acc: 0.7133, Vall f1: 0.6772, Val Precision: 0.6370, Val Recall: 0.7227, Val AUC: 0.7801
  7%|█████▋                                                                             | 5/73 [00:01<00:23,  2.92it/s]
 15%|████████████▎                                                                     | 11/73 [00:03<00:20,  3.02it/s]
 23%|███████████████████                                                               | 17/73 [00:05<00:18,  3.03it/s]
 32%|█████████████████████████▊                                                        | 23/73 [00:07<00:16,  2.99it/s]
 40%|████████████████████████████████▌                                                 | 29/73 [00:09<00:14,  3.03it/s]
 48%|███████████████████████████████████████▎                                          | 35/73 [00:11<00:12,  3.05it/s]
 58%|███████████████████████████████████████████████▏                                  | 42/73 [00:13<00:10,  3.05it/s]
 66%|█████████████████████████████████████████████████████▉                            | 48/73 [00:15<00:08,  3.06it/s]
 74%|████████████████████████████████████████████████████████████▋                     | 54/73 [00:17<00:06,  3.04it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 60/73 [00:19<00:04,  3.00it/s]
 90%|██████████████████████████████████████████████████████████████████████████▏       | 66/73 [00:21<00:02,  2.93it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:23<00:00,  2.92it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:23<00:00,  2.92it/s]
New threshold is 0.3775428235530853
train F1 is 0.8418972492218018
 61%|██████████████████████████████████████████████████                                | 11/18 [00:01<00:00,  7.44it/s]
 61%|██████████████████████████████████████████████████                                | 11/18 [00:01<00:00,  7.44it/s]
New threshold is 0.35662853717803955
val F1 is 0.6976743936538696
Epoch 73/100, learning rate: 1.9664741814918076e-05
Train Loss: 0.3230, Train Acc: 0.8628, Train f1: 0.8419, Train Precision: 0.8099, Train Recall: 0.8765, Train AUC: 0.9345
Valitadion Loss: 0.7038, Validation Acc: 0.7273, Vall f1: 0.6977, Val Precision: 0.6475, Val Recall: 0.7563, Val AUC: 0.7780
  3%|██▎                                                                                | 2/73 [00:00<00:28,  2.46it/s]
 11%|█████████                                                                          | 8/73 [00:02<00:22,  2.92it/s]
 19%|███████████████▋                                                                  | 14/73 [00:04<00:20,  2.94it/s]
 27%|██████████████████████▍                                                           | 20/73 [00:06<00:18,  2.90it/s]
 34%|████████████████████████████                                                      | 25/73 [00:08<00:16,  2.92it/s]
 42%|██████████████████████████████████▊                                               | 31/73 [00:10<00:14,  2.96it/s]
 51%|█████████████████████████████████████████▌                                        | 37/73 [00:12<00:11,  3.02it/s]
 60%|█████████████████████████████████████████████████▍                                | 44/73 [00:15<00:09,  3.05it/s]
 68%|████████████████████████████████████████████████████████▏                         | 50/73 [00:16<00:07,  3.06it/s]
 77%|██████████████████████████████████████████████████████████████▉                   | 56/73 [00:18<00:05,  3.08it/s]
 85%|█████████████████████████████████████████████████████████████████████▋            | 62/73 [00:20<00:03,  3.08it/s]
 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:22<00:01,  3.03it/s]
 17%|█████████████▊                                                                     | 3/18 [00:00<00:01,  7.78it/s]
 17%|█████████████▊                                                                     | 3/18 [00:00<00:01,  7.78it/s]
New threshold is 0.4832252562046051
train F1 is 0.8398357033729553
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  7.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:02<00:00,  7.62it/s]
New threshold is 0.2675507366657257
val F1 is 0.680497944355011
Epoch 74/100, learning rate: 1.956654890466598e-05
Train Loss: 0.3134, Train Acc: 0.8662, Train f1: 0.8398, Train Precision: 0.8381, Train Recall: 0.8416, Train AUC: 0.9395
Valitadion Loss: 0.7611, Validation Acc: 0.7308, Vall f1: 0.6805, Val Precision: 0.6721, Val Recall: 0.6891, Val AUC: 0.7786
  7%|█████▋                                                                             | 5/73 [00:01<00:23,  2.91it/s]
 15%|████████████▎                                                                     | 11/73 [00:03<00:20,  3.05it/s]
 23%|███████████████████                                                               | 17/73 [00:05<00:18,  2.98it/s]
 32%|█████████████████████████▊                                                        | 23/73 [00:07<00:16,  3.00it/s]
 40%|████████████████████████████████▌                                                 | 29/73 [00:09<00:14,  3.04it/s]
 48%|███████████████████████████████████████▎                                          | 35/73 [00:11<00:13,  2.91it/s]
 56%|██████████████████████████████████████████████                                    | 41/73 [00:13<00:10,  3.01it/s]
 64%|████████████████████████████████████████████████████▊                             | 47/73 [00:15<00:08,  2.99it/s]
 73%|███████████████████████████████████████████████████████████▌                      | 53/73 [00:17<00:06,  2.98it/s]
 81%|██████████████████████████████████████████████████████████████████▎               | 59/73 [00:19<00:04,  3.02it/s]
 86%|██████████████████████████████████████████████████████████████████████▊           | 63/73 [00:21<00:03,  3.02it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:23<00:00,  3.03it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:23<00:00,  3.03it/s]
New threshold is 0.39752116799354553
train F1 is 0.8506876230239868
 39%|████████████████████████████████▎                                                  | 7/18 [00:00<00:01,  7.61it/s]
 39%|████████████████████████████████▎                                                  | 7/18 [00:00<00:01,  7.61it/s]
New threshold is 0.3061562478542328
val F1 is 0.6962962746620178
Epoch 75/100, learning rate: 1.945607328100155e-05
Train Loss: 0.3035, Train Acc: 0.8696, Train f1: 0.8507, Train Precision: 0.8139, Train Recall: 0.8909, Train AUC: 0.9423
Valitadion Loss: 0.7473, Validation Acc: 0.7133, Vall f1: 0.6963, Val Precision: 0.6225, Val Recall: 0.7899, Val AUC: 0.7669
  1%|█▏                                                                                 | 1/73 [00:00<00:36,  1.95it/s]
 10%|███████▉                                                                           | 7/73 [00:02<00:22,  2.98it/s]
 18%|██████████████▌                                                                   | 13/73 [00:04<00:19,  3.03it/s]
 26%|█████████████████████▎                                                            | 19/73 [00:06<00:17,  3.01it/s]
 34%|████████████████████████████                                                      | 25/73 [00:08<00:15,  3.00it/s]
 42%|██████████████████████████████████▊                                               | 31/73 [00:10<00:13,  3.02it/s]
 51%|█████████████████████████████████████████▌                                        | 37/73 [00:12<00:12,  2.99it/s]
 59%|████████████████████████████████████████████████▎                                 | 43/73 [00:14<00:09,  3.05it/s]
 67%|███████████████████████████████████████████████████████                           | 49/73 [00:16<00:07,  3.06it/s]
 75%|█████████████████████████████████████████████████████████████▊                    | 55/73 [00:18<00:05,  3.03it/s]
 84%|████████████████████████████████████████████████████████████████████▌             | 61/73 [00:20<00:03,  3.04it/s]
 92%|███████████████████████████████████████████████████████████████████████████▎      | 67/73 [00:22<00:01,  3.04it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:24<00:00,  3.01it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:24<00:00,  3.01it/s]
New threshold is 0.41768041253089905
train F1 is 0.8560158014297485
 83%|████████████████████████████████████████████████████████████████████▎             | 15/18 [00:02<00:00,  7.52it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 15/18 [00:02<00:00,  7.52it/s]
New threshold is 0.18797382712364197
val F1 is 0.694656491279602
Epoch 76/100, learning rate: 1.9333456786140714e-05
Train Loss: 0.2984, Train Acc: 0.8748, Train f1: 0.8560, Train Precision: 0.8220, Train Recall: 0.8930, Train AUC: 0.9448
Valitadion Loss: 0.7382, Validation Acc: 0.7203, Vall f1: 0.6947, Val Precision: 0.6364, Val Recall: 0.7647, Val AUC: 0.7798
  5%|████▌                                                                              | 4/73 [00:01<00:25,  2.75it/s]
 14%|███████████▏                                                                      | 10/73 [00:03<00:21,  2.99it/s]
 22%|█████████████████▉                                                                | 16/73 [00:05<00:19,  2.97it/s]
 30%|████████████████████████▋                                                         | 22/73 [00:07<00:16,  3.01it/s]
 38%|███████████████████████████████▍                                                  | 28/73 [00:09<00:14,  3.05it/s]
 47%|██████████████████████████████████████▏                                           | 34/73 [00:11<00:12,  3.02it/s]
 55%|████████████████████████████████████████████▉                                     | 40/73 [00:13<00:10,  3.02it/s]
 63%|███████████████████████████████████████████████████▋                              | 46/73 [00:15<00:09,  2.96it/s]
 71%|██████████████████████████████████████████████████████████▍                       | 52/73 [00:17<00:06,  3.03it/s]
 79%|█████████████████████████████████████████████████████████████████▏                | 58/73 [00:19<00:04,  3.03it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 64/73 [00:21<00:02,  3.00it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:23<00:00,  3.02it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:23<00:00,  3.02it/s]
New threshold is 0.40689724683761597
train F1 is 0.857994019985199
 44%|████████████████████████████████████▉                                              | 8/18 [00:01<00:01,  7.73it/s]
 44%|████████████████████████████████████▉                                              | 8/18 [00:01<00:01,  7.73it/s]
New threshold is 0.14879344403743744
val F1 is 0.6848248839378357
Epoch 77/100, learning rate: 1.919885685024556e-05
Train Loss: 0.2937, Train Acc: 0.8774, Train f1: 0.8580, Train Precision: 0.8292, Train Recall: 0.8889, Train AUC: 0.9459
Valitadion Loss: 0.7638, Validation Acc: 0.7168, Vall f1: 0.6848, Val Precision: 0.6377, Val Recall: 0.7395, Val AUC: 0.7801
  1%|█▏                                                                                 | 1/73 [00:00<00:35,  2.01it/s]
 10%|███████▉                                                                           | 7/73 [00:02<00:22,  2.96it/s]
 18%|██████████████▌                                                                   | 13/73 [00:04<00:19,  3.03it/s]
 26%|█████████████████████▎                                                            | 19/73 [00:06<00:17,  3.04it/s]
 34%|████████████████████████████                                                      | 25/73 [00:08<00:15,  3.06it/s]
 42%|██████████████████████████████████▊                                               | 31/73 [00:10<00:13,  3.03it/s]
 51%|█████████████████████████████████████████▌                                        | 37/73 [00:12<00:11,  3.04it/s]
 59%|████████████████████████████████████████████████▎                                 | 43/73 [00:14<00:09,  3.07it/s]
 67%|███████████████████████████████████████████████████████                           | 49/73 [00:16<00:07,  3.04it/s]
 77%|██████████████████████████████████████████████████████████████▉                   | 56/73 [00:18<00:05,  3.04it/s]
 85%|█████████████████████████████████████████████████████████████████████▋            | 62/73 [00:20<00:03,  3.06it/s]
 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:22<00:01,  3.03it/s]
 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:22<00:01,  3.03it/s]
New threshold is 0.375550240278244
train F1 is 0.873900294303894
 11%|█████████▏                                                                         | 2/18 [00:00<00:02,  7.19it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 17/18 [00:02<00:00,  7.59it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 17/18 [00:02<00:00,  7.59it/s]
New threshold is 0.1403108537197113
val F1 is 0.6969696879386902
Epoch 78/100, learning rate: 1.9052446289296104e-05
Train Loss: 0.2802, Train Acc: 0.8894, Train f1: 0.8739, Train Precision: 0.8324, Train Recall: 0.9198, Train AUC: 0.9510
Valitadion Loss: 0.7680, Validation Acc: 0.7203, Vall f1: 0.6970, Val Precision: 0.6345, Val Recall: 0.7731, Val AUC: 0.7794
  5%|████▌                                                                              | 4/73 [00:01<00:24,  2.82it/s]
 15%|████████████▎                                                                     | 11/73 [00:03<00:20,  3.04it/s]
 23%|███████████████████                                                               | 17/73 [00:05<00:18,  3.06it/s]
 32%|█████████████████████████▊                                                        | 23/73 [00:07<00:16,  3.06it/s]
 40%|████████████████████████████████▌                                                 | 29/73 [00:09<00:14,  3.05it/s]
 48%|███████████████████████████████████████▎                                          | 35/73 [00:11<00:12,  3.03it/s]
 56%|██████████████████████████████████████████████                                    | 41/73 [00:13<00:10,  3.04it/s]
 64%|████████████████████████████████████████████████████▊                             | 47/73 [00:15<00:08,  3.05it/s]
 73%|███████████████████████████████████████████████████████████▌                      | 53/73 [00:17<00:06,  3.04it/s]
 81%|██████████████████████████████████████████████████████████████████▎               | 59/73 [00:19<00:04,  3.01it/s]
 89%|█████████████████████████████████████████████████████████████████████████         | 65/73 [00:21<00:02,  3.03it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:23<00:00,  3.06it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:23<00:00,  3.06it/s]
New threshold is 0.42864322662353516
train F1 is 0.8695651888847351
 61%|██████████████████████████████████████████████████                                | 11/18 [00:01<00:00,  7.51it/s]
 61%|██████████████████████████████████████████████████                                | 11/18 [00:01<00:00,  7.51it/s]
New threshold is 0.4345055818557739
val F1 is 0.6801619529724121
Epoch 79/100, learning rate: 1.889441308320784e-05
Train Loss: 0.2728, Train Acc: 0.8894, Train f1: 0.8696, Train Precision: 0.8549, Train Recall: 0.8848, Train AUC: 0.9536
Valitadion Loss: 0.7432, Validation Acc: 0.7238, Vall f1: 0.6802, Val Precision: 0.6562, Val Recall: 0.7059, Val AUC: 0.7852
  3%|██▎                                                                                | 2/73 [00:00<00:28,  2.49it/s]
 11%|█████████                                                                          | 8/73 [00:02<00:21,  2.99it/s]
 19%|███████████████▋                                                                  | 14/73 [00:04<00:19,  3.03it/s]
 27%|██████████████████████▍                                                           | 20/73 [00:06<00:17,  3.03it/s]
 36%|█████████████████████████████▏                                                    | 26/73 [00:08<00:15,  3.02it/s]
 44%|███████████████████████████████████▉                                              | 32/73 [00:10<00:13,  3.01it/s]
 52%|██████████████████████████████████████████▋                                       | 38/73 [00:12<00:11,  2.94it/s]
 60%|█████████████████████████████████████████████████▍                                | 44/73 [00:14<00:09,  3.02it/s]
 68%|████████████████████████████████████████████████████████▏                         | 50/73 [00:16<00:07,  3.03it/s]
 78%|████████████████████████████████████████████████████████████████                  | 57/73 [00:19<00:05,  3.06it/s]
 86%|██████████████████████████████████████████████████████████████████████▊           | 63/73 [00:21<00:03,  3.01it/s]
 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:22<00:01,  3.03it/s]
 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:22<00:01,  3.03it/s]
New threshold is 0.4768674671649933
train F1 is 0.8904810547828674
 22%|██████████████████▍                                                                | 4/18 [00:00<00:01,  7.44it/s]
  0%|                                                                                           | 0/73 [00:00<?, ?it/s]
  0%|                                                                                           | 0/73 [00:00<?, ?it/s]
New threshold is 0.3000620901584625
val F1 is 0.6913580298423767
Epoch 80/100, learning rate: 1.872496013447997e-05
Train Loss: 0.2443, Train Acc: 0.9082, Train f1: 0.8905, Train Precision: 0.8859, Train Recall: 0.8951, Train AUC: 0.9629
Valitadion Loss: 0.7899, Validation Acc: 0.7378, Vall f1: 0.6914, Val Precision: 0.6774, Val Recall: 0.7059, Val AUC: 0.7826
  7%|█████▋                                                                             | 5/73 [00:01<00:23,  2.87it/s]
 15%|████████████▎                                                                     | 11/73 [00:03<00:20,  3.04it/s]
 23%|███████████████████                                                               | 17/73 [00:05<00:18,  3.02it/s]
 32%|█████████████████████████▊                                                        | 23/73 [00:07<00:16,  3.02it/s]
 40%|████████████████████████████████▌                                                 | 29/73 [00:09<00:14,  3.03it/s]
 49%|████████████████████████████████████████▍                                         | 36/73 [00:12<00:12,  3.04it/s]
 58%|███████████████████████████████████████████████▏                                  | 42/73 [00:14<00:10,  3.07it/s]
 66%|█████████████████████████████████████████████████████▉                            | 48/73 [00:16<00:08,  3.04it/s]
 74%|████████████████████████████████████████████████████████████▋                     | 54/73 [00:17<00:06,  3.04it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 60/73 [00:19<00:04,  3.04it/s]
 90%|██████████████████████████████████████████████████████████████████████████▏       | 66/73 [00:21<00:02,  3.01it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:23<00:00,  3.03it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:23<00:00,  3.03it/s]
New threshold is 0.401996374130249
train F1 is 0.8764940500259399
 67%|██████████████████████████████████████████████████████▋                           | 12/18 [00:01<00:00,  7.47it/s]
 67%|██████████████████████████████████████████████████████▋                           | 12/18 [00:01<00:00,  7.47it/s]
New threshold is 0.08512771129608154
val F1 is 0.7122302055358887
Epoch 81/100, learning rate: 1.854430500768417e-05
Train Loss: 0.2598, Train Acc: 0.8937, Train f1: 0.8765, Train Precision: 0.8494, Train Recall: 0.9053, Train AUC: 0.9574
Valitadion Loss: 0.7791, Validation Acc: 0.7203, Vall f1: 0.7122, Val Precision: 0.6226, Val Recall: 0.8319, Val AUC: 0.7873
  4%|███▍                                                                               | 3/73 [00:01<00:25,  2.70it/s]
 12%|██████████▏                                                                        | 9/73 [00:03<00:21,  3.01it/s]
 21%|████████████████▊                                                                 | 15/73 [00:05<00:19,  3.04it/s]
 29%|███████████████████████▌                                                          | 21/73 [00:07<00:17,  3.04it/s]
 37%|██████████████████████████████▎                                                   | 27/73 [00:09<00:15,  3.04it/s]
 45%|█████████████████████████████████████                                             | 33/73 [00:11<00:13,  3.05it/s]
 53%|███████████████████████████████████████████▊                                      | 39/73 [00:13<00:11,  3.02it/s]
 62%|██████████████████████████████████████████████████▌                               | 45/73 [00:15<00:09,  3.03it/s]
 70%|█████████████████████████████████████████████████████████▎                        | 51/73 [00:16<00:07,  3.02it/s]
 78%|████████████████████████████████████████████████████████████████                  | 57/73 [00:18<00:05,  3.05it/s]
 86%|██████████████████████████████████████████████████████████████████████▊           | 63/73 [00:20<00:03,  3.02it/s]
 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:22<00:01,  3.05it/s]
 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:22<00:01,  3.05it/s]
New threshold is 0.4826405942440033
train F1 is 0.8884339928627014
 33%|███████████████████████████▋                                                       | 6/18 [00:00<00:01,  7.53it/s]
 33%|███████████████████████████▋                                                       | 6/18 [00:00<00:01,  7.53it/s]
New threshold is 0.04764176160097122
val F1 is 0.7032967209815979
Epoch 82/100, learning rate: 1.8352679650128396e-05
Train Loss: 0.2241, Train Acc: 0.9065, Train f1: 0.8884, Train Precision: 0.8839, Train Recall: 0.8930, Train AUC: 0.9706
Valitadion Loss: 0.8561, Validation Acc: 0.7168, Vall f1: 0.7033, Val Precision: 0.6234, Val Recall: 0.8067, Val AUC: 0.7822
  0%|                                                                                           | 0/73 [00:00<?, ?it/s]
  8%|██████▊                                                                            | 6/73 [00:02<00:22,  2.95it/s]
 16%|█████████████▍                                                                    | 12/73 [00:04<00:20,  3.05it/s]
 25%|████████████████████▏                                                             | 18/73 [00:06<00:18,  3.03it/s]
 33%|██████████████████████████▉                                                       | 24/73 [00:08<00:16,  3.05it/s]
 41%|█████████████████████████████████▋                                                | 30/73 [00:10<00:14,  3.04it/s]
 49%|████████████████████████████████████████▍                                         | 36/73 [00:12<00:12,  3.01it/s]
 59%|████████████████████████████████████████████████▎                                 | 43/73 [00:14<00:09,  3.04it/s]
 67%|███████████████████████████████████████████████████████                           | 49/73 [00:16<00:07,  3.03it/s]
 75%|█████████████████████████████████████████████████████████████▊                    | 55/73 [00:18<00:05,  3.02it/s]
 84%|████████████████████████████████████████████████████████████████████▌             | 61/73 [00:20<00:03,  3.05it/s]
 92%|███████████████████████████████████████████████████████████████████████████▎      | 67/73 [00:22<00:01,  3.04it/s]
  0%|                                                                                           | 0/18 [00:00<?, ?it/s]
  0%|                                                                                           | 0/18 [00:00<?, ?it/s]
New threshold is 0.4272725284099579
train F1 is 0.89180988073349
 83%|████████████████████████████████████████████████████████████████████▎             | 15/18 [00:02<00:00,  7.56it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 15/18 [00:02<00:00,  7.56it/s]
New threshold is 0.24802622199058533
val F1 is 0.7037037014961243
Epoch 83/100, learning rate: 1.8150330094054362e-05
Train Loss: 0.2360, Train Acc: 0.9082, Train f1: 0.8918, Train Precision: 0.8767, Train Recall: 0.9074, Train AUC: 0.9658
Valitadion Loss: 0.8147, Validation Acc: 0.7203, Vall f1: 0.7037, Val Precision: 0.6291, Val Recall: 0.7983, Val AUC: 0.7761
  5%|████▌                                                                              | 4/73 [00:01<00:24,  2.83it/s]
 14%|███████████▏                                                                      | 10/73 [00:03<00:21,  2.98it/s]
 22%|█████████████████▉                                                                | 16/73 [00:05<00:18,  3.04it/s]
 30%|████████████████████████▋                                                         | 22/73 [00:07<00:16,  3.01it/s]
 38%|███████████████████████████████▍                                                  | 28/73 [00:09<00:14,  3.01it/s]
 47%|██████████████████████████████████████▏                                           | 34/73 [00:11<00:12,  3.03it/s]
 55%|████████████████████████████████████████████▉                                     | 40/73 [00:13<00:11,  3.00it/s]
 63%|███████████████████████████████████████████████████▋                              | 46/73 [00:15<00:08,  3.04it/s]
 71%|██████████████████████████████████████████████████████████▍                       | 52/73 [00:17<00:06,  3.03it/s]
 79%|█████████████████████████████████████████████████████████████████▏                | 58/73 [00:19<00:04,  3.02it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 64/73 [00:21<00:02,  3.06it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:23<00:00,  3.02it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:23<00:00,  3.02it/s]
New threshold is 0.3853948712348938
train F1 is 0.886454164981842
 39%|████████████████████████████████▎                                                  | 7/18 [00:00<00:01,  7.28it/s]
 39%|████████████████████████████████▎                                                  | 7/18 [00:00<00:01,  7.28it/s]
New threshold is 0.6605820059776306
val F1 is 0.6582278609275818
Epoch 84/100, learning rate: 1.793751614075101e-05
Train Loss: 0.2407, Train Acc: 0.9022, Train f1: 0.8865, Train Precision: 0.8591, Train Recall: 0.9156, Train AUC: 0.9637
Valitadion Loss: 0.8148, Validation Acc: 0.7168, Vall f1: 0.6582, Val Precision: 0.6610, Val Recall: 0.6555, Val AUC: 0.7729
  1%|█▏                                                                                 | 1/73 [00:00<00:37,  1.94it/s]
 10%|███████▉                                                                           | 7/73 [00:02<00:22,  2.96it/s]
 18%|██████████████▌                                                                   | 13/73 [00:04<00:19,  3.00it/s]
 26%|█████████████████████▎                                                            | 19/73 [00:06<00:17,  3.00it/s]
 34%|████████████████████████████                                                      | 25/73 [00:08<00:15,  3.02it/s]
 42%|██████████████████████████████████▊                                               | 31/73 [00:10<00:13,  3.01it/s]
 51%|█████████████████████████████████████████▌                                        | 37/73 [00:12<00:11,  3.03it/s]
 59%|████████████████████████████████████████████████▎                                 | 43/73 [00:14<00:09,  3.01it/s]
 67%|███████████████████████████████████████████████████████                           | 49/73 [00:16<00:07,  3.04it/s]
 75%|█████████████████████████████████████████████████████████████▊                    | 55/73 [00:18<00:05,  3.03it/s]
 84%|████████████████████████████████████████████████████████████████████▌             | 61/73 [00:20<00:03,  3.03it/s]
 92%|███████████████████████████████████████████████████████████████████████████▎      | 67/73 [00:22<00:01,  3.03it/s]
  0%|                                                                                           | 0/18 [00:00<?, ?it/s]
  0%|                                                                                           | 0/18 [00:00<?, ?it/s]
New threshold is 0.4101516902446747
train F1 is 0.8915423154830933
 83%|████████████████████████████████████████████████████████████████████▎             | 15/18 [00:02<00:00,  7.52it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 15/18 [00:02<00:00,  7.52it/s]
New threshold is 0.10949251800775528
val F1 is 0.6907630562782288
Epoch 85/100, learning rate: 1.7714511026989646e-05
Train Loss: 0.2320, Train Acc: 0.9065, Train f1: 0.8915, Train Precision: 0.8632, Train Recall: 0.9218, Train AUC: 0.9674
Valitadion Loss: 0.8601, Validation Acc: 0.7308, Vall f1: 0.6908, Val Precision: 0.6615, Val Recall: 0.7227, Val AUC: 0.7854
  5%|████▌                                                                              | 4/73 [00:01<00:24,  2.84it/s]
 14%|███████████▏                                                                      | 10/73 [00:03<00:20,  3.02it/s]
 22%|█████████████████▉                                                                | 16/73 [00:05<00:18,  3.04it/s]
 30%|████████████████████████▋                                                         | 22/73 [00:07<00:16,  3.01it/s]
 38%|███████████████████████████████▍                                                  | 28/73 [00:09<00:15,  2.98it/s]
 47%|██████████████████████████████████████▏                                           | 34/73 [00:11<00:13,  2.97it/s]
KeyboardInterrupt   ^^^^^^^^^^^\Desktop\mberghouse\Mammo_classification_scripts\cbisddsm_classification_300x500.py", line 174, in train_model
KeyboardInterrupt   ^^^^^^^^^^^\Desktop\mberghouse\Mammo_classification_scripts\cbisddsm_classification_300x500.py", line 174, in train_model