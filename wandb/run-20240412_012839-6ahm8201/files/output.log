
  2%|█▉                                                                                 | 2/84 [00:02<01:23,  1.02s/it]
stem.conv.weight
stem.conv.bias
stem.norm.weight
stem.norm.bias
stages.0.blocks.0.0.cpe1.proj.weight
stages.0.blocks.0.0.cpe1.proj.bias
stages.0.blocks.0.0.norm1.weight
stages.0.blocks.0.0.norm1.bias
stages.0.blocks.0.0.attn.qkv.weight
stages.0.blocks.0.0.attn.qkv.bias
stages.0.blocks.0.0.attn.proj.weight
stages.0.blocks.0.0.attn.proj.bias
stages.0.blocks.0.0.cpe2.proj.weight
stages.0.blocks.0.0.cpe2.proj.bias
stages.0.blocks.0.0.norm2.weight
stages.0.blocks.0.0.norm2.bias
stages.0.blocks.0.0.mlp.fc1.weight
stages.0.blocks.0.0.mlp.fc1.bias
stages.0.blocks.0.0.mlp.fc2.weight
stages.0.blocks.0.0.mlp.fc2.bias
stages.0.blocks.0.1.cpe1.proj.weight
stages.0.blocks.0.1.cpe1.proj.bias
stages.0.blocks.0.1.norm1.weight
stages.0.blocks.0.1.norm1.bias
stages.0.blocks.0.1.attn.qkv.weight
stages.0.blocks.0.1.attn.qkv.bias
stages.0.blocks.0.1.attn.proj.weight
stages.0.blocks.0.1.attn.proj.bias
stages.0.blocks.0.1.cpe2.proj.weight
stages.0.blocks.0.1.cpe2.proj.bias
stages.0.blocks.0.1.norm2.weight
stages.0.blocks.0.1.norm2.bias
stages.0.blocks.0.1.mlp.fc1.weight
stages.0.blocks.0.1.mlp.fc1.bias
stages.0.blocks.0.1.mlp.fc2.weight
stages.0.blocks.0.1.mlp.fc2.bias
stages.1.downsample.norm.weight
stages.1.downsample.norm.bias
stages.1.downsample.conv.weight
stages.1.downsample.conv.bias
stages.1.blocks.0.0.cpe1.proj.weight
stages.1.blocks.0.0.cpe1.proj.bias
stages.1.blocks.0.0.norm1.weight
stages.1.blocks.0.0.norm1.bias
stages.1.blocks.0.0.attn.qkv.weight
stages.1.blocks.0.0.attn.qkv.bias
stages.1.blocks.0.0.attn.proj.weight
stages.1.blocks.0.0.attn.proj.bias
stages.1.blocks.0.0.cpe2.proj.weight
stages.1.blocks.0.0.cpe2.proj.bias
stages.1.blocks.0.0.norm2.weight
stages.1.blocks.0.0.norm2.bias
stages.1.blocks.0.0.mlp.fc1.weight
stages.1.blocks.0.0.mlp.fc1.bias
stages.1.blocks.0.0.mlp.fc2.weight
stages.1.blocks.0.0.mlp.fc2.bias
stages.1.blocks.0.1.cpe1.proj.weight
stages.1.blocks.0.1.cpe1.proj.bias
stages.1.blocks.0.1.norm1.weight
stages.1.blocks.0.1.norm1.bias
stages.1.blocks.0.1.attn.qkv.weight
stages.1.blocks.0.1.attn.qkv.bias
stages.1.blocks.0.1.attn.proj.weight
stages.1.blocks.0.1.attn.proj.bias
stages.1.blocks.0.1.cpe2.proj.weight
stages.1.blocks.0.1.cpe2.proj.bias
stages.1.blocks.0.1.norm2.weight
stages.1.blocks.0.1.norm2.bias
stages.1.blocks.0.1.mlp.fc1.weight
stages.1.blocks.0.1.mlp.fc1.bias
stages.1.blocks.0.1.mlp.fc2.weight
stages.1.blocks.0.1.mlp.fc2.bias
stages.2.downsample.norm.weight
stages.2.downsample.norm.bias
stages.2.downsample.conv.weight
stages.2.downsample.conv.bias
stages.2.blocks.0.0.cpe1.proj.weight
stages.2.blocks.0.0.cpe1.proj.bias
stages.2.blocks.0.0.norm1.weight
stages.2.blocks.0.0.norm1.bias
stages.2.blocks.0.0.attn.qkv.weight
stages.2.blocks.0.0.attn.qkv.bias
stages.2.blocks.0.0.attn.proj.weight
stages.2.blocks.0.0.attn.proj.bias
stages.2.blocks.0.0.cpe2.proj.weight
stages.2.blocks.0.0.cpe2.proj.bias
stages.2.blocks.0.0.norm2.weight
stages.2.blocks.0.0.norm2.bias
stages.2.blocks.0.0.mlp.fc1.weight
stages.2.blocks.0.0.mlp.fc1.bias
stages.2.blocks.0.0.mlp.fc2.weight
stages.2.blocks.0.0.mlp.fc2.bias
stages.2.blocks.0.1.cpe1.proj.weight
stages.2.blocks.0.1.cpe1.proj.bias
stages.2.blocks.0.1.norm1.weight
stages.2.blocks.0.1.norm1.bias
stages.2.blocks.0.1.attn.qkv.weight
stages.2.blocks.0.1.attn.qkv.bias
stages.2.blocks.0.1.attn.proj.weight
stages.2.blocks.0.1.attn.proj.bias
stages.2.blocks.0.1.cpe2.proj.weight
stages.2.blocks.0.1.cpe2.proj.bias
stages.2.blocks.0.1.norm2.weight
stages.2.blocks.0.1.norm2.bias
stages.2.blocks.0.1.mlp.fc1.weight
stages.2.blocks.0.1.mlp.fc1.bias
stages.2.blocks.0.1.mlp.fc2.weight
stages.2.blocks.0.1.mlp.fc2.bias
stages.2.blocks.1.0.cpe1.proj.weight
stages.2.blocks.1.0.cpe1.proj.bias
stages.2.blocks.1.0.norm1.weight
stages.2.blocks.1.0.norm1.bias
stages.2.blocks.1.0.attn.qkv.weight
stages.2.blocks.1.0.attn.qkv.bias
stages.2.blocks.1.0.attn.proj.weight
stages.2.blocks.1.0.attn.proj.bias
stages.2.blocks.1.0.cpe2.proj.weight
stages.2.blocks.1.0.cpe2.proj.bias
stages.2.blocks.1.0.norm2.weight
stages.2.blocks.1.0.norm2.bias
stages.2.blocks.1.0.mlp.fc1.weight
stages.2.blocks.1.0.mlp.fc1.bias
stages.2.blocks.1.0.mlp.fc2.weight
stages.2.blocks.1.0.mlp.fc2.bias
stages.2.blocks.1.1.cpe1.proj.weight
stages.2.blocks.1.1.cpe1.proj.bias
stages.2.blocks.1.1.norm1.weight
stages.2.blocks.1.1.norm1.bias
stages.2.blocks.1.1.attn.qkv.weight
stages.2.blocks.1.1.attn.qkv.bias
stages.2.blocks.1.1.attn.proj.weight
stages.2.blocks.1.1.attn.proj.bias
stages.2.blocks.1.1.cpe2.proj.weight
stages.2.blocks.1.1.cpe2.proj.bias
stages.2.blocks.1.1.norm2.weight
stages.2.blocks.1.1.norm2.bias
stages.2.blocks.1.1.mlp.fc1.weight
stages.2.blocks.1.1.mlp.fc1.bias
stages.2.blocks.1.1.mlp.fc2.weight
stages.2.blocks.1.1.mlp.fc2.bias
stages.2.blocks.2.0.cpe1.proj.weight
stages.2.blocks.2.0.cpe1.proj.bias
stages.2.blocks.2.0.norm1.weight
stages.2.blocks.2.0.norm1.bias
stages.2.blocks.2.0.attn.qkv.weight
stages.2.blocks.2.0.attn.qkv.bias
stages.2.blocks.2.0.attn.proj.weight
stages.2.blocks.2.0.attn.proj.bias
stages.2.blocks.2.0.cpe2.proj.weight
stages.2.blocks.2.0.cpe2.proj.bias
stages.2.blocks.2.0.norm2.weight
stages.2.blocks.2.0.norm2.bias
stages.2.blocks.2.0.mlp.fc1.weight
stages.2.blocks.2.0.mlp.fc1.bias
stages.2.blocks.2.0.mlp.fc2.weight
stages.2.blocks.2.0.mlp.fc2.bias
stages.2.blocks.2.1.cpe1.proj.weight
stages.2.blocks.2.1.cpe1.proj.bias
stages.2.blocks.2.1.norm1.weight
stages.2.blocks.2.1.norm1.bias
stages.2.blocks.2.1.attn.qkv.weight
stages.2.blocks.2.1.attn.qkv.bias
stages.2.blocks.2.1.attn.proj.weight
stages.2.blocks.2.1.attn.proj.bias
stages.2.blocks.2.1.cpe2.proj.weight
stages.2.blocks.2.1.cpe2.proj.bias
stages.2.blocks.2.1.norm2.weight
stages.2.blocks.2.1.norm2.bias
stages.2.blocks.2.1.mlp.fc1.weight
stages.2.blocks.2.1.mlp.fc1.bias
stages.2.blocks.2.1.mlp.fc2.weight
stages.2.blocks.2.1.mlp.fc2.bias
stages.3.downsample.norm.weight
stages.3.downsample.norm.bias
stages.3.downsample.conv.weight
stages.3.downsample.conv.bias
stages.3.blocks.0.0.cpe1.proj.weight
stages.3.blocks.0.0.cpe1.proj.bias
stages.3.blocks.0.0.norm1.weight
stages.3.blocks.0.0.norm1.bias
stages.3.blocks.0.0.attn.qkv.weight
stages.3.blocks.0.0.attn.qkv.bias
stages.3.blocks.0.0.attn.proj.weight
stages.3.blocks.0.0.attn.proj.bias
stages.3.blocks.0.0.cpe2.proj.weight
stages.3.blocks.0.0.cpe2.proj.bias
stages.3.blocks.0.0.norm2.weight
stages.3.blocks.0.0.norm2.bias
stages.3.blocks.0.0.mlp.fc1.weight
stages.3.blocks.0.0.mlp.fc1.bias
stages.3.blocks.0.0.mlp.fc2.weight
stages.3.blocks.0.0.mlp.fc2.bias
stages.3.blocks.0.1.cpe1.proj.weight
stages.3.blocks.0.1.cpe1.proj.bias
stages.3.blocks.0.1.norm1.weight
stages.3.blocks.0.1.norm1.bias
stages.3.blocks.0.1.attn.qkv.weight
stages.3.blocks.0.1.attn.qkv.bias
stages.3.blocks.0.1.attn.proj.weight
stages.3.blocks.0.1.attn.proj.bias
stages.3.blocks.0.1.cpe2.proj.weight
stages.3.blocks.0.1.cpe2.proj.bias
stages.3.blocks.0.1.norm2.weight
stages.3.blocks.0.1.norm2.bias
stages.3.blocks.0.1.mlp.fc1.weight
stages.3.blocks.0.1.mlp.fc1.bias
stages.3.blocks.0.1.mlp.fc2.weight
stages.3.blocks.0.1.mlp.fc2.bias
head.norm.weight
head.norm.bias
head.fc.weight
head.fc.bias
head.fc.bias
DaVit(
  (stem): Stem(
    (conv): Conv2d(3, 96, kernel_size=(7, 7), stride=(4, 4), padding=(3, 3))
    (norm): LayerNorm2d((96,), eps=1e-05, elementwise_affine=True)
  )
  (stages): Sequential(
    (0): DaVitStage(
      (downsample): Identity()
      (blocks): Sequential(
        (0): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=96)
              (act): Identity()
            )
            (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=96, out_features=288, bias=True)
              (proj): Linear(in_features=96, out_features=96, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=96)
              (act): Identity()
            )
            (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=96, out_features=384, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=384, out_features=96, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=96)
              (act): Identity()
            )
            (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=96, out_features=288, bias=True)
              (proj): Linear(in_features=96, out_features=96, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=96)
              (act): Identity()
            )
            (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=96, out_features=384, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=384, out_features=96, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
      )
    )
    (1): DaVitStage(
      (downsample): Downsample(
        (norm): LayerNorm2d((96,), eps=1e-05, elementwise_affine=True)
        (conv): Conv2d(96, 192, kernel_size=(2, 2), stride=(2, 2))
      )
      (blocks): Sequential(
        (0): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192)
              (act): Identity()
            )
            (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=192, out_features=576, bias=True)
              (proj): Linear(in_features=192, out_features=192, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192)
              (act): Identity()
            )
            (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=192, out_features=768, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=768, out_features=192, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192)
              (act): Identity()
            )
            (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=192, out_features=576, bias=True)
              (proj): Linear(in_features=192, out_features=192, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192)
              (act): Identity()
            )
            (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=192, out_features=768, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=768, out_features=192, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
      )
    )
    (2): DaVitStage(
      (downsample): Downsample(
        (norm): LayerNorm2d((192,), eps=1e-05, elementwise_affine=True)
        (conv): Conv2d(192, 384, kernel_size=(2, 2), stride=(2, 2))
      )
      (blocks): Sequential(
        (0): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
        (1): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
        (2): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
      )
    )
    (3): DaVitStage(
      (downsample): Downsample(
        (norm): LayerNorm2d((384,), eps=1e-05, elementwise_affine=True)
        (conv): Conv2d(384, 768, kernel_size=(2, 2), stride=(2, 2))
      )
      (blocks): Sequential(
        (0): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(768, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=768)
              (act): Identity()
            )
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (proj): Linear(in_features=768, out_features=768, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(768, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=768)
              (act): Identity()
            )
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(768, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=768)
              (act): Identity()
            )
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (proj): Linear(in_features=768, out_features=768, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(768, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=768)
              (act): Identity()
            )
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
      )
    )
  )
  (norm_pre): Identity()
  (head): NormMlpClassifierHead(
    (global_pool): SelectAdaptivePool2d(pool_type=avg, flatten=Identity())
    (norm): LayerNorm2d((768,), eps=1e-05, elementwise_affine=True)
    (flatten): Flatten(start_dim=1, end_dim=-1)
    (pre_logits): Identity()
    (drop): Dropout(p=0.0, inplace=False)
    (fc): Sequential(
      (0): Dropout(p=0.2, inplace=False)
      (1): Linear(in_features=768, out_features=64, bias=False)
      (2): GELU(approximate='none')
      (3): Linear(in_features=64, out_features=1, bias=False)
      (4): Sigmoid()
    )
  )
)
Starting training...
--------------------





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.09it/s]
New threshold is 0.42630481719970703
train F1 is 0.4951880872249603
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.41it/s]
New threshold is 0.41464290022850037
val F1 is 0.5714285969734192
Epoch 1/40, learning rate: 1.9864292578550327e-05
Train Loss: 0.6807, Train Acc: 0.5051, Train f1: 0.4952, Train Precision: 0.4288, Train Recall: 0.5859, Train AUC: 0.5002
Valitadion Loss: 0.6763, Validation Acc: 0.5909, Vall f1: 0.5714, Val Precision: 0.5065, Val Recall: 0.6555, Val AUC: 0.6006
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.03it/s]
New threshold is 0.426961213350296
train F1 is 0.5117591619491577
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.08it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.41it/s]
New threshold is 0.3654268980026245
val F1 is 0.5795918107032776
Epoch 2/40, learning rate: 1.9460853615232776e-05
Train Loss: 0.6720, Train Acc: 0.5549, Train f1: 0.5118, Train Precision: 0.4690, Train Recall: 0.5631, Train AUC: 0.5596
Valitadion Loss: 0.6755, Validation Acc: 0.6399, Vall f1: 0.5796, Val Precision: 0.5635, Val Recall: 0.5966, Val AUC: 0.6392
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.43it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 83/84 [01:15<00:00,  1.10it/s]
New threshold is 0.41790929436683655
train F1 is 0.5165048837661743
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:07<00:00,  2.40it/s]
New threshold is 0.37573838233947754
val F1 is 0.6159420013427734
Epoch 3/40, learning rate: 1.8800633042879672e-05
Train Loss: 0.6675, Train Acc: 0.5729, Train f1: 0.5165, Train Precision: 0.4863, Train Recall: 0.5507, Train AUC: 0.5796
Valitadion Loss: 0.6670, Validation Acc: 0.6294, Vall f1: 0.6159, Val Precision: 0.5414, Val Recall: 0.7143, Val AUC: 0.6525
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.49it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.09it/s]
New threshold is 0.4173276424407959
train F1 is 0.5281124711036682
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.40it/s]
New threshold is 0.4870537221431732
val F1 is 0.5322580933570862
Epoch 4/40, learning rate: 1.79015502286794e-05
Train Loss: 0.6658, Train Acc: 0.5969, Train f1: 0.5281, Train Precision: 0.5127, Train Recall: 0.5445, Train AUC: 0.5993
Valitadion Loss: 0.6749, Validation Acc: 0.5944, Vall f1: 0.5323, Val Precision: 0.5116, Val Recall: 0.5546, Val AUC: 0.6401
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.47it/s]





































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:14<00:02,  1.09it/s]
New threshold is 0.4315570592880249
train F1 is 0.5346341729164124
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.47it/s]
  0%|                                                                                           | 0/84 [00:00<?, ?it/s]
New threshold is 0.47240206599235535
val F1 is 0.5714285969734192
Epoch 5/40, learning rate: 1.678800761592905e-05
Train Loss: 0.6584, Train Acc: 0.5909, Train f1: 0.5346, Train Precision: 0.5055, Train Recall: 0.5673, Train AUC: 0.6213
Valitadion Loss: 0.6638, Validation Acc: 0.6329, Vall f1: 0.5714, Val Precision: 0.5556, Val Recall: 0.5882, Val AUC: 0.6437





































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:13<00:02,  1.09it/s]
New threshold is 0.42183905839920044
train F1 is 0.5884543657302856
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.11it/s]




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:07<00:00,  2.41it/s]
New threshold is 0.4493221938610077
val F1 is 0.6053639650344849
Epoch 6/40, learning rate: 1.549022840546991e-05
Train Loss: 0.6397, Train Acc: 0.6209, Train f1: 0.5885, Train Precision: 0.5347, Train Recall: 0.6542, Train AUC: 0.6631
Valitadion Loss: 0.6515, Validation Acc: 0.6399, Vall f1: 0.6054, Val Precision: 0.5563, Val Recall: 0.6639, Val AUC: 0.6476
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.49it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:14<00:01,  1.10it/s]
New threshold is 0.4259023368358612
train F1 is 0.6156615614891052
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.41it/s]
New threshold is 0.4011513888835907
val F1 is 0.6285714507102966
Epoch 7/40, learning rate: 1.4043436253115652e-05
Train Loss: 0.6247, Train Acc: 0.6338, Train f1: 0.6157, Train Precision: 0.5446, Train Recall: 0.7081, Train AUC: 0.6823
Valitadion Loss: 0.6364, Validation Acc: 0.6364, Vall f1: 0.6286, Val Precision: 0.5466, Val Recall: 0.7395, Val AUC: 0.6898
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.48it/s]





































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:14<00:02,  1.09it/s]
New threshold is 0.45756736397743225
train F1 is 0.6405959129333496
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.38it/s]
New threshold is 0.23628108203411102
val F1 is 0.646616518497467
Epoch 8/40, learning rate: 1.2486899247303603e-05
Train Loss: 0.6038, Train Acc: 0.6690, Train f1: 0.6406, Train Precision: 0.5821, Train Recall: 0.7122, Train AUC: 0.7113
Valitadion Loss: 0.6603, Validation Acc: 0.6713, Vall f1: 0.6466, Val Precision: 0.5850, Val Recall: 0.7227, Val AUC: 0.7031
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 83/84 [01:16<00:00,  1.09it/s]
New threshold is 0.4812498688697815
train F1 is 0.6591337323188782
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.38it/s]
New threshold is 0.4857870638370514
val F1 is 0.6274510025978088
Epoch 9/40, learning rate: 1.0862864114836052e-05
Train Loss: 0.5846, Train Acc: 0.6895, Train f1: 0.6591, Train Precision: 0.6045, Train Recall: 0.7246, Train AUC: 0.7445
Valitadion Loss: 0.6222, Validation Acc: 0.6678, Vall f1: 0.6275, Val Precision: 0.5882, Val Recall: 0.6723, Val AUC: 0.6967
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.45it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.09it/s]
New threshold is 0.518664538860321
train F1 is 0.6603053212165833
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.41it/s]
New threshold is 0.4104943573474884
val F1 is 0.6591760516166687
Epoch 10/40, learning rate: 9.215409581951101e-06
Train Loss: 0.5766, Train Acc: 0.6947, Train f1: 0.6603, Train Precision: 0.6124, Train Recall: 0.7164, Train AUC: 0.7572
Valitadion Loss: 0.6167, Validation Acc: 0.6818, Vall f1: 0.6592, Val Precision: 0.5946, Val Recall: 0.7395, Val AUC: 0.6972
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.47it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.07it/s]
New threshold is 0.4931086301803589
train F1 is 0.6635249853134155
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.09it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.41it/s]
New threshold is 0.44316938519477844
val F1 is 0.6666666865348816
Epoch 11/40, learning rate: 7.589250012207144e-06
Train Loss: 0.5723, Train Acc: 0.6938, Train f1: 0.6635, Train Precision: 0.6090, Train Recall: 0.7288, Train AUC: 0.7615
Valitadion Loss: 0.6175, Validation Acc: 0.6783, Vall f1: 0.6667, Val Precision: 0.5860, Val Recall: 0.7731, Val AUC: 0.7118
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.47it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.09it/s]
New threshold is 0.4926791787147522
train F1 is 0.672897219657898
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.08it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.40it/s]
New threshold is 0.5326123833656311
val F1 is 0.6642857193946838
Epoch 12/40, learning rate: 6.0285217922261386e-06
Train Loss: 0.5518, Train Acc: 0.6998, Train f1: 0.6729, Train Precision: 0.6133, Train Recall: 0.7453, Train AUC: 0.7817
Valitadion Loss: 0.6187, Validation Acc: 0.6713, Vall f1: 0.6643, Val Precision: 0.5776, Val Recall: 0.7815, Val AUC: 0.7110
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 83/84 [01:16<00:00,  1.09it/s]
New threshold is 0.543404757976532
train F1 is 0.6925315260887146
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.09it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.37it/s]
New threshold is 0.4885493814945221
val F1 is 0.6690391302108765
Epoch 13/40, learning rate: 4.5755854045895805e-06
Train Loss: 0.5293, Train Acc: 0.7281, Train f1: 0.6925, Train Precision: 0.6515, Train Recall: 0.7391, Train AUC: 0.8069
Valitadion Loss: 0.6031, Validation Acc: 0.6748, Vall f1: 0.6690, Val Precision: 0.5802, Val Recall: 0.7899, Val AUC: 0.7262
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.45it/s]





































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:14<00:02,  1.09it/s]
New threshold is 0.5095941424369812
train F1 is 0.7112740874290466
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.09it/s]




 95%|██████████████████████████████████████████████████████████████████████████████    | 20/21 [00:08<00:00,  2.40it/s]
New threshold is 0.4779610335826874
val F1 is 0.6567164063453674
Epoch 14/40, learning rate: 3.269875701408523e-06
Train Loss: 0.5145, Train Acc: 0.7298, Train f1: 0.7113, Train Precision: 0.6382, Train Recall: 0.8033, Train AUC: 0.8227
Valitadion Loss: 0.5953, Validation Acc: 0.6783, Vall f1: 0.6567, Val Precision: 0.5906, Val Recall: 0.7395, Val AUC: 0.7419
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.09it/s]
New threshold is 0.5245396494865417
train F1 is 0.7137476205825806
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.39it/s]
New threshold is 0.530493438243866
val F1 is 0.6590909361839294
Epoch 15/40, learning rate: 2.146831583851016e-06
Train Loss: 0.5009, Train Acc: 0.7393, Train f1: 0.7137, Train Precision: 0.6546, Train Recall: 0.7847, Train AUC: 0.8359
Valitadion Loss: 0.5877, Validation Acc: 0.6853, Vall f1: 0.6591, Val Precision: 0.6000, Val Recall: 0.7311, Val AUC: 0.7489
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]





































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:14<00:02,  1.09it/s]
New threshold is 0.5379109978675842
train F1 is 0.727450966835022
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]
  0%|                                                                                           | 0/84 [00:00<?, ?it/s]
New threshold is 0.5163406729698181
val F1 is 0.6541353464126587
Epoch 16/40, learning rate: 1.2369341377147044e-06
Train Loss: 0.4888, Train Acc: 0.7616, Train f1: 0.7275, Train Precision: 0.6909, Train Recall: 0.7681, Train AUC: 0.8509
Valitadion Loss: 0.5913, Validation Acc: 0.6783, Vall f1: 0.6541, Val Precision: 0.5918, Val Recall: 0.7311, Val AUC: 0.7459






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.08it/s]
New threshold is 0.538775622844696
train F1 is 0.7303149700164795
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.09it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.40it/s]
New threshold is 0.4337809085845947
val F1 is 0.6762589812278748
Epoch 17/40, learning rate: 5.648793314741472e-07
Train Loss: 0.4813, Train Acc: 0.7650, Train f1: 0.7303, Train Precision: 0.6961, Train Recall: 0.7681, Train AUC: 0.8537
Valitadion Loss: 0.5904, Validation Acc: 0.6853, Vall f1: 0.6763, Val Precision: 0.5912, Val Recall: 0.7899, Val AUC: 0.7416
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]
  0%|                                                                                           | 0/21 [00:00<?, ?it/s]
New threshold is 0.5288182497024536
train F1 is 0.7398058176040649




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:07<00:00,  2.31it/s]
New threshold is 0.4653622508049011
val F1 is 0.6762589812278748
Epoch 18/40, learning rate: 1.4890773100692442e-07
Train Loss: 0.4762, Train Acc: 0.7702, Train f1: 0.7398, Train Precision: 0.6965, Train Recall: 0.7888, Train AUC: 0.8585
Valitadion Loss: 0.5885, Validation Acc: 0.6853, Vall f1: 0.6763, Val Precision: 0.5912, Val Recall: 0.7899, Val AUC: 0.7440
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.42it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.09it/s]
New threshold is 0.5388365387916565
train F1 is 0.7303482294082642
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.37it/s]
New threshold is 0.4816395938396454
val F1 is 0.6739130616188049
Epoch 19/40, learning rate: 3.0942353668218756e-10
Train Loss: 0.4842, Train Acc: 0.7676, Train f1: 0.7303, Train Precision: 0.7031, Train Recall: 0.7598, Train AUC: 0.8565
Valitadion Loss: 0.5887, Validation Acc: 0.6853, Vall f1: 0.6739, Val Precision: 0.5924, Val Recall: 0.7815, Val AUC: 0.7439
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]
  0%|                                                                                           | 0/21 [00:00<?, ?it/s]
New threshold is 0.49055108428001404
train F1 is 0.672897219657898




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:07<00:00,  2.38it/s]
New threshold is 0.47127869725227356
val F1 is 0.6541353464126587
Epoch 20/40, learning rate: 1.9969173338872615e-05
Train Loss: 0.5479, Train Acc: 0.6998, Train f1: 0.6729, Train Precision: 0.6133, Train Recall: 0.7453, Train AUC: 0.7822
Valitadion Loss: 0.6036, Validation Acc: 0.6783, Vall f1: 0.6541, Val Precision: 0.5918, Val Recall: 0.7311, Val AUC: 0.7181
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.44it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.08it/s]
New threshold is 0.4743773937225342
train F1 is 0.6890756487846375
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.38it/s]
New threshold is 0.5294568538665771
val F1 is 0.6102941036224365
Epoch 21/40, learning rate: 1.987066410425045e-05
Train Loss: 0.5446, Train Acc: 0.7144, Train f1: 0.6891, Train Precision: 0.6276, Train Recall: 0.7640, Train AUC: 0.7892
Valitadion Loss: 0.6623, Validation Acc: 0.6294, Vall f1: 0.6103, Val Precision: 0.5425, Val Recall: 0.6975, Val AUC: 0.6776
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.45it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.09it/s]
New threshold is 0.4797441065311432
train F1 is 0.6568915247917175
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.41it/s]
New threshold is 0.4371497333049774
val F1 is 0.6520146727561951
Epoch 22/40, learning rate: 1.970506474943219e-05
Train Loss: 0.5389, Train Acc: 0.6990, Train f1: 0.6569, Train Precision: 0.6222, Train Recall: 0.6957, Train AUC: 0.7862
Valitadion Loss: 0.5856, Validation Acc: 0.6678, Vall f1: 0.6520, Val Precision: 0.5779, Val Recall: 0.7479, Val AUC: 0.7434
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.47it/s]





































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:14<00:02,  1.09it/s]
New threshold is 0.46532654762268066
train F1 is 0.7091254591941833
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.09it/s]




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:07<00:00,  2.40it/s]
New threshold is 0.4440537989139557
val F1 is 0.6642857193946838
Epoch 23/40, learning rate: 1.9473500840141124e-05
Train Loss: 0.5164, Train Acc: 0.7376, Train f1: 0.7091, Train Precision: 0.6555, Train Recall: 0.7723, Train AUC: 0.8148
Valitadion Loss: 0.5948, Validation Acc: 0.6713, Vall f1: 0.6643, Val Precision: 0.5776, Val Recall: 0.7815, Val AUC: 0.7549
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.45it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.09it/s]
New threshold is 0.4349643588066101
train F1 is 0.7126436829566956
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]
  0%|                                                                                           | 0/84 [00:00<?, ?it/s]
New threshold is 0.4152677655220032
val F1 is 0.6381322741508484
Epoch 24/40, learning rate: 1.9177546297962497e-05
Train Loss: 0.5075, Train Acc: 0.7427, Train f1: 0.7126, Train Precision: 0.6631, Train Recall: 0.7702, Train AUC: 0.8282
Valitadion Loss: 0.5630, Validation Acc: 0.6748, Vall f1: 0.6381, Val Precision: 0.5942, Val Recall: 0.6891, Val AUC: 0.7677





































100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]
  0%|                                                                                           | 0/21 [00:00<?, ?it/s]
New threshold is 0.49321043491363525
train F1 is 0.7117586135864258




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:07<00:00,  2.38it/s]
New threshold is 0.4060649275779724
val F1 is 0.6666666865348816
Epoch 25/40, learning rate: 1.881921270252292e-05
Train Loss: 0.4921, Train Acc: 0.7624, Train f1: 0.7118, Train Precision: 0.7155, Train Recall: 0.7081, Train AUC: 0.8341
Valitadion Loss: 0.5609, Validation Acc: 0.6923, Vall f1: 0.6667, Val Precision: 0.6069, Val Recall: 0.7395, Val AUC: 0.7691
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.45it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.09it/s]
New threshold is 0.422086238861084
train F1 is 0.7075098752975464
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]
  0%|                                                                                           | 0/84 [00:00<?, ?it/s]
New threshold is 0.45941483974456787
val F1 is 0.5948275923728943
Epoch 26/40, learning rate: 1.8400935618942642e-05
Train Loss: 0.4970, Train Acc: 0.7461, Train f1: 0.7075, Train Precision: 0.6767, Train Recall: 0.7412, Train AUC: 0.8254
Valitadion Loss: 0.5889, Validation Acc: 0.6713, Vall f1: 0.5948, Val Precision: 0.6106, Val Recall: 0.5798, Val AUC: 0.7419





































100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]
  0%|                                                                                           | 0/21 [00:00<?, ?it/s]
New threshold is 0.4066418707370758
train F1 is 0.7063491940498352




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:07<00:00,  2.41it/s]
New threshold is 0.19403384625911713
val F1 is 0.6898954510688782
Epoch 27/40, learning rate: 1.7925558043492013e-05
Train Loss: 0.4851, Train Acc: 0.7461, Train f1: 0.7063, Train Precision: 0.6781, Train Recall: 0.7371, Train AUC: 0.8350
Valitadion Loss: 0.6091, Validation Acc: 0.6888, Vall f1: 0.6899, Val Precision: 0.5893, Val Recall: 0.8319, Val AUC: 0.7617
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.45it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.09it/s]
New threshold is 0.44830405712127686
train F1 is 0.7316062450408936
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]
  0%|                                                                                           | 0/84 [00:00<?, ?it/s]
New threshold is 0.3963918387889862
val F1 is 0.6813187003135681
Epoch 28/40, learning rate: 1.739631107997055e-05
Train Loss: 0.4652, Train Acc: 0.7779, Train f1: 0.7316, Train Precision: 0.7324, Train Recall: 0.7308, Train AUC: 0.8536
Valitadion Loss: 0.5839, Validation Acc: 0.6958, Vall f1: 0.6813, Val Precision: 0.6039, Val Recall: 0.7815, Val AUC: 0.7709






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.06it/s]
New threshold is 0.42336660623550415
train F1 is 0.7536800503730774
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.09it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.40it/s]
New threshold is 0.49709591269493103
val F1 is 0.6492537260055542
Epoch 29/40, learning rate: 1.6816791978149873e-05
Train Loss: 0.4525, Train Acc: 0.7847, Train f1: 0.7537, Train Precision: 0.7164, Train Recall: 0.7950, Train AUC: 0.8618
Valitadion Loss: 0.6259, Validation Acc: 0.6713, Vall f1: 0.6493, Val Precision: 0.5839, Val Recall: 0.7311, Val AUC: 0.7521
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]





































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:14<00:02,  1.09it/s]
New threshold is 0.4249153435230255
train F1 is 0.7354443073272705
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]
  0%|                                                                                           | 0/84 [00:00<?, ?it/s]
New threshold is 0.45432984828948975
val F1 is 0.6536964774131775
Epoch 30/40, learning rate: 1.6190939683551365e-05
Train Loss: 0.4569, Train Acc: 0.7779, Train f1: 0.7354, Train Precision: 0.7258, Train Recall: 0.7453, Train AUC: 0.8575
Valitadion Loss: 0.6072, Validation Acc: 0.6888, Vall f1: 0.6537, Val Precision: 0.6087, Val Recall: 0.7059, Val AUC: 0.7672






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.09it/s]
New threshold is 0.46053507924079895
train F1 is 0.7611168622970581
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.40it/s]
New threshold is 0.2831083834171295
val F1 is 0.6618182063102722
Epoch 31/40, learning rate: 1.5523008064744873e-05
Train Loss: 0.4268, Train Acc: 0.8019, Train f1: 0.7611, Train Precision: 0.7603, Train Recall: 0.7619, Train AUC: 0.8788
Valitadion Loss: 0.6077, Validation Acc: 0.6748, Vall f1: 0.6618, Val Precision: 0.5833, Val Recall: 0.7647, Val AUC: 0.7699
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.47it/s]





































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:14<00:02,  1.09it/s]
New threshold is 0.4198269248008728
train F1 is 0.7873392701148987
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]




 95%|██████████████████████████████████████████████████████████████████████████████    | 20/21 [00:08<00:00,  2.39it/s]
New threshold is 0.37598690390586853
val F1 is 0.625
Epoch 32/40, learning rate: 1.4817537000140316e-05
Train Loss: 0.4086, Train Acc: 0.8156, Train f1: 0.7873, Train Precision: 0.7538, Train Recall: 0.8240, Train AUC: 0.8926
Valitadion Loss: 0.6357, Validation Acc: 0.6643, Vall f1: 0.6250, Val Precision: 0.5839, Val Recall: 0.6723, Val AUC: 0.7497
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]





































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:15<00:02,  1.07it/s]
New threshold is 0.38260358572006226
train F1 is 0.7665024399757385
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.09it/s]




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:08<00:00,  2.32it/s]
New threshold is 0.32536834478378296
val F1 is 0.6134454011917114
Epoch 33/40, learning rate: 1.407932152079303e-05
Train Loss: 0.4126, Train Acc: 0.7967, Train f1: 0.7665, Train Precision: 0.7312, Train Recall: 0.8054, Train AUC: 0.8872
Valitadion Loss: 0.6113, Validation Acc: 0.6783, Vall f1: 0.6134, Val Precision: 0.6134, Val Recall: 0.6134, Val AUC: 0.7520
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.38it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:14<00:01,  1.10it/s]
New threshold is 0.37771934270858765
train F1 is 0.7899807095527649
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.43it/s]
New threshold is 0.20547594130039215
val F1 is 0.6666666865348816
Epoch 34/40, learning rate: 1.3313379218956768e-05
Train Loss: 0.3957, Train Acc: 0.8130, Train f1: 0.7900, Train Precision: 0.7387, Train Recall: 0.8489, Train AUC: 0.8993
Valitadion Loss: 0.6685, Validation Acc: 0.6748, Vall f1: 0.6667, Val Precision: 0.5813, Val Recall: 0.7815, Val AUC: 0.7553
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.48it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:14<00:01,  1.09it/s]
New threshold is 0.43903130292892456
train F1 is 0.7767195701599121
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.42it/s]
New threshold is 0.21527719497680664
val F1 is 0.6859205961227417
Epoch 35/40, learning rate: 1.2524916143905793e-05
Train Loss: 0.4093, Train Acc: 0.8190, Train f1: 0.7767, Train Precision: 0.7944, Train Recall: 0.7598, Train AUC: 0.8892
Valitadion Loss: 0.6467, Validation Acc: 0.6958, Vall f1: 0.6859, Val Precision: 0.6013, Val Recall: 0.7983, Val AUC: 0.7651
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.49it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]
  5%|███▉                                                                               | 1/21 [00:00<00:07,  2.50it/s]
New threshold is 0.4226532280445099
train F1 is 0.8095733523368835



100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.45it/s]
  0%|                                                                                           | 0/84 [00:00<?, ?it/s]
New threshold is 0.3430444002151489
val F1 is 0.6536964774131775
Epoch 36/40, learning rate: 1.1719291416829545e-05
Train Loss: 0.3692, Train Acc: 0.8431, Train f1: 0.8096, Train Precision: 0.8138, Train Recall: 0.8054, Train AUC: 0.9136
Valitadion Loss: 0.6478, Validation Acc: 0.6888, Vall f1: 0.6537, Val Precision: 0.6087, Val Recall: 0.7059, Val AUC: 0.7674






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 83/84 [01:15<00:00,  1.09it/s]
New threshold is 0.3983030617237091
train F1 is 0.8169868588447571
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.41it/s]
New threshold is 0.3192458152770996
val F1 is 0.6352941393852234
Epoch 37/40, learning rate: 1.0901980805309577e-05
Train Loss: 0.3509, Train Acc: 0.8448, Train f1: 0.8170, Train Precision: 0.7984, Train Recall: 0.8364, Train AUC: 0.9236
Valitadion Loss: 0.6682, Validation Acc: 0.6748, Vall f1: 0.6353, Val Precision: 0.5956, Val Recall: 0.6807, Val AUC: 0.7641
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.48it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:14<00:01,  1.10it/s]
New threshold is 0.4011600613594055
train F1 is 0.8060606122016907
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.11it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.39it/s]
New threshold is 0.4865570664405823
val F1 is 0.6278026700019836
Epoch 38/40, learning rate: 1.0078539504960164e-05
Train Loss: 0.3541, Train Acc: 0.8353, Train f1: 0.8061, Train Precision: 0.7870, Train Recall: 0.8261, Train AUC: 0.9211
Valitadion Loss: 0.6433, Validation Acc: 0.7098, Vall f1: 0.6278, Val Precision: 0.6731, Val Recall: 0.5882, Val AUC: 0.7524
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:14<00:01,  1.10it/s]
New threshold is 0.4093881845474243
train F1 is 0.8385787010192871
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.11it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:06<00:01,  2.42it/s]
New threshold is 0.2994686961174011
val F1 is 0.6513410210609436
Epoch 39/40, learning rate: 9.254564381202913e-06
Train Loss: 0.3268, Train Acc: 0.8636, Train f1: 0.8386, Train Precision: 0.8227, Train Recall: 0.8551, Train AUC: 0.9335
Valitadion Loss: 0.6645, Validation Acc: 0.6818, Vall f1: 0.6513, Val Precision: 0.5986, Val Recall: 0.7143, Val AUC: 0.7621
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.49it/s]





































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:13<00:02,  1.10it/s]
New threshold is 0.44640177488327026
train F1 is 0.8371607661247253
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.11it/s]



100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.49it/s]
  0%|                                                                                           | 0/21 [00:00<?, ?it/s]
New threshold is 0.3746497631072998
val F1 is 0.6507936716079712
Epoch 40/40, learning rate: 8.435655927814925e-06
Train Loss: 0.3222, Train Acc: 0.8662, Train f1: 0.8372, Train Precision: 0.8442, Train Recall: 0.8302, Train AUC: 0.9331
Valitadion Loss: 0.6831, Validation Acc: 0.6923, Vall f1: 0.6508, Val Precision: 0.6165, Val Recall: 0.6891, Val AUC: 0.7566
Training complete in 56m 43s
Best val auc: 0.689895




 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.44it/s]
New threshold is 0.3746497631072998
Inference complete in 0m 9s
F1 Score = : 0.650794
AUC Score = : 0.756604

100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:09<00:00,  2.23it/s]