Starting training...
--------------------
train for epoch 1







































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:20<00:00,  1.17it/s]
New threshold is 0.5063496232032776
train F1 is 0.5440806150436401
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:21<00:00,  1.10it/s]




 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.55it/s]
New threshold is 0.5046666264533997
val F1 is 0.52173912525177
Epoch 1/100, learning rate: 3.988185647620239e-06
Train Loss: 0.6960, Train Acc: 0.5359, Train f1: 0.5441, Train Precision: 0.5243, Train Recall: 0.5654, Train AUC: 0.5214
Valitadion Loss: 0.6900, Validation Acc: 0.5734, Vall f1: 0.5217, Val Precision: 0.4693, Val Recall: 0.5874, Val AUC: 0.5682
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:11<00:00,  2.50it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.4896985590457916
train F1 is 0.5608465671539307
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.17it/s]




 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.58it/s]
New threshold is 0.5086287260055542
val F1 is 0.5562499761581421
Epoch 2/100, learning rate: 3.952882169438005e-06
Train Loss: 0.6838, Train Acc: 0.5744, Train f1: 0.5608, Train Precision: 0.5668, Train Recall: 0.5550, Train AUC: 0.5835
Valitadion Loss: 0.6836, Validation Acc: 0.6066, Vall f1: 0.5562, Val Precision: 0.5028, Val Recall: 0.6224, Val AUC: 0.6067
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.59it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.17it/s]
New threshold is 0.4792462885379791
train F1 is 0.5834031701087952
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.17it/s]




 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.58it/s]
New threshold is 0.5278582572937012
val F1 is 0.5253164768218994
Epoch 3/100, learning rate: 3.894506653289044e-06
Train Loss: 0.6802, Train Acc: 0.5752, Train f1: 0.5834, Train Precision: 0.5613, Train Recall: 0.6073, Train AUC: 0.6004
Valitadion Loss: 0.6946, Validation Acc: 0.5845, Vall f1: 0.5253, Val Precision: 0.4798, Val Recall: 0.5804, Val AUC: 0.5940
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.61it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.47435781359672546
train F1 is 0.5781910419464111
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.17it/s]




 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.52it/s]
New threshold is 0.4805266857147217
val F1 is 0.5696969628334045
Epoch 4/100, learning rate: 3.81374876826391e-06
Train Loss: 0.6807, Train Acc: 0.5735, Train f1: 0.5782, Train Precision: 0.5607, Train Recall: 0.5969, Train AUC: 0.5924
Valitadion Loss: 0.6699, Validation Acc: 0.6066, Vall f1: 0.5697, Val Precision: 0.5027, Val Recall: 0.6573, Val AUC: 0.6439
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.57it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.17it/s]
New threshold is 0.48905614018440247
train F1 is 0.5872873663902283
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.17it/s]




 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.55it/s]
New threshold is 0.5526605844497681
val F1 is 0.5384615659713745
Epoch 5/100, learning rate: 3.7115626167122582e-06
Train Loss: 0.6705, Train Acc: 0.6060, Train f1: 0.5873, Train Precision: 0.6029, Train Recall: 0.5724, Train AUC: 0.6304
Valitadion Loss: 0.6916, Validation Acc: 0.6011, Vall f1: 0.5385, Val Precision: 0.4970, Val Recall: 0.5874, Val AUC: 0.6276
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.59it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.500652551651001
train F1 is 0.6086191534996033
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]




 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.53it/s]
New threshold is 0.5306647419929504
val F1 is 0.5384615659713745
Epoch 6/100, learning rate: 3.589155462138668e-06
Train Loss: 0.6640, Train Acc: 0.6197, Train f1: 0.6086, Train Precision: 0.6135, Train Recall: 0.6038, Train AUC: 0.6462
Valitadion Loss: 0.6642, Validation Acc: 0.6343, Vall f1: 0.5385, Val Precision: 0.5385, Val Recall: 0.5385, Val AUC: 0.6491
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.58it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.17it/s]
New threshold is 0.49119094014167786
train F1 is 0.6026666760444641
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.17it/s]




 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.58it/s]
New threshold is 0.5756354331970215
val F1 is 0.5569620132446289
Epoch 7/100, learning rate: 3.4479734661626163e-06
Train Loss: 0.6624, Train Acc: 0.6179, Train f1: 0.6027, Train Precision: 0.6141, Train Recall: 0.5916, Train AUC: 0.6453
Valitadion Loss: 0.6975, Validation Acc: 0.6122, Vall f1: 0.5570, Val Precision: 0.5087, Val Recall: 0.6154, Val AUC: 0.6390
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.58it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.5062820315361023
train F1 is 0.597517728805542
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.17it/s]




 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.52it/s]
New threshold is 0.5262549519538879
val F1 is 0.5491525530815125
Epoch 8/100, learning rate: 3.2896846030512342e-06
Train Loss: 0.6617, Train Acc: 0.6120, Train f1: 0.5975, Train Precision: 0.6072, Train Recall: 0.5881, Train AUC: 0.6495
Valitadion Loss: 0.6617, Validation Acc: 0.6316, Vall f1: 0.5492, Val Precision: 0.5329, Val Recall: 0.5664, Val AUC: 0.6528
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.57it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.49840247631073
train F1 is 0.6288751363754272
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]




 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.57it/s]
New threshold is 0.4913686215877533
val F1 is 0.5676567554473877
Epoch 9/100, learning rate: 3.1161589536786335e-06
Train Loss: 0.6484, Train Acc: 0.6419, Train f1: 0.6289, Train Precision: 0.6385, Train Recall: 0.6195, Train AUC: 0.6796
Valitadion Loss: 0.6469, Validation Acc: 0.6371, Vall f1: 0.5677, Val Precision: 0.5375, Val Recall: 0.6014, Val AUC: 0.6714
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.59it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
New threshold is 0.5055305361747742
train F1 is 0.6212389469146729
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.17it/s]




 82%|███████████████████████████████████████████████████████████████████▎              | 23/28 [00:08<00:01,  2.57it/s]
New threshold is 0.4945969581604004
val F1 is 0.5787781476974487
Epoch 10/100, learning rate: 2.9294466117259505e-06
Train Loss: 0.6513, Train Acc: 0.6342, Train f1: 0.6212, Train Precision: 0.6302, Train Recall: 0.6126, Train AUC: 0.6689
Valitadion Loss: 0.6389, Validation Acc: 0.6371, Vall f1: 0.5788, Val Precision: 0.5357, Val Recall: 0.6294, Val AUC: 0.6835
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.59it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.17it/s]
New threshold is 0.5102827548980713
train F1 is 0.6267856955528259
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.17it/s]




100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.59it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.48546549677848816
val F1 is 0.579104483127594
Epoch 11/100, learning rate: 2.7317534631461374e-06
Train Loss: 0.6407, Train Acc: 0.6427, Train f1: 0.6268, Train Precision: 0.6417, Train Recall: 0.6126, Train AUC: 0.6932
Valitadion Loss: 0.6436, Validation Acc: 0.6094, Vall f1: 0.5791, Val Precision: 0.5052, Val Recall: 0.6783, Val AUC: 0.6743






































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.17it/s]
New threshold is 0.48484426736831665
train F1 is 0.6300174593925476
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.17it/s]




100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.58it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.49413490295410156
val F1 is 0.5792682766914368
Epoch 12/100, learning rate: 2.5254151250434843e-06
Train Loss: 0.6430, Train Acc: 0.6376, Train f1: 0.6300, Train Precision: 0.6300, Train Recall: 0.6300, Train AUC: 0.6842
Valitadion Loss: 0.6456, Validation Acc: 0.6177, Vall f1: 0.5793, Val Precision: 0.5135, Val Recall: 0.6643, Val AUC: 0.6767






































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
New threshold is 0.4590735137462616
train F1 is 0.6655817627906799
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]





 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.58it/s]
New threshold is 0.5069237351417542
val F1 is 0.5993691086769104
Epoch 13/100, learning rate: 2.312869351863229e-06
Train Loss: 0.6330, Train Acc: 0.6487, Train f1: 0.6656, Train Precision: 0.6235, Train Recall: 0.7138, Train AUC: 0.7047
Valitadion Loss: 0.6415, Validation Acc: 0.6482, Vall f1: 0.5994, Val Precision: 0.5460, Val Recall: 0.6643, Val AUC: 0.7006
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.58it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.17it/s]
New threshold is 0.4406717121601105
train F1 is 0.6688206791877747
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]





 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.56it/s]
New threshold is 0.5613910555839539
val F1 is 0.6020761132240295
Epoch 14/100, learning rate: 2.096627234894324e-06
Train Loss: 0.6368, Train Acc: 0.6496, Train f1: 0.6688, Train Precision: 0.6226, Train Recall: 0.7225, Train AUC: 0.6955
Valitadion Loss: 0.6515, Validation Acc: 0.6814, Vall f1: 0.6021, Val Precision: 0.5959, Val Recall: 0.6084, Val AUC: 0.7077
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.60it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.17it/s]
New threshold is 0.5005062222480774
train F1 is 0.6347517967224121
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]





 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.59it/s]
New threshold is 0.5824034214019775
val F1 is 0.6036363840103149
Epoch 15/100, learning rate: 1.8792435353446761e-06
Train Loss: 0.6274, Train Acc: 0.6479, Train f1: 0.6348, Train Precision: 0.6450, Train Recall: 0.6248, Train AUC: 0.7138
Valitadion Loss: 0.6518, Validation Acc: 0.6981, Vall f1: 0.6036, Val Precision: 0.6288, Val Recall: 0.5804, Val AUC: 0.7004
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.60it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.17it/s]
New threshold is 0.4934861958026886
train F1 is 0.6571683287620544
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.17it/s]





 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.57it/s]
New threshold is 0.5337194800376892
val F1 is 0.6169491410255432
Epoch 16/100, learning rate: 1.6632865014844434e-06
Train Loss: 0.6159, Train Acc: 0.6709, Train f1: 0.6572, Train Precision: 0.6709, Train Recall: 0.6440, Train AUC: 0.7334
Valitadion Loss: 0.6303, Validation Acc: 0.6870, Vall f1: 0.6169, Val Precision: 0.5987, Val Recall: 0.6364, Val AUC: 0.7197
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.60it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
New threshold is 0.48944371938705444
train F1 is 0.6684118509292603
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]





 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.55it/s]
New threshold is 0.4472545385360718
val F1 is 0.6490066051483154
Epoch 17/100, learning rate: 1.4513075264483864e-06
Train Loss: 0.6142, Train Acc: 0.6752, Train f1: 0.6684, Train Precision: 0.6684, Train Recall: 0.6684, Train AUC: 0.7355
Valitadion Loss: 0.6025, Validation Acc: 0.7064, Vall f1: 0.6490, Val Precision: 0.6164, Val Recall: 0.6853, Val AUC: 0.7396
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.59it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.17it/s]
New threshold is 0.4850585162639618
train F1 is 0.6736292243003845
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.17it/s]





 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.55it/s]
New threshold is 0.5102861523628235
val F1 is 0.6219081282615662
Epoch 18/100, learning rate: 1.2458110051707803e-06
Train Loss: 0.6164, Train Acc: 0.6795, Train f1: 0.6736, Train Precision: 0.6719, Train Recall: 0.6754, Train AUC: 0.7275
Valitadion Loss: 0.6116, Validation Acc: 0.7036, Vall f1: 0.6219, Val Precision: 0.6286, Val Recall: 0.6154, Val AUC: 0.7323
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.59it/s]





































 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:14<00:02,  1.16it/s]
New threshold is 0.5206668376922607
train F1 is 0.6654064059257507

100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]




 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.54it/s]
New threshold is 0.5164889693260193
val F1 is 0.6329966187477112
Epoch 19/100, learning rate: 1.0492247465737655e-06
Train Loss: 0.6049, Train Acc: 0.6974, Train f1: 0.6654, Train Precision: 0.7258, Train Recall: 0.6143, Train AUC: 0.7465
Valitadion Loss: 0.6177, Validation Acc: 0.6981, Vall f1: 0.6330, Val Precision: 0.6104, Val Recall: 0.6573, Val AUC: 0.7279
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.58it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.17it/s]
New threshold is 0.4745800197124481
train F1 is 0.6987951993942261
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]




 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.56it/s]
New threshold is 0.5297343730926514
val F1 is 0.6258503198623657
Epoch 20/100, learning rate: 8.638712905700619e-07
Train Loss: 0.5976, Train Acc: 0.7009, Train f1: 0.6988, Train Precision: 0.6893, Train Recall: 0.7086, Train AUC: 0.7560
Valitadion Loss: 0.6157, Validation Acc: 0.6953, Vall f1: 0.6259, Val Precision: 0.6093, Val Recall: 0.6434, Val AUC: 0.7290
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.58it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.5049017667770386
train F1 is 0.6850044131278992
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]




 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.55it/s]
New threshold is 0.5008822083473206
val F1 is 0.6209150552749634
Epoch 21/100, learning rate: 6.919404687511615e-07
Train Loss: 0.5969, Train Acc: 0.6966, Train f1: 0.6850, Train Precision: 0.6968, Train Recall: 0.6736, Train AUC: 0.7547
Valitadion Loss: 0.6102, Validation Acc: 0.6787, Vall f1: 0.6209, Val Precision: 0.5828, Val Recall: 0.6643, Val AUC: 0.7307
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.57it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.15it/s]
New threshold is 0.5223258137702942
train F1 is 0.6779661178588867
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]




100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.58it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.4897972047328949
val F1 is 0.6222222447395325
Epoch 22/100, learning rate: 5.354635329387864e-07
Train Loss: 0.5911, Train Acc: 0.7077, Train f1: 0.6780, Train Precision: 0.7362, Train Recall: 0.6283, Train AUC: 0.7637
Valitadion Loss: 0.6115, Validation Acc: 0.6704, Vall f1: 0.6222, Val Precision: 0.5698, Val Recall: 0.6853, Val AUC: 0.7263






































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
New threshold is 0.4827122986316681
train F1 is 0.6745027303695679
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]




100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.57it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.5271363258361816
val F1 is 0.6123778223991394
Epoch 23/100, learning rate: 3.96289157254099e-07
Train Loss: 0.5936, Train Acc: 0.6923, Train f1: 0.6745, Train Precision: 0.6998, Train Recall: 0.6510, Train AUC: 0.7567
Valitadion Loss: 0.6266, Validation Acc: 0.6704, Vall f1: 0.6124, Val Precision: 0.5732, Val Recall: 0.6573, Val AUC: 0.7185






































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
New threshold is 0.507560670375824
train F1 is 0.682539701461792
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]





 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.56it/s]
New threshold is 0.514178991317749
val F1 is 0.6158940196037292
Epoch 24/100, learning rate: 2.760615972247353e-07
Train Loss: 0.5926, Train Acc: 0.6923, Train f1: 0.6825, Train Precision: 0.6898, Train Recall: 0.6754, Train AUC: 0.7566
Valitadion Loss: 0.6192, Validation Acc: 0.6787, Vall f1: 0.6159, Val Precision: 0.5849, Val Recall: 0.6503, Val AUC: 0.7222
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.59it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
New threshold is 0.5065969228744507
train F1 is 0.7057793140411377
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]





 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.55it/s]
New threshold is 0.5071011185646057
val F1 is 0.6107382774353027
Epoch 25/100, learning rate: 1.7620126396574285e-07
Train Loss: 0.5828, Train Acc: 0.7128, Train f1: 0.7058, Train Precision: 0.7083, Train Recall: 0.7033, Train AUC: 0.7748
Valitadion Loss: 0.6140, Validation Acc: 0.6787, Vall f1: 0.6107, Val Precision: 0.5871, Val Recall: 0.6364, Val AUC: 0.7235
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.56it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
New threshold is 0.49900421500205994
train F1 is 0.7088830471038818





 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.56it/s]
New threshold is 0.4940608739852905
val F1 is 0.6173633337020874
Epoch 26/100, learning rate: 9.788794293795108e-08
Train Loss: 0.5779, Train Acc: 0.7171, Train f1: 0.7089, Train Precision: 0.7145, Train Recall: 0.7033, Train AUC: 0.7830
Valitadion Loss: 0.6157, Validation Acc: 0.6704, Vall f1: 0.6174, Val Precision: 0.5714, Val Recall: 0.6713, Val AUC: 0.7230
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.59it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
New threshold is 0.45907533168792725
train F1 is 0.7211220860481262





 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.55it/s]
New threshold is 0.4995729923248291
val F1 is 0.6168830990791321
Epoch 27/100, learning rate: 4.2046855543316594e-08
Train Loss: 0.5842, Train Acc: 0.7111, Train f1: 0.7211, Train Precision: 0.6839, Train Recall: 0.7627, Train AUC: 0.7725
Valitadion Loss: 0.6165, Validation Acc: 0.6731, Vall f1: 0.6169, Val Precision: 0.5758, Val Recall: 0.6643, Val AUC: 0.7230
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.58it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.5008040070533752
train F1 is 0.6973803043365479
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]




 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.53it/s]
New threshold is 0.49762818217277527
val F1 is 0.6188924908638
Epoch 28/100, learning rate: 9.337728230520101e-09
Train Loss: 0.5837, Train Acc: 0.7137, Train f1: 0.6974, Train Precision: 0.7228, Train Recall: 0.6736, Train AUC: 0.7715
Valitadion Loss: 0.6145, Validation Acc: 0.6759, Vall f1: 0.6189, Val Precision: 0.5793, Val Recall: 0.6643, Val AUC: 0.7242
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.58it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.46671080589294434
train F1 is 0.7112616300582886
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]




 82%|███████████████████████████████████████████████████████████████████▎              | 23/28 [00:08<00:01,  2.55it/s]
New threshold is 0.4472578465938568
val F1 is 0.6430867910385132
Epoch 29/100, learning rate: 3.999963500103869e-06
Train Loss: 0.5804, Train Acc: 0.7085, Train f1: 0.7113, Train Precision: 0.6908, Train Recall: 0.7330, Train AUC: 0.7773
Valitadion Loss: 0.6005, Validation Acc: 0.6925, Vall f1: 0.6431, Val Precision: 0.5952, Val Recall: 0.6993, Val AUC: 0.7331
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.58it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
New threshold is 0.5036741495132446
train F1 is 0.6672629714012146
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]




 82%|███████████████████████████████████████████████████████████████████▎              | 23/28 [00:09<00:01,  2.57it/s]
New threshold is 0.47676318883895874
val F1 is 0.6435331106185913
Epoch 30/100, learning rate: 3.996351109358857e-06
Train Loss: 0.6001, Train Acc: 0.6821, Train f1: 0.6673, Train Precision: 0.6844, Train Recall: 0.6510, Train AUC: 0.7462
Valitadion Loss: 0.6149, Validation Acc: 0.6870, Vall f1: 0.6435, Val Precision: 0.5862, Val Recall: 0.7133, Val AUC: 0.7292
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.57it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.17it/s]
New threshold is 0.49841341376304626
train F1 is 0.6654411554336548
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]




100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.59it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.44369566440582275
val F1 is 0.6352201104164124
Epoch 31/100, learning rate: 3.986837959420468e-06
Train Loss: 0.5982, Train Acc: 0.6889, Train f1: 0.6654, Train Precision: 0.7029, Train Recall: 0.6318, Train AUC: 0.7475
Valitadion Loss: 0.6079, Validation Acc: 0.6787, Vall f1: 0.6352, Val Precision: 0.5771, Val Recall: 0.7063, Val AUC: 0.7277






































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
New threshold is 0.45887020230293274
train F1 is 0.7027914524078369
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]





 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.55it/s]
New threshold is 0.44597938656806946
val F1 is 0.6369863152503967
Epoch 32/100, learning rate: 3.971452169000261e-06
Train Loss: 0.5873, Train Acc: 0.6906, Train f1: 0.7028, Train Precision: 0.6636, Train Recall: 0.7469, Train AUC: 0.7625
Valitadion Loss: 0.5879, Validation Acc: 0.7064, Vall f1: 0.6370, Val Precision: 0.6242, Val Recall: 0.6503, Val AUC: 0.7419
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.57it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:10,  2.70it/s]
New threshold is 0.48929598927497864
train F1 is 0.6886383295059204





 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.55it/s]
New threshold is 0.38191622495651245
val F1 is 0.6278316974639893
Epoch 33/100, learning rate: 3.950239215001864e-06
Train Loss: 0.5898, Train Acc: 0.6932, Train f1: 0.6886, Train Precision: 0.6845, Train Recall: 0.6928, Train AUC: 0.7545
Valitadion Loss: 0.5875, Validation Acc: 0.6814, Vall f1: 0.6278, Val Precision: 0.5843, Val Recall: 0.6783, Val AUC: 0.7390
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.56it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
New threshold is 0.46551570296287537
train F1 is 0.7084047794342041





 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.53it/s]
New threshold is 0.5368503928184509
val F1 is 0.6081504821777344
Epoch 34/100, learning rate: 3.92326179810157e-06
Train Loss: 0.5704, Train Acc: 0.7094, Train f1: 0.7084, Train Precision: 0.6965, Train Recall: 0.7208, Train AUC: 0.7795
Valitadion Loss: 0.6428, Validation Acc: 0.6537, Vall f1: 0.6082, Val Precision: 0.5511, Val Recall: 0.6783, Val AUC: 0.7146
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.56it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.17it/s]
New threshold is 0.5156898498535156
train F1 is 0.6932126879692078
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]




 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.56it/s]
New threshold is 0.5301080942153931
val F1 is 0.6093189716339111
Epoch 35/100, learning rate: 3.890599657419372e-06
Train Loss: 0.5726, Train Acc: 0.7103, Train f1: 0.6932, Train Precision: 0.7199, Train Recall: 0.6684, Train AUC: 0.7760
Valitadion Loss: 0.6121, Validation Acc: 0.6981, Vall f1: 0.6093, Val Precision: 0.6250, Val Recall: 0.5944, Val AUC: 0.7248
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.59it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
New threshold is 0.4855078160762787
train F1 is 0.7050487399101257
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]




 82%|███████████████████████████████████████████████████████████████████▎              | 23/28 [00:08<00:01,  2.57it/s]
New threshold is 0.5238421559333801
val F1 is 0.6394984126091003
Epoch 36/100, learning rate: 3.852349334828228e-06
Train Loss: 0.5579, Train Acc: 0.7154, Train f1: 0.7050, Train Precision: 0.7158, Train Recall: 0.6946, Train AUC: 0.7908
Valitadion Loss: 0.6133, Validation Acc: 0.6814, Vall f1: 0.6395, Val Precision: 0.5795, Val Recall: 0.7133, Val AUC: 0.7455
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.57it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:16<00:01,  1.16it/s]
New threshold is 0.4754524827003479
train F1 is 0.7167530059814453
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]





 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.53it/s]
New threshold is 0.4940365254878998
val F1 is 0.672897219657898
Epoch 37/100, learning rate: 3.808623889598197e-06
Train Loss: 0.5525, Train Acc: 0.7197, Train f1: 0.7168, Train Precision: 0.7094, Train Recall: 0.7243, Train AUC: 0.7950
Valitadion Loss: 0.5910, Validation Acc: 0.7091, Vall f1: 0.6729, Val Precision: 0.6067, Val Recall: 0.7552, Val AUC: 0.7622
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.57it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
New threshold is 0.5245532989501953
train F1 is 0.7229791283607483





 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.57it/s]
New threshold is 0.5208757519721985
val F1 is 0.6020761132240295
Epoch 38/100, learning rate: 3.7595525642189087e-06
Train Loss: 0.5440, Train Acc: 0.7393, Train f1: 0.7230, Train Precision: 0.7538, Train Recall: 0.6946, Train AUC: 0.8026
Valitadion Loss: 0.6150, Validation Acc: 0.6814, Vall f1: 0.6021, Val Precision: 0.5959, Val Recall: 0.6084, Val AUC: 0.7198
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.57it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.46689286828041077
train F1 is 0.7376623153686523
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]




 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.55it/s]
New threshold is 0.6463901996612549
val F1 is 0.6050955653190613
Epoch 39/100, learning rate: 3.7052804023881018e-06
Train Loss: 0.5303, Train Acc: 0.7410, Train f1: 0.7377, Train Precision: 0.7320, Train Recall: 0.7435, Train AUC: 0.8172
Valitadion Loss: 0.7036, Validation Acc: 0.6565, Vall f1: 0.6051, Val Precision: 0.5556, Val Recall: 0.6643, Val AUC: 0.7182
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.58it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.5028961896896362
train F1 is 0.7298493981361389
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]




100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.56it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.5136406421661377
val F1 is 0.6351351141929626
Epoch 40/100, learning rate: 3.6459678202953795e-06
Train Loss: 0.5337, Train Acc: 0.7393, Train f1: 0.7298, Train Precision: 0.7410, Train Recall: 0.7190, Train AUC: 0.8110
Valitadion Loss: 0.6094, Validation Acc: 0.7008, Vall f1: 0.6351, Val Precision: 0.6144, Val Recall: 0.6573, Val AUC: 0.7306






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.44249165058135986
train F1 is 0.7558528184890747
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]




100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.57it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.571442186832428
val F1 is 0.6529209613800049
Epoch 41/100, learning rate: 3.5817901324683736e-06
Train Loss: 0.5122, Train Acc: 0.7504, Train f1: 0.7559, Train Precision: 0.7255, Train Recall: 0.7888, Train AUC: 0.8327
Valitadion Loss: 0.6096, Validation Acc: 0.7202, Vall f1: 0.6529, Val Precision: 0.6419, Val Recall: 0.6643, Val AUC: 0.7520






































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
New threshold is 0.4850704073905945
train F1 is 0.7403509020805359
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]





 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.54it/s]
New threshold is 0.504746675491333
val F1 is 0.6490066051483154
Epoch 42/100, learning rate: 3.5129370335827987e-06
Train Loss: 0.5224, Train Acc: 0.7470, Train f1: 0.7404, Train Precision: 0.7443, Train Recall: 0.7365, Train AUC: 0.8216
Valitadion Loss: 0.6006, Validation Acc: 0.7064, Vall f1: 0.6490, Val Precision: 0.6164, Val Recall: 0.6853, Val AUC: 0.7381
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.56it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:09,  2.72it/s]
New threshold is 0.5235358476638794
train F1 is 0.7430117130279541





 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.58it/s]
New threshold is 0.5370129942893982
val F1 is 0.6354514956474304
Epoch 43/100, learning rate: 3.439612037768055e-06
Train Loss: 0.5083, Train Acc: 0.7564, Train f1: 0.7430, Train Precision: 0.7687, Train Recall: 0.7190, Train AUC: 0.8324
Valitadion Loss: 0.6205, Validation Acc: 0.6981, Vall f1: 0.6355, Val Precision: 0.6090, Val Recall: 0.6643, Val AUC: 0.7269
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.60it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:09,  2.78it/s]
New threshold is 0.46631667017936707
train F1 is 0.7719298005104065





 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.54it/s]
New threshold is 0.5963221788406372
val F1 is 0.6305732727050781
Epoch 44/100, learning rate: 3.362031877065664e-06
Train Loss: 0.4855, Train Acc: 0.7778, Train f1: 0.7719, Train Precision: 0.7760, Train Recall: 0.7679, Train AUC: 0.8547
Valitadion Loss: 0.6660, Validation Acc: 0.6787, Vall f1: 0.6306, Val Precision: 0.5789, Val Recall: 0.6923, Val AUC: 0.7264
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.56it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.5219928026199341
train F1 is 0.7570009231567383
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]




 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.56it/s]
New threshold is 0.5712631344795227
val F1 is 0.6394984126091003
Epoch 45/100, learning rate: 3.2804258608185555e-06
Train Loss: 0.4978, Train Acc: 0.7701, Train f1: 0.7570, Train Precision: 0.7846, Train Recall: 0.7312, Train AUC: 0.8407
Valitadion Loss: 0.6902, Validation Acc: 0.6814, Vall f1: 0.6395, Val Precision: 0.5795, Val Recall: 0.7133, Val AUC: 0.7089
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.58it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.17it/s]
New threshold is 0.4832562208175659
train F1 is 0.7756521701812744
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]




 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.55it/s]
New threshold is 0.41204750537872314
val F1 is 0.6334519386291504
Epoch 46/100, learning rate: 3.1950351978847047e-06
Train Loss: 0.4806, Train Acc: 0.7795, Train f1: 0.7757, Train Precision: 0.7730, Train Recall: 0.7784, Train AUC: 0.8559
Valitadion Loss: 0.5880, Validation Acc: 0.7147, Vall f1: 0.6335, Val Precision: 0.6449, Val Recall: 0.6224, Val AUC: 0.7389
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.56it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
New threshold is 0.45219942927360535
train F1 is 0.7791095972061157
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]




100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.59it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.5558947324752808
val F1 is 0.6315789222717285
Epoch 47/100, learning rate: 3.1061122836785128e-06
Train Loss: 0.4774, Train Acc: 0.7795, Train f1: 0.7791, Train Precision: 0.7647, Train Recall: 0.7941, Train AUC: 0.8582
Valitadion Loss: 0.6792, Validation Acc: 0.6704, Vall f1: 0.6316, Val Precision: 0.5667, Val Recall: 0.7133, Val AUC: 0.7170






































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
New threshold is 0.46962615847587585
train F1 is 0.7728055119514465
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]





 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.54it/s]
New threshold is 0.4823993444442749
val F1 is 0.6184210777282715
Epoch 48/100, learning rate: 3.0139199541472535e-06
Train Loss: 0.4787, Train Acc: 0.7744, Train f1: 0.7728, Train Precision: 0.7623, Train Recall: 0.7836, Train AUC: 0.8553
Valitadion Loss: 0.6011, Validation Acc: 0.6787, Vall f1: 0.6184, Val Precision: 0.5839, Val Recall: 0.6573, Val AUC: 0.7405
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.57it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
New threshold is 0.48300185799598694
train F1 is 0.7737991213798523
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]





 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.56it/s]
New threshold is 0.5705305337905884
val F1 is 0.653333306312561
Epoch 49/100, learning rate: 2.918730708887687e-06
Train Loss: 0.4708, Train Acc: 0.7786, Train f1: 0.7738, Train Precision: 0.7745, Train Recall: 0.7731, Train AUC: 0.8618
Valitadion Loss: 0.6286, Validation Acc: 0.7119, Vall f1: 0.6533, Val Precision: 0.6242, Val Recall: 0.6853, Val AUC: 0.7425
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.57it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:17<00:00,  1.16it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:09,  2.82it/s]
New threshold is 0.5079705119132996
train F1 is 0.7764915227890015





 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.53it/s]
New threshold is 0.5937438011169434
val F1 is 0.6442952752113342
Epoch 50/100, learning rate: 2.82082590569911e-06
Train Loss: 0.4586, Train Acc: 0.7855, Train f1: 0.7765, Train Precision: 0.7927, Train Recall: 0.7609, Train AUC: 0.8698
Valitadion Loss: 0.6237, Validation Acc: 0.7064, Vall f1: 0.6443, Val Precision: 0.6194, Val Recall: 0.6713, Val AUC: 0.7429
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.58it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:14,  1.15it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:12,  1.15it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:10,  1.16it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:09,  1.16it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:06,  1.16it/s]
 17%|█████████████▋                                                                    | 15/90 [00:12<01:04,  1.17it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:01,  1.17it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<00:59,  1.17it/s]
 24%|████████████████████                                                              | 22/90 [00:18<00:58,  1.17it/s]
 27%|█████████████████████▊                                                            | 24/90 [00:20<00:56,  1.17it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:54,  1.15it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:25<00:52,  1.15it/s]
 34%|████████████████████████████▏                                                     | 31/90 [00:26<00:51,  1.15it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.16it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:31<00:46,  1.17it/s]
 42%|██████████████████████████████████▌                                               | 38/90 [00:32<00:44,  1.17it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:41,  1.17it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:40,  1.17it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:38<00:38,  1.17it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:35,  1.17it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:34,  1.17it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:44<00:32,  1.16it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.16it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.17it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:50<00:26,  1.17it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:23,  1.17it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.17it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:56<00:20,  1.17it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.16it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.17it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:02<00:14,  1.16it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.16it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 78/90 [01:07<00:10,  1.16it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:08<00:08,  1.17it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:11<00:06,  1.17it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 85/90 [01:13<00:04,  1.16it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:14<00:02,  1.16it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
New threshold is 0.47048160433769226
train F1 is 0.7972028255462646
 18%|██████████████▊                                                                    | 5/28 [00:01<00:08,  2.57it/s]
 36%|█████████████████████████████▎                                                    | 10/28 [00:03<00:07,  2.54it/s]
 54%|███████████████████████████████████████████▉                                      | 15/28 [00:05<00:05,  2.56it/s]
 71%|██████████████████████████████████████████████████████████▌                       | 20/28 [00:07<00:03,  2.54it/s]
 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.53it/s]
 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.53it/s]
New threshold is 0.3907546103000641
val F1 is 0.6544342637062073
Epoch 51/100, learning rate: 2.720494928953579e-06
Train Loss: 0.4569, Train Acc: 0.8017, Train f1: 0.7972, Train Precision: 0.7986, Train Recall: 0.7958, Train AUC: 0.8699
Valitadion Loss: 0.6188, Validation Acc: 0.6870, Vall f1: 0.6544, Val Precision: 0.5815, Val Recall: 0.7483, Val AUC: 0.7313
  1%|▉                                                                                  | 1/90 [00:00<01:20,  1.10it/s]
  3%|██▊                                                                                | 3/90 [00:02<01:16,  1.14it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:12,  1.16it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:10,  1.17it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:08,  1.16it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:06,  1.17it/s]
 17%|█████████████▋                                                                    | 15/90 [00:12<01:04,  1.17it/s]
 19%|███████████████▍                                                                  | 17/90 [00:14<01:02,  1.17it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<01:00,  1.16it/s]
 24%|████████████████████                                                              | 22/90 [00:18<00:58,  1.17it/s]
 27%|█████████████████████▊                                                            | 24/90 [00:20<00:56,  1.16it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:53,  1.17it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:24<00:52,  1.17it/s]
 34%|████████████████████████████▏                                                     | 31/90 [00:26<00:50,  1.17it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.16it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:30<00:46,  1.17it/s]
 42%|██████████████████████████████████▌                                               | 38/90 [00:32<00:44,  1.17it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.17it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:36<00:40,  1.17it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:38<00:38,  1.17it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:35,  1.17it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:42<00:34,  1.17it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:44<00:32,  1.16it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.16it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:48<00:28,  1.16it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:50<00:26,  1.15it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.16it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.16it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:56<00:20,  1.16it/s]
 76%|█████████████████████████████████████████████████████████████▉                    | 68/90 [00:58<00:18,  1.16it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.17it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:02<00:14,  1.16it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 75/90 [01:04<00:12,  1.16it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 78/90 [01:07<00:10,  1.16it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:08<00:08,  1.16it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:10<00:06,  1.16it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 85/90 [01:13<00:04,  1.16it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:14<00:02,  1.17it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.47542500495910645
train F1 is 0.801033616065979
 14%|███████████▊                                                                       | 4/28 [00:01<00:09,  2.58it/s]
 36%|█████████████████████████████▎                                                    | 10/28 [00:03<00:07,  2.55it/s]
 54%|███████████████████████████████████████████▉                                      | 15/28 [00:05<00:05,  2.57it/s]
 71%|██████████████████████████████████████████████████████████▌                       | 20/28 [00:07<00:03,  2.55it/s]
 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.55it/s]
 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.55it/s]
New threshold is 0.43720543384552
val F1 is 0.6520376205444336
Epoch 52/100, learning rate: 2.618034334241397e-06
Train Loss: 0.4472, Train Acc: 0.8026, Train f1: 0.8010, Train Precision: 0.7908, Train Recall: 0.8115, Train AUC: 0.8771
Valitadion Loss: 0.6339, Validation Acc: 0.6925, Vall f1: 0.6520, Val Precision: 0.5909, Val Recall: 0.7273, Val AUC: 0.7238
  1%|▉                                                                                  | 1/90 [00:00<01:20,  1.10it/s]
  3%|██▊                                                                                | 3/90 [00:02<01:16,  1.14it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:13,  1.15it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:10,  1.16it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:08,  1.16it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:07,  1.16it/s]
 17%|█████████████▋                                                                    | 15/90 [00:12<01:04,  1.16it/s]
 19%|███████████████▍                                                                  | 17/90 [00:14<01:02,  1.16it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:01,  1.16it/s]
 24%|████████████████████                                                              | 22/90 [00:18<00:58,  1.17it/s]
 27%|█████████████████████▊                                                            | 24/90 [00:20<00:56,  1.17it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:55,  1.16it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:24<00:52,  1.17it/s]
 34%|████████████████████████████▏                                                     | 31/90 [00:26<00:50,  1.16it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:49,  1.16it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:31<00:46,  1.16it/s]
 42%|██████████████████████████████████▌                                               | 38/90 [00:32<00:44,  1.16it/s]
 44%|████████████████████████████████████▍                                             | 40/90 [00:34<00:42,  1.17it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:40,  1.17it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:38<00:38,  1.17it/s]
 52%|██████████████████████████████████████████▊                                       | 47/90 [00:40<00:36,  1.16it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:34,  1.16it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:44<00:32,  1.16it/s]
 60%|█████████████████████████████████████████████████▏                                | 54/90 [00:46<00:30,  1.16it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.17it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:50<00:26,  1.17it/s]
 68%|███████████████████████████████████████████████████████▌                          | 61/90 [00:52<00:24,  1.17it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.17it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:56<00:20,  1.17it/s]
 76%|█████████████████████████████████████████████████████████████▉                    | 68/90 [00:58<00:18,  1.17it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.17it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:02<00:14,  1.16it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 75/90 [01:04<00:12,  1.16it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 78/90 [01:07<00:10,  1.16it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:08<00:08,  1.16it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:10<00:06,  1.17it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.16it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:14<00:02,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.4851585030555725
train F1 is 0.7989510297775269
 14%|███████████▊                                                                       | 4/28 [00:01<00:09,  2.62it/s]
 32%|██████████████████████████▋                                                        | 9/28 [00:03<00:07,  2.58it/s]
 50%|█████████████████████████████████████████                                         | 14/28 [00:05<00:05,  2.53it/s]
 68%|███████████████████████████████████████████████████████▋                          | 19/28 [00:07<00:03,  2.54it/s]
 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.53it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.4953518509864807
val F1 is 0.6382978558540344
Epoch 53/100, learning rate: 2.513746971820115e-06
Train Loss: 0.4302, Train Acc: 0.8034, Train f1: 0.7990, Train Precision: 0.8004, Train Recall: 0.7976, Train AUC: 0.8895
Valitadion Loss: 0.6683, Validation Acc: 0.6704, Vall f1: 0.6383, Val Precision: 0.5645, Val Recall: 0.7343, Val AUC: 0.7115
  3%|██▊                                                                                | 3/90 [00:02<01:15,  1.15it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:13,  1.16it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:11,  1.16it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:08,  1.17it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:06,  1.16it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:05,  1.16it/s]
 19%|███████████████▍                                                                  | 17/90 [00:14<01:02,  1.16it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:01,  1.17it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.16it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.17it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:55,  1.16it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.16it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:25<00:51,  1.17it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:49,  1.16it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:47,  1.16it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:31<00:45,  1.16it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:44,  1.16it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:41,  1.16it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:37<00:39,  1.16it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:37,  1.16it/s]
 54%|████████████████████████████████████████████▋                                     | 49/90 [00:42<00:35,  1.16it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:43<00:33,  1.16it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:45<00:31,  1.16it/s]
 62%|███████████████████████████████████████████████████                               | 56/90 [00:48<00:29,  1.16it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:49<00:27,  1.16it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:51<00:25,  1.16it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.16it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:55<00:21,  1.16it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:57<00:19,  1.16it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:00<00:17,  1.16it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:02<00:15,  1.16it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:03<00:13,  1.17it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.17it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:07<00:09,  1.17it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:09<00:07,  1.16it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.16it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.17it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.17it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.17it/s]
New threshold is 0.5208310484886169
train F1 is 0.8035874366760254
  7%|█████▉                                                                             | 2/28 [00:00<00:09,  2.72it/s]
 25%|████████████████████▊                                                              | 7/28 [00:02<00:08,  2.57it/s]
 43%|███████████████████████████████████▏                                              | 12/28 [00:04<00:06,  2.55it/s]
 61%|█████████████████████████████████████████████████▊                                | 17/28 [00:06<00:04,  2.55it/s]
 79%|████████████████████████████████████████████████████████████████▍                 | 22/28 [00:08<00:02,  2.55it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.57it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.57it/s]
New threshold is 0.4974696636199951
val F1 is 0.6292834877967834
Epoch 54/100, learning rate: 2.4079410914579237e-06
Train Loss: 0.4245, Train Acc: 0.8128, Train f1: 0.8036, Train Precision: 0.8266, Train Recall: 0.7818, Train AUC: 0.8934
Valitadion Loss: 0.6456, Validation Acc: 0.6704, Vall f1: 0.6293, Val Precision: 0.5674, Val Recall: 0.7063, Val AUC: 0.7323
  2%|█▊                                                                                 | 2/90 [00:01<01:17,  1.14it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:14,  1.16it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:12,  1.16it/s]
 10%|████████▎                                                                          | 9/90 [00:07<01:09,  1.16it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:08,  1.16it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:06,  1.16it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:03,  1.16it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:01,  1.17it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<01:00,  1.16it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.16it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:55,  1.16it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:53,  1.17it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:25<00:51,  1.16it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:50,  1.16it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.15it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:31<00:45,  1.16it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:43,  1.16it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.16it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:37<00:39,  1.16it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:37,  1.16it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:43<00:33,  1.16it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:45<00:31,  1.16it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.17it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:49<00:27,  1.17it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:51<00:25,  1.17it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:23,  1.17it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:55<00:21,  1.17it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:57<00:19,  1.16it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.17it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:01<00:15,  1.17it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:03<00:13,  1.16it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.16it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.16it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:09<00:07,  1.16it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:11<00:06,  1.16it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
New threshold is 0.4844784140586853
train F1 is 0.8108581304550171
  4%|██▉                                                                                | 1/28 [00:00<00:09,  2.81it/s]
 21%|█████████████████▊                                                                 | 6/28 [00:02<00:08,  2.56it/s]
 39%|████████████████████████████████▏                                                 | 11/28 [00:04<00:06,  2.54it/s]
 57%|██████████████████████████████████████████████▊                                   | 16/28 [00:06<00:04,  2.53it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 21/28 [00:08<00:02,  2.55it/s]
 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.53it/s]
 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.53it/s]
New threshold is 0.44009271264076233
val F1 is 0.638436496257782
Epoch 55/100, learning rate: 2.300929431317314e-06
Train Loss: 0.4291, Train Acc: 0.8154, Train f1: 0.8109, Train Precision: 0.8137, Train Recall: 0.8080, Train AUC: 0.8871
Valitadion Loss: 0.6128, Validation Acc: 0.6925, Vall f1: 0.6384, Val Precision: 0.5976, Val Recall: 0.6853, Val AUC: 0.7391
  1%|▉                                                                                  | 1/90 [00:00<01:21,  1.09it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:14,  1.15it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:12,  1.16it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:10,  1.16it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:08,  1.16it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:05,  1.17it/s]
 17%|█████████████▋                                                                    | 15/90 [00:12<01:04,  1.17it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:01,  1.17it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<00:59,  1.17it/s]
 24%|████████████████████                                                              | 22/90 [00:18<00:58,  1.17it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:55,  1.17it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:54,  1.16it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:24<00:52,  1.17it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:49,  1.16it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:47,  1.17it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:30<00:46,  1.16it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:43,  1.17it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.16it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:36<00:40,  1.16it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:37,  1.16it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:34,  1.16it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:45<00:31,  1.16it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.16it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.17it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:51<00:25,  1.17it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:23,  1.17it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.16it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:57<00:19,  1.16it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.16it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.16it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:03<00:13,  1.16it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.17it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 78/90 [01:07<00:10,  1.16it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:09<00:07,  1.16it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:11<00:06,  1.16it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 85/90 [01:13<00:04,  1.17it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
New threshold is 0.4657852053642273
train F1 is 0.8209083080291748
 21%|█████████████████▊                                                                 | 6/28 [00:02<00:08,  2.58it/s]
 39%|████████████████████████████████▏                                                 | 11/28 [00:04<00:06,  2.57it/s]
 57%|██████████████████████████████████████████████▊                                   | 16/28 [00:06<00:04,  2.58it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 21/28 [00:08<00:02,  2.56it/s]
 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.55it/s]
 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.55it/s]
New threshold is 0.44123509526252747
val F1 is 0.6451612710952759
Epoch 56/100, learning rate: 2.193028293572069e-06
Train Loss: 0.4217, Train Acc: 0.8214, Train f1: 0.8209, Train Precision: 0.8064, Train Recall: 0.8360, Train AUC: 0.8933
Valitadion Loss: 0.6119, Validation Acc: 0.6953, Vall f1: 0.6452, Val Precision: 0.5988, Val Recall: 0.6993, Val AUC: 0.7398
  1%|▉                                                                                  | 1/90 [00:00<01:21,  1.09it/s]
  3%|██▊                                                                                | 3/90 [00:02<01:16,  1.14it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:12,  1.16it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:10,  1.17it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:09,  1.16it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:06,  1.16it/s]
 17%|█████████████▋                                                                    | 15/90 [00:12<01:04,  1.17it/s]
 19%|███████████████▍                                                                  | 17/90 [00:14<01:02,  1.16it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<01:00,  1.16it/s]
 24%|████████████████████                                                              | 22/90 [00:18<00:58,  1.17it/s]
 27%|█████████████████████▊                                                            | 24/90 [00:20<00:56,  1.16it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:54,  1.16it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:25<00:52,  1.16it/s]
 34%|████████████████████████████▏                                                     | 31/90 [00:26<00:50,  1.16it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.16it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:31<00:46,  1.17it/s]
 42%|██████████████████████████████████▌                                               | 38/90 [00:32<00:44,  1.16it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.16it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:40,  1.16it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:38<00:38,  1.16it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:34,  1.17it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:44<00:32,  1.17it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.16it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.16it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:50<00:26,  1.16it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.16it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.16it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:56<00:20,  1.16it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:17,  1.17it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.17it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:02<00:14,  1.16it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.16it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 78/90 [01:07<00:10,  1.16it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:08<00:08,  1.16it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:11<00:06,  1.16it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 85/90 [01:13<00:04,  1.16it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:14<00:02,  1.16it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
New threshold is 0.48729726672172546
train F1 is 0.8129370808601379
 18%|██████████████▊                                                                    | 5/28 [00:01<00:09,  2.54it/s]
 36%|█████████████████████████████▎                                                    | 10/28 [00:03<00:07,  2.53it/s]
 54%|███████████████████████████████████████████▉                                      | 15/28 [00:05<00:05,  2.53it/s]
 71%|██████████████████████████████████████████████████████████▌                       | 20/28 [00:07<00:03,  2.52it/s]
 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.51it/s]
 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.51it/s]
New threshold is 0.5064008235931396
val F1 is 0.6357616186141968
Epoch 57/100, learning rate: 2.0845566094898446e-06
Train Loss: 0.4086, Train Acc: 0.8171, Train f1: 0.8129, Train Precision: 0.8144, Train Recall: 0.8115, Train AUC: 0.9002
Valitadion Loss: 0.6320, Validation Acc: 0.6953, Vall f1: 0.6358, Val Precision: 0.6038, Val Recall: 0.6713, Val AUC: 0.7333
  1%|▉                                                                                  | 1/90 [00:00<01:20,  1.10it/s]
  3%|██▊                                                                                | 3/90 [00:02<01:16,  1.13it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:14,  1.15it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:10,  1.16it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:09,  1.16it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:07,  1.16it/s]
 17%|█████████████▋                                                                    | 15/90 [00:12<01:04,  1.17it/s]
 19%|███████████████▍                                                                  | 17/90 [00:14<01:02,  1.17it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:00,  1.17it/s]
 24%|████████████████████                                                              | 22/90 [00:18<00:58,  1.16it/s]
 27%|█████████████████████▊                                                            | 24/90 [00:20<00:56,  1.16it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:55,  1.16it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:25<00:52,  1.16it/s]
 34%|████████████████████████████▏                                                     | 31/90 [00:26<00:50,  1.16it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:49,  1.16it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:31<00:46,  1.16it/s]
 42%|██████████████████████████████████▌                                               | 38/90 [00:32<00:44,  1.16it/s]
 44%|████████████████████████████████████▍                                             | 40/90 [00:34<00:42,  1.16it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:40,  1.16it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:38<00:38,  1.17it/s]
 52%|██████████████████████████████████████████▊                                       | 47/90 [00:40<00:36,  1.17it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:34,  1.17it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:44<00:32,  1.16it/s]
 60%|█████████████████████████████████████████████████▏                                | 54/90 [00:46<00:31,  1.16it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.16it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:50<00:26,  1.16it/s]
 68%|███████████████████████████████████████████████████████▌                          | 61/90 [00:52<00:24,  1.16it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.15it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:56<00:20,  1.16it/s]
 76%|█████████████████████████████████████████████████████████████▉                    | 68/90 [00:58<00:18,  1.16it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:00<00:17,  1.15it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:02<00:14,  1.16it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 75/90 [01:04<00:12,  1.16it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.16it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:08<00:08,  1.16it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:10<00:06,  1.16it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.16it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:14<00:02,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.44517430663108826
train F1 is 0.8156329393386841
 14%|███████████▊                                                                       | 4/28 [00:01<00:09,  2.59it/s]
 32%|██████████████████████████▋                                                        | 9/28 [00:03<00:07,  2.56it/s]
 50%|█████████████████████████████████████████                                         | 14/28 [00:05<00:05,  2.56it/s]
 68%|███████████████████████████████████████████████████████▋                          | 19/28 [00:07<00:03,  2.55it/s]
 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.54it/s]
 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.54it/s]
New threshold is 0.32533949613571167
val F1 is 0.6565349698066711
Epoch 58/100, learning rate: 1.975834996743742e-06
Train Loss: 0.4101, Train Acc: 0.8145, Train f1: 0.8156, Train Precision: 0.7947, Train Recall: 0.8377, Train AUC: 0.8986
Valitadion Loss: 0.6180, Validation Acc: 0.6870, Vall f1: 0.6565, Val Precision: 0.5806, Val Recall: 0.7552, Val AUC: 0.7319
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  3%|██▊                                                                                | 3/90 [00:02<01:15,  1.15it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:13,  1.16it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:11,  1.17it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:08,  1.17it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:06,  1.17it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:05,  1.16it/s]
 19%|███████████████▍                                                                  | 17/90 [00:14<01:02,  1.16it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:00,  1.17it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.16it/s]
 27%|█████████████████████▊                                                            | 24/90 [00:20<00:56,  1.16it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:54,  1.17it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.16it/s]
 34%|████████████████████████████▏                                                     | 31/90 [00:26<00:50,  1.16it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:49,  1.16it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:47,  1.16it/s]
 42%|██████████████████████████████████▌                                               | 38/90 [00:32<00:44,  1.16it/s]
 44%|████████████████████████████████████▍                                             | 40/90 [00:34<00:42,  1.16it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:41,  1.16it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:38<00:38,  1.16it/s]
 52%|██████████████████████████████████████████▊                                       | 47/90 [00:40<00:37,  1.16it/s]
 54%|████████████████████████████████████████████▋                                     | 49/90 [00:42<00:35,  1.16it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:44<00:32,  1.16it/s]
 60%|█████████████████████████████████████████████████▏                                | 54/90 [00:46<00:31,  1.16it/s]
 62%|███████████████████████████████████████████████████                               | 56/90 [00:48<00:29,  1.16it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:49<00:27,  1.16it/s]
 68%|███████████████████████████████████████████████████████▌                          | 61/90 [00:52<00:24,  1.16it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.16it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:56<00:21,  1.16it/s]
 76%|█████████████████████████████████████████████████████████████▉                    | 68/90 [00:58<00:19,  1.16it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:00<00:17,  1.15it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:02<00:15,  1.16it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 75/90 [01:04<00:12,  1.16it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.16it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.16it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:10<00:06,  1.16it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.16it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.4800969958305359
train F1 is 0.8157204985618591
 11%|████████▉                                                                          | 3/28 [00:01<00:09,  2.57it/s]
 29%|███████████████████████▋                                                           | 8/28 [00:03<00:07,  2.52it/s]
 46%|██████████████████████████████████████                                            | 13/28 [00:05<00:05,  2.55it/s]
 64%|████████████████████████████████████████████████████▋                             | 18/28 [00:07<00:03,  2.55it/s]
 82%|███████████████████████████████████████████████████████████████████▎              | 23/28 [00:09<00:01,  2.54it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.43548208475112915
val F1 is 0.6495176553726196
Epoch 59/100, learning rate: 1.8671848117392564e-06
Train Loss: 0.4013, Train Acc: 0.8197, Train f1: 0.8157, Train Precision: 0.8164, Train Recall: 0.8150, Train AUC: 0.9066
Valitadion Loss: 0.6222, Validation Acc: 0.6981, Vall f1: 0.6495, Val Precision: 0.6012, Val Recall: 0.7063, Val AUC: 0.7362
  2%|█▊                                                                                 | 2/90 [00:01<01:17,  1.13it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:14,  1.15it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:11,  1.15it/s]
 10%|████████▎                                                                          | 9/90 [00:07<01:09,  1.16it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:08,  1.16it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:05,  1.16it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:03,  1.16it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:01,  1.16it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.16it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.16it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:56,  1.16it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.16it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:25<00:51,  1.16it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:50,  1.16it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:47,  1.17it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:31<00:45,  1.17it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:43,  1.16it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:41,  1.16it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:37<00:39,  1.16it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:37,  1.16it/s]
 54%|████████████████████████████████████████████▋                                     | 49/90 [00:42<00:35,  1.16it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:43<00:33,  1.16it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:45<00:31,  1.16it/s]
 62%|███████████████████████████████████████████████████                               | 56/90 [00:48<00:29,  1.16it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:50<00:27,  1.16it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:51<00:25,  1.16it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.17it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:56<00:21,  1.16it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:57<00:19,  1.16it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:00<00:17,  1.17it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:02<00:15,  1.17it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:03<00:13,  1.16it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.16it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.16it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:09<00:07,  1.16it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.16it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
New threshold is 0.5491318702697754
train F1 is 0.8313795924186707
  7%|█████▉                                                                             | 2/28 [00:00<00:09,  2.70it/s]
 25%|████████████████████▊                                                              | 7/28 [00:02<00:08,  2.55it/s]
 43%|███████████████████████████████████▏                                              | 12/28 [00:04<00:06,  2.55it/s]
 61%|█████████████████████████████████████████████████▊                                | 17/28 [00:06<00:04,  2.54it/s]
 79%|████████████████████████████████████████████████████████████████▍                 | 22/28 [00:08<00:02,  2.54it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.56it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.56it/s]
New threshold is 0.4736713469028473
val F1 is 0.6555184125900269
Epoch 60/100, learning rate: 1.7589271997576942e-06
Train Loss: 0.3902, Train Acc: 0.8402, Train f1: 0.8314, Train Precision: 0.8601, Train Recall: 0.8045, Train AUC: 0.9113
Valitadion Loss: 0.6236, Validation Acc: 0.7147, Vall f1: 0.6555, Val Precision: 0.6282, Val Recall: 0.6853, Val AUC: 0.7389
  2%|█▊                                                                                 | 2/90 [00:01<01:17,  1.14it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:14,  1.15it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:12,  1.16it/s]
 10%|████████▎                                                                          | 9/90 [00:07<01:09,  1.17it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:07,  1.16it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:05,  1.17it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:03,  1.17it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:02,  1.16it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<00:59,  1.17it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.17it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:55,  1.17it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:53,  1.17it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:25<00:51,  1.17it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:49,  1.16it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.16it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:31<00:45,  1.17it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:43,  1.16it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.16it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:37<00:39,  1.17it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:37,  1.16it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:43<00:33,  1.17it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:45<00:31,  1.16it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.16it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:49<00:27,  1.17it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:51<00:25,  1.17it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.16it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:55<00:21,  1.16it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:57<00:19,  1.16it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.16it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:01<00:15,  1.16it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:03<00:13,  1.15it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.16it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:07<00:09,  1.16it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:09<00:07,  1.16it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:11<00:06,  1.16it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:13<00:03,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:09,  2.70it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:09,  2.70it/s]
New threshold is 0.5097644329071045
train F1 is 0.8166518807411194
 21%|█████████████████▊                                                                 | 6/28 [00:02<00:08,  2.54it/s]
 39%|████████████████████████████████▏                                                 | 11/28 [00:04<00:06,  2.55it/s]
 57%|██████████████████████████████████████████████▊                                   | 16/28 [00:06<00:04,  2.53it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 21/28 [00:08<00:02,  2.53it/s]
 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.54it/s]
 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.54it/s]
New threshold is 0.5144285559654236
val F1 is 0.6421404480934143
Epoch 61/100, learning rate: 1.6513821457236246e-06
Train Loss: 0.4041, Train Acc: 0.8231, Train f1: 0.8167, Train Precision: 0.8291, Train Recall: 0.8045, Train AUC: 0.9014
Valitadion Loss: 0.6248, Validation Acc: 0.7036, Vall f1: 0.6421, Val Precision: 0.6154, Val Recall: 0.6713, Val AUC: 0.7431
  1%|▉                                                                                  | 1/90 [00:00<01:20,  1.11it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:14,  1.15it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:13,  1.15it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:10,  1.16it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:08,  1.16it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:06,  1.16it/s]
 17%|█████████████▋                                                                    | 15/90 [00:12<01:04,  1.16it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:02,  1.16it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<01:00,  1.16it/s]
 24%|████████████████████                                                              | 22/90 [00:19<00:58,  1.16it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:55,  1.17it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:54,  1.16it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:25<00:52,  1.16it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:49,  1.16it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.16it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:31<00:46,  1.17it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:43,  1.16it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.16it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:40,  1.16it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:38<00:38,  1.16it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:34,  1.16it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:44<00:32,  1.16it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.16it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.16it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:50<00:26,  1.16it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.16it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.16it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:56<00:20,  1.16it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.16it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.16it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:02<00:14,  1.16it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.16it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 78/90 [01:07<00:10,  1.16it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:08<00:08,  1.16it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:10<00:06,  1.16it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.16it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:14<00:02,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.17it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.17it/s]
New threshold is 0.4466221034526825
train F1 is 0.8454312682151794
 14%|███████████▊                                                                       | 4/28 [00:01<00:09,  2.60it/s]
 32%|██████████████████████████▋                                                        | 9/28 [00:03<00:07,  2.57it/s]
 50%|█████████████████████████████████████████                                         | 14/28 [00:05<00:05,  2.56it/s]
 68%|███████████████████████████████████████████████████████▋                          | 19/28 [00:07<00:03,  2.53it/s]
 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.56it/s]
 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.56it/s]
New threshold is 0.3009510040283203
val F1 is 0.6606060862541199
Epoch 62/100, learning rate: 1.544867528402091e-06
Train Loss: 0.3913, Train Acc: 0.8453, Train f1: 0.8454, Train Precision: 0.8278, Train Recall: 0.8639, Train AUC: 0.9110
Valitadion Loss: 0.6027, Validation Acc: 0.6898, Vall f1: 0.6606, Val Precision: 0.5829, Val Recall: 0.7622, Val AUC: 0.7474
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  3%|██▊                                                                                | 3/90 [00:02<01:15,  1.15it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:13,  1.16it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:11,  1.16it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:08,  1.16it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:06,  1.17it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:05,  1.17it/s]
 19%|███████████████▍                                                                  | 17/90 [00:14<01:02,  1.16it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:00,  1.16it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.16it/s]
 27%|█████████████████████▊                                                            | 24/90 [00:20<00:56,  1.16it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:55,  1.16it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.16it/s]
 34%|████████████████████████████▏                                                     | 31/90 [00:26<00:50,  1.16it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:49,  1.16it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:47,  1.16it/s]
 42%|██████████████████████████████████▌                                               | 38/90 [00:32<00:45,  1.15it/s]
 44%|████████████████████████████████████▍                                             | 40/90 [00:34<00:43,  1.16it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:41,  1.16it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:38<00:38,  1.17it/s]
 52%|██████████████████████████████████████████▊                                       | 47/90 [00:40<00:36,  1.16it/s]
 54%|████████████████████████████████████████████▋                                     | 49/90 [00:42<00:35,  1.17it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:44<00:32,  1.16it/s]
 60%|█████████████████████████████████████████████████▏                                | 54/90 [00:46<00:31,  1.16it/s]
 62%|███████████████████████████████████████████████████                               | 56/90 [00:48<00:29,  1.16it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:50<00:26,  1.16it/s]
 68%|███████████████████████████████████████████████████████▌                          | 61/90 [00:52<00:24,  1.16it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.16it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:56<00:20,  1.16it/s]
 76%|█████████████████████████████████████████████████████████████▉                    | 68/90 [00:58<00:18,  1.16it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:00<00:17,  1.16it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:02<00:15,  1.16it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 75/90 [01:04<00:12,  1.17it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.16it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.16it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:10<00:06,  1.16it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.16it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.4835447072982788
train F1 is 0.8379096388816833
 11%|████████▉                                                                          | 3/28 [00:01<00:09,  2.55it/s]
 29%|███████████████████████▋                                                           | 8/28 [00:03<00:07,  2.53it/s]
 46%|██████████████████████████████████████                                            | 13/28 [00:05<00:05,  2.53it/s]
 64%|████████████████████████████████████████████████████▋                             | 18/28 [00:07<00:03,  2.55it/s]
 82%|███████████████████████████████████████████████████████████████████▎              | 23/28 [00:09<00:01,  2.54it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.378397673368454
val F1 is 0.6583071947097778
Epoch 63/100, learning rate: 1.4396981808211414e-06
Train Loss: 0.3852, Train Acc: 0.8436, Train f1: 0.8379, Train Precision: 0.8507, Train Recall: 0.8255, Train AUC: 0.9120
Valitadion Loss: 0.6153, Validation Acc: 0.6981, Vall f1: 0.6583, Val Precision: 0.5966, Val Recall: 0.7343, Val AUC: 0.7406
  2%|█▊                                                                                 | 2/90 [00:01<01:17,  1.13it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:13,  1.15it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:11,  1.16it/s]
 10%|████████▎                                                                          | 9/90 [00:07<01:09,  1.16it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:07,  1.16it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:05,  1.16it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:03,  1.16it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:00,  1.16it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.17it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.17it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:54,  1.17it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.17it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:25<00:51,  1.16it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:49,  1.16it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:47,  1.17it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:31<00:45,  1.16it/s]
 44%|████████████████████████████████████▍                                             | 40/90 [00:34<00:42,  1.16it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:41,  1.17it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:37<00:39,  1.16it/s]
 52%|██████████████████████████████████████████▊                                       | 47/90 [00:40<00:36,  1.16it/s]
 54%|████████████████████████████████████████████▋                                     | 49/90 [00:42<00:35,  1.16it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:43<00:33,  1.16it/s]
 60%|█████████████████████████████████████████████████▏                                | 54/90 [00:46<00:31,  1.16it/s]
 62%|███████████████████████████████████████████████████                               | 56/90 [00:48<00:29,  1.16it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:49<00:27,  1.16it/s]
 68%|███████████████████████████████████████████████████████▌                          | 61/90 [00:52<00:24,  1.16it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.16it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:55<00:21,  1.16it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:57<00:19,  1.16it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:00<00:17,  1.16it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:01<00:15,  1.16it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:03<00:13,  1.16it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.16it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.16it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:09<00:07,  1.16it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.16it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
New threshold is 0.49108076095581055
train F1 is 0.8339160680770874
  7%|█████▉                                                                             | 2/28 [00:00<00:09,  2.70it/s]
 25%|████████████████████▊                                                              | 7/28 [00:02<00:08,  2.58it/s]
 46%|██████████████████████████████████████                                            | 13/28 [00:05<00:05,  2.55it/s]
 64%|████████████████████████████████████████████████████▋                             | 18/28 [00:07<00:03,  2.54it/s]
 82%|███████████████████████████████████████████████████████████████████▎              | 23/28 [00:08<00:01,  2.55it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.4896380305290222
val F1 is 0.6464646458625793
Epoch 64/100, learning rate: 1.3361849596968697e-06
Train Loss: 0.3858, Train Acc: 0.8376, Train f1: 0.8339, Train Precision: 0.8354, Train Recall: 0.8325, Train AUC: 0.9123
Valitadion Loss: 0.6331, Validation Acc: 0.7091, Vall f1: 0.6465, Val Precision: 0.6234, Val Recall: 0.6713, Val AUC: 0.7370
  2%|█▊                                                                                 | 2/90 [00:01<01:17,  1.13it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:14,  1.15it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:11,  1.16it/s]
 10%|████████▎                                                                          | 9/90 [00:07<01:09,  1.16it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:07,  1.16it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:05,  1.16it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:03,  1.17it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:01,  1.17it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:58,  1.17it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.17it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:55,  1.17it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.16it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:25<00:51,  1.16it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:49,  1.16it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:47,  1.16it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:31<00:45,  1.16it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:43,  1.16it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:41,  1.17it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:37<00:39,  1.17it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:37,  1.16it/s]
 54%|████████████████████████████████████████████▋                                     | 49/90 [00:42<00:35,  1.16it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:43<00:33,  1.17it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:45<00:31,  1.16it/s]
 62%|███████████████████████████████████████████████████                               | 56/90 [00:48<00:29,  1.16it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:49<00:27,  1.17it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:51<00:25,  1.16it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.16it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:55<00:21,  1.17it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:57<00:19,  1.16it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:00<00:17,  1.16it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:01<00:15,  1.16it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:03<00:13,  1.16it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.16it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:07<00:09,  1.16it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:09<00:07,  1.16it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:11<00:06,  1.16it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:13<00:03,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.17it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.17it/s]
New threshold is 0.5074411034584045
train F1 is 0.8473080396652222
  7%|█████▉                                                                             | 2/28 [00:00<00:09,  2.65it/s]
 25%|████████████████████▊                                                              | 7/28 [00:02<00:08,  2.56it/s]
 43%|███████████████████████████████████▏                                              | 12/28 [00:04<00:06,  2.57it/s]
 61%|█████████████████████████████████████████████████▊                                | 17/28 [00:06<00:04,  2.55it/s]
 79%|████████████████████████████████████████████████████████████████▍                 | 22/28 [00:08<00:02,  2.53it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.55it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.55it/s]
New threshold is 0.424785315990448
val F1 is 0.6538461446762085
Epoch 65/100, learning rate: 1.2346338266115365e-06
Train Loss: 0.3815, Train Acc: 0.8521, Train f1: 0.8473, Train Precision: 0.8571, Train Recall: 0.8377, Train AUC: 0.9142
Valitadion Loss: 0.6341, Validation Acc: 0.7008, Vall f1: 0.6538, Val Precision: 0.6036, Val Recall: 0.7133, Val AUC: 0.7383
  2%|█▊                                                                                 | 2/90 [00:01<01:17,  1.14it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:14,  1.16it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:12,  1.15it/s]
 10%|████████▎                                                                          | 9/90 [00:07<01:09,  1.16it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:07,  1.16it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:05,  1.17it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:03,  1.16it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:02,  1.16it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<01:00,  1.16it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.16it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:55,  1.16it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:54,  1.16it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:25<00:51,  1.16it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:49,  1.16it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.17it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:31<00:45,  1.17it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:43,  1.16it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.15it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:40,  1.15it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:38,  1.15it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:34,  1.16it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:45<00:31,  1.16it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.16it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.16it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:51<00:25,  1.17it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.16it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.16it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:57<00:19,  1.16it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.16it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.15it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:03<00:13,  1.15it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.15it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 78/90 [01:07<00:10,  1.16it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:09<00:07,  1.15it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:11<00:06,  1.16it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 85/90 [01:13<00:04,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
New threshold is 0.4575551748275757
train F1 is 0.8534704446792603
 18%|██████████████▊                                                                    | 5/28 [00:01<00:08,  2.56it/s]
 36%|█████████████████████████████▎                                                    | 10/28 [00:03<00:07,  2.53it/s]
 57%|██████████████████████████████████████████████▊                                   | 16/28 [00:06<00:04,  2.56it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 21/28 [00:08<00:02,  2.56it/s]
 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.56it/s]
 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.56it/s]
New threshold is 0.42711758613586426
val F1 is 0.6354514956474304
Epoch 66/100, learning rate: 1.135344943660589e-06
Train Loss: 0.3670, Train Acc: 0.8538, Train f1: 0.8535, Train Precision: 0.8384, Train Recall: 0.8691, Train AUC: 0.9230
Valitadion Loss: 0.6323, Validation Acc: 0.6981, Vall f1: 0.6355, Val Precision: 0.6090, Val Recall: 0.6643, Val AUC: 0.7302
  1%|▉                                                                                  | 1/90 [00:00<01:21,  1.09it/s]
  3%|██▊                                                                                | 3/90 [00:02<01:16,  1.13it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:12,  1.16it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:10,  1.16it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:09,  1.16it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:05,  1.17it/s]
 17%|█████████████▋                                                                    | 15/90 [00:12<01:04,  1.17it/s]
 19%|███████████████▍                                                                  | 17/90 [00:14<01:02,  1.17it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<00:59,  1.17it/s]
 24%|████████████████████                                                              | 22/90 [00:18<00:58,  1.17it/s]
 27%|█████████████████████▊                                                            | 24/90 [00:20<00:56,  1.17it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:53,  1.17it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:24<00:52,  1.16it/s]
 34%|████████████████████████████▏                                                     | 31/90 [00:26<00:50,  1.16it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.16it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:31<00:46,  1.16it/s]
 42%|██████████████████████████████████▌                                               | 38/90 [00:32<00:44,  1.16it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.16it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:40,  1.16it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:38<00:38,  1.17it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:34,  1.16it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:44<00:32,  1.16it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.16it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.17it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:50<00:26,  1.16it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.16it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.16it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:56<00:20,  1.15it/s]
 76%|█████████████████████████████████████████████████████████████▉                    | 68/90 [00:58<00:18,  1.16it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.16it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:02<00:14,  1.16it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 75/90 [01:04<00:12,  1.16it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 78/90 [01:07<00:10,  1.16it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:08<00:08,  1.16it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:10<00:06,  1.16it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 85/90 [01:13<00:04,  1.16it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:14<00:02,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.44910338521003723
train F1 is 0.8501314520835876
 14%|███████████▊                                                                       | 4/28 [00:01<00:09,  2.61it/s]
 36%|█████████████████████████████▎                                                    | 10/28 [00:03<00:07,  2.53it/s]
 54%|███████████████████████████████████████████▉                                      | 15/28 [00:05<00:05,  2.52it/s]
 71%|██████████████████████████████████████████████████████████▌                       | 20/28 [00:07<00:03,  2.53it/s]
 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.54it/s]
 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.54it/s]
New threshold is 0.5323326587677002
val F1 is 0.6517571806907654
Epoch 67/100, learning rate: 1.0386117862416474e-06
Train Loss: 0.3589, Train Acc: 0.8538, Train f1: 0.8501, Train Precision: 0.8539, Train Recall: 0.8464, Train AUC: 0.9290
Valitadion Loss: 0.6661, Validation Acc: 0.6981, Vall f1: 0.6518, Val Precision: 0.6000, Val Recall: 0.7133, Val AUC: 0.7318
  1%|▉                                                                                  | 1/90 [00:00<01:21,  1.09it/s]
  3%|██▊                                                                                | 3/90 [00:02<01:16,  1.14it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:13,  1.15it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:10,  1.16it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:08,  1.16it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:07,  1.16it/s]
 17%|█████████████▋                                                                    | 15/90 [00:12<01:04,  1.16it/s]
 19%|███████████████▍                                                                  | 17/90 [00:14<01:03,  1.16it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:01,  1.16it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.16it/s]
 27%|█████████████████████▊                                                            | 24/90 [00:20<00:56,  1.16it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:55,  1.16it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.16it/s]
 34%|████████████████████████████▏                                                     | 31/90 [00:26<00:50,  1.17it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:48,  1.17it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:47,  1.17it/s]
 42%|██████████████████████████████████▌                                               | 38/90 [00:32<00:44,  1.17it/s]
 44%|████████████████████████████████████▍                                             | 40/90 [00:34<00:42,  1.16it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:41,  1.17it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:38<00:38,  1.17it/s]
 52%|██████████████████████████████████████████▊                                       | 47/90 [00:40<00:37,  1.16it/s]
 54%|████████████████████████████████████████████▋                                     | 49/90 [00:42<00:35,  1.16it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:44<00:32,  1.16it/s]
 60%|█████████████████████████████████████████████████▏                                | 54/90 [00:46<00:31,  1.16it/s]
 62%|███████████████████████████████████████████████████                               | 56/90 [00:48<00:29,  1.16it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:50<00:26,  1.16it/s]
 68%|███████████████████████████████████████████████████████▌                          | 61/90 [00:52<00:24,  1.16it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.16it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:56<00:20,  1.16it/s]
 76%|█████████████████████████████████████████████████████████████▉                    | 68/90 [00:58<00:19,  1.16it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:00<00:17,  1.16it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:02<00:14,  1.15it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 75/90 [01:04<00:12,  1.15it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.16it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.16it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:10<00:06,  1.16it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.16it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:15<00:02,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.45893150568008423
train F1 is 0.8323197364807129
 11%|████████▉                                                                          | 3/28 [00:01<00:09,  2.57it/s]
 29%|███████████████████████▋                                                           | 8/28 [00:03<00:07,  2.52it/s]
 46%|██████████████████████████████████████                                            | 13/28 [00:05<00:05,  2.52it/s]
 64%|████████████████████████████████████████████████████▋                             | 18/28 [00:07<00:03,  2.51it/s]
 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.55it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.5136175751686096
val F1 is 0.6559485793113708
Epoch 68/100, learning rate: 9.447202756078563e-07
Train Loss: 0.3694, Train Acc: 0.8350, Train f1: 0.8323, Train Precision: 0.8287, Train Recall: 0.8360, Train AUC: 0.9209
Valitadion Loss: 0.6676, Validation Acc: 0.7036, Vall f1: 0.6559, Val Precision: 0.6071, Val Recall: 0.7133, Val AUC: 0.7315
  2%|█▊                                                                                 | 2/90 [00:01<01:17,  1.13it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:13,  1.16it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:11,  1.16it/s]
 10%|████████▎                                                                          | 9/90 [00:07<01:09,  1.16it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:07,  1.16it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:05,  1.16it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:03,  1.16it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:00,  1.17it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.16it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.16it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:54,  1.17it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.16it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:25<00:51,  1.16it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:48,  1.17it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:47,  1.16it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:31<00:45,  1.16it/s]
 44%|████████████████████████████████████▍                                             | 40/90 [00:34<00:42,  1.16it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:41,  1.16it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:37<00:39,  1.16it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:37,  1.16it/s]
 54%|████████████████████████████████████████████▋                                     | 49/90 [00:42<00:35,  1.16it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:43<00:33,  1.16it/s]
 60%|█████████████████████████████████████████████████▏                                | 54/90 [00:46<00:30,  1.17it/s]
 62%|███████████████████████████████████████████████████                               | 56/90 [00:48<00:29,  1.16it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:49<00:27,  1.16it/s]
 68%|███████████████████████████████████████████████████████▌                          | 61/90 [00:52<00:24,  1.16it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.17it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:55<00:21,  1.16it/s]
 76%|█████████████████████████████████████████████████████████████▉                    | 68/90 [00:58<00:18,  1.16it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:00<00:17,  1.16it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:01<00:15,  1.16it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 75/90 [01:04<00:12,  1.17it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.16it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.16it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:09<00:07,  1.16it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.17it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
New threshold is 0.518293559551239
train F1 is 0.8397493362426758
  7%|█████▉                                                                             | 2/28 [00:00<00:10,  2.57it/s]
 29%|███████████████████████▋                                                           | 8/28 [00:03<00:07,  2.57it/s]
 46%|██████████████████████████████████████                                            | 13/28 [00:05<00:05,  2.55it/s]
 64%|████████████████████████████████████████████████████▋                             | 18/28 [00:07<00:03,  2.55it/s]
 82%|███████████████████████████████████████████████████████████████████▎              | 23/28 [00:08<00:01,  2.54it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.5717639327049255
val F1 is 0.638436496257782
Epoch 69/100, learning rate: 8.539479337495711e-07
Train Loss: 0.3666, Train Acc: 0.8470, Train f1: 0.8397, Train Precision: 0.8621, Train Recall: 0.8185, Train AUC: 0.9229
Valitadion Loss: 0.6762, Validation Acc: 0.6925, Vall f1: 0.6384, Val Precision: 0.5976, Val Recall: 0.6853, Val AUC: 0.7345
  2%|█▊                                                                                 | 2/90 [00:01<01:17,  1.13it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:15,  1.15it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:11,  1.16it/s]
 10%|████████▎                                                                          | 9/90 [00:07<01:09,  1.16it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:08,  1.16it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:06,  1.16it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:03,  1.16it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:02,  1.16it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.16it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.16it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:55,  1.16it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.15it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:25<00:51,  1.16it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:50,  1.16it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.16it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:32<00:45,  1.16it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:44,  1.16it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.16it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:38<00:39,  1.16it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:37,  1.16it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:44<00:33,  1.17it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:45<00:31,  1.16it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.16it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:50<00:27,  1.16it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:51<00:25,  1.16it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.16it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:56<00:21,  1.16it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:57<00:19,  1.16it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.16it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:02<00:15,  1.16it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:03<00:13,  1.16it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.16it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.16it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:09<00:07,  1.16it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:11<00:06,  1.15it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 85/90 [01:13<00:04,  1.15it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:16<00:01,  1.15it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:09,  2.74it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:09,  2.74it/s]
New threshold is 0.49693259596824646
train F1 is 0.8502164483070374
 21%|█████████████████▊                                                                 | 6/28 [00:02<00:08,  2.53it/s]
 39%|████████████████████████████████▏                                                 | 11/28 [00:04<00:06,  2.51it/s]
 57%|██████████████████████████████████████████████▊                                   | 16/28 [00:06<00:04,  2.53it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 21/28 [00:08<00:02,  2.48it/s]
 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.53it/s]
 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.53it/s]
New threshold is 0.44486871361732483
val F1 is 0.6378737688064575
Epoch 70/100, learning rate: 7.665630631023501e-07
Train Loss: 0.3611, Train Acc: 0.8521, Train f1: 0.8502, Train Precision: 0.8436, Train Recall: 0.8569, Train AUC: 0.9262
Valitadion Loss: 0.6273, Validation Acc: 0.6981, Vall f1: 0.6379, Val Precision: 0.6076, Val Recall: 0.6713, Val AUC: 0.7404
  1%|▉                                                                                  | 1/90 [00:00<01:20,  1.10it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:14,  1.15it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:12,  1.16it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:10,  1.16it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:07,  1.16it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:06,  1.16it/s]
 17%|█████████████▋                                                                    | 15/90 [00:12<01:04,  1.17it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:01,  1.17it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<01:00,  1.17it/s]
 24%|████████████████████                                                              | 22/90 [00:18<00:58,  1.16it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:55,  1.17it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:53,  1.17it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:24<00:52,  1.16it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:49,  1.16it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.16it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:31<00:46,  1.15it/s]
 42%|██████████████████████████████████▌                                               | 38/90 [00:32<00:45,  1.16it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.16it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:40,  1.15it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:38<00:38,  1.16it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:34,  1.16it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:44<00:32,  1.15it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.16it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.16it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:50<00:26,  1.17it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.16it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.16it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:56<00:20,  1.16it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.16it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.16it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:02<00:14,  1.16it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.16it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 78/90 [01:07<00:10,  1.16it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:08<00:08,  1.16it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:11<00:06,  1.16it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 85/90 [01:13<00:04,  1.16it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:14<00:02,  1.16it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
New threshold is 0.49814486503601074
train F1 is 0.8508384823799133
 18%|██████████████▊                                                                    | 5/28 [00:01<00:08,  2.56it/s]
 36%|█████████████████████████████▎                                                    | 10/28 [00:03<00:07,  2.54it/s]
 54%|███████████████████████████████████████████▉                                      | 15/28 [00:05<00:05,  2.54it/s]
 71%|██████████████████████████████████████████████████████████▌                       | 20/28 [00:07<00:03,  2.54it/s]
 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.55it/s]
  1%|▉                                                                                  | 1/90 [00:00<01:20,  1.11it/s]
  1%|▉                                                                                  | 1/90 [00:00<01:20,  1.11it/s]
New threshold is 0.4976244270801544
val F1 is 0.6447368264198303
Epoch 71/100, learning rate: 6.82823953505874e-07
Train Loss: 0.3489, Train Acc: 0.8556, Train f1: 0.8508, Train Precision: 0.8607, Train Recall: 0.8412, Train AUC: 0.9322
Valitadion Loss: 0.6407, Validation Acc: 0.7008, Vall f1: 0.6447, Val Precision: 0.6087, Val Recall: 0.6853, Val AUC: 0.7411
  3%|██▊                                                                                | 3/90 [00:02<01:15,  1.15it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:13,  1.15it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:10,  1.16it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:09,  1.16it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:07,  1.15it/s]
 17%|█████████████▋                                                                    | 15/90 [00:12<01:04,  1.16it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:03,  1.16it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:01,  1.16it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.16it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:58,  1.14it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:55,  1.15it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.15it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:26<00:52,  1.15it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:49,  1.16it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:47,  1.17it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:32<00:45,  1.16it/s]
 44%|████████████████████████████████████▍                                             | 40/90 [00:34<00:43,  1.16it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:41,  1.16it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:38<00:39,  1.16it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:37,  1.16it/s]
 54%|████████████████████████████████████████████▋                                     | 49/90 [00:42<00:35,  1.16it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:44<00:33,  1.16it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:45<00:31,  1.16it/s]
 62%|███████████████████████████████████████████████████                               | 56/90 [00:48<00:29,  1.16it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:50<00:27,  1.16it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:51<00:25,  1.16it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.16it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:56<00:21,  1.16it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:57<00:19,  1.17it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:00<00:17,  1.16it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:02<00:15,  1.16it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:03<00:13,  1.16it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.16it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.16it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:09<00:07,  1.16it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.16it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
New threshold is 0.4810148775577545
train F1 is 0.8700959086418152
  7%|█████▉                                                                             | 2/28 [00:00<00:09,  2.68it/s]
 25%|████████████████████▊                                                              | 7/28 [00:02<00:08,  2.58it/s]
 43%|███████████████████████████████████▏                                              | 12/28 [00:04<00:06,  2.55it/s]
 61%|█████████████████████████████████████████████████▊                                | 17/28 [00:06<00:04,  2.53it/s]
 79%|████████████████████████████████████████████████████████████████▍                 | 22/28 [00:08<00:02,  2.57it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.4547085165977478
val F1 is 0.6466666460037231
Epoch 72/100, learning rate: 6.029781187578088e-07
Train Loss: 0.3315, Train Acc: 0.8726, Train f1: 0.8701, Train Precision: 0.8693, Train Recall: 0.8709, Train AUC: 0.9415
Valitadion Loss: 0.6263, Validation Acc: 0.7064, Vall f1: 0.6467, Val Precision: 0.6178, Val Recall: 0.6783, Val AUC: 0.7441
  2%|█▊                                                                                 | 2/90 [00:01<01:17,  1.13it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:14,  1.15it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:11,  1.16it/s]
 10%|████████▎                                                                          | 9/90 [00:07<01:09,  1.16it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:07,  1.17it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:05,  1.16it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:03,  1.16it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:02,  1.16it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<01:00,  1.16it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.16it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:55,  1.17it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:54,  1.16it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:25<00:51,  1.16it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:49,  1.16it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.16it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:31<00:45,  1.16it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:43,  1.16it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.16it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:37<00:39,  1.16it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:37,  1.16it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:43<00:33,  1.17it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:45<00:31,  1.16it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.16it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:49<00:27,  1.16it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:51<00:25,  1.16it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.16it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:56<00:21,  1.16it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:57<00:19,  1.17it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:17,  1.17it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:02<00:15,  1.16it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:03<00:13,  1.16it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.16it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.16it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:09<00:07,  1.16it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:11<00:06,  1.16it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.17it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:09,  2.76it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:09,  2.76it/s]
New threshold is 0.48570218682289124
train F1 is 0.847517728805542
 21%|█████████████████▊                                                                 | 6/28 [00:02<00:08,  2.57it/s]
 39%|████████████████████████████████▏                                                 | 11/28 [00:04<00:06,  2.55it/s]
 61%|█████████████████████████████████████████████████▊                                | 17/28 [00:06<00:04,  2.54it/s]
 79%|████████████████████████████████████████████████████████████████▍                 | 22/28 [00:08<00:02,  2.56it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.56it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.56it/s]
New threshold is 0.44286784529685974
val F1 is 0.6410256624221802
Epoch 73/100, learning rate: 5.272615650192136e-07
Train Loss: 0.3570, Train Acc: 0.8530, Train f1: 0.8475, Train Precision: 0.8613, Train Recall: 0.8342, Train AUC: 0.9273
Valitadion Loss: 0.6506, Validation Acc: 0.6898, Vall f1: 0.6410, Val Precision: 0.5917, Val Recall: 0.6993, Val AUC: 0.7342
  1%|▉                                                                                  | 1/90 [00:00<01:21,  1.09it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:14,  1.15it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:12,  1.16it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:11,  1.15it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:08,  1.16it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:06,  1.15it/s]
 17%|█████████████▋                                                                    | 15/90 [00:13<01:04,  1.15it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:02,  1.16it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<01:00,  1.16it/s]
 24%|████████████████████                                                              | 22/90 [00:19<00:58,  1.16it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:55,  1.16it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:54,  1.16it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:25<00:52,  1.16it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:50,  1.15it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.16it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:31<00:46,  1.15it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:43,  1.16it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:41,  1.17it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:40,  1.16it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:37,  1.16it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:34,  1.16it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:45<00:32,  1.16it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.16it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.17it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:51<00:25,  1.17it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.17it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.16it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:56<00:20,  1.16it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.16it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.16it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:03<00:14,  1.16it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.16it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 78/90 [01:07<00:10,  1.16it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:09<00:08,  1.16it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:11<00:06,  1.15it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 85/90 [01:13<00:04,  1.15it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:15<00:02,  1.16it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
New threshold is 0.46017351746559143
train F1 is 0.8546861410140991
 18%|██████████████▊                                                                    | 5/28 [00:01<00:08,  2.57it/s]
 36%|█████████████████████████████▎                                                    | 10/28 [00:03<00:07,  2.54it/s]
 54%|███████████████████████████████████████████▉                                      | 15/28 [00:05<00:05,  2.52it/s]
 71%|██████████████████████████████████████████████████████████▌                       | 20/28 [00:07<00:03,  2.53it/s]
 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.52it/s]
 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.52it/s]
New threshold is 0.4763854146003723
val F1 is 0.6366559267044067
Epoch 74/100, learning rate: 4.5589809323390425e-07
Train Loss: 0.3362, Train Acc: 0.8556, Train f1: 0.8547, Train Precision: 0.8424, Train Recall: 0.8674, Train AUC: 0.9389
Valitadion Loss: 0.6570, Validation Acc: 0.6870, Vall f1: 0.6367, Val Precision: 0.5893, Val Recall: 0.6923, Val AUC: 0.7328
  1%|▉                                                                                  | 1/90 [00:00<01:19,  1.13it/s]
  3%|██▊                                                                                | 3/90 [00:02<01:16,  1.14it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:14,  1.15it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:11,  1.15it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:08,  1.16it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:07,  1.16it/s]
 17%|█████████████▋                                                                    | 15/90 [00:12<01:04,  1.16it/s]
 19%|███████████████▍                                                                  | 17/90 [00:14<01:02,  1.16it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:00,  1.17it/s]
 24%|████████████████████                                                              | 22/90 [00:18<00:58,  1.17it/s]
 27%|█████████████████████▊                                                            | 24/90 [00:20<00:56,  1.16it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:55,  1.15it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:25<00:52,  1.16it/s]
 34%|████████████████████████████▏                                                     | 31/90 [00:26<00:50,  1.16it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:49,  1.16it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:31<00:46,  1.16it/s]
 42%|██████████████████████████████████▌                                               | 38/90 [00:32<00:44,  1.16it/s]
 44%|████████████████████████████████████▍                                             | 40/90 [00:34<00:43,  1.15it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:40,  1.16it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:38<00:38,  1.16it/s]
 52%|██████████████████████████████████████████▊                                       | 47/90 [00:40<00:37,  1.16it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:34,  1.16it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:44<00:32,  1.16it/s]
 60%|█████████████████████████████████████████████████▏                                | 54/90 [00:46<00:30,  1.16it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.16it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:50<00:26,  1.16it/s]
 68%|███████████████████████████████████████████████████████▌                          | 61/90 [00:52<00:24,  1.16it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.16it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:56<00:20,  1.16it/s]
 76%|█████████████████████████████████████████████████████████████▉                    | 68/90 [00:58<00:19,  1.16it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:00<00:17,  1.17it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:02<00:14,  1.16it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 75/90 [01:04<00:12,  1.17it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.16it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:08<00:08,  1.16it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:10<00:06,  1.16it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.16it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:14<00:02,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.5193612575531006
train F1 is 0.8586666584014893
 14%|███████████▊                                                                       | 4/28 [00:01<00:09,  2.58it/s]
 32%|██████████████████████████▋                                                        | 9/28 [00:03<00:07,  2.52it/s]
 50%|█████████████████████████████████████████                                         | 14/28 [00:05<00:05,  2.52it/s]
 68%|███████████████████████████████████████████████████████▋                          | 19/28 [00:07<00:03,  2.51it/s]
 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.56it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.4718511700630188
val F1 is 0.647249162197113
Epoch 75/100, learning rate: 3.8909863762367485e-07
Train Loss: 0.3397, Train Acc: 0.8641, Train f1: 0.8587, Train Precision: 0.8750, Train Recall: 0.8429, Train AUC: 0.9362
Valitadion Loss: 0.6512, Validation Acc: 0.6981, Vall f1: 0.6472, Val Precision: 0.6024, Val Recall: 0.6993, Val AUC: 0.7362
  3%|██▊                                                                                | 3/90 [00:02<01:15,  1.15it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:13,  1.16it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:11,  1.16it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:08,  1.17it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:07,  1.16it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:05,  1.16it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:03,  1.16it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:01,  1.16it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.16it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.17it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:55,  1.16it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.16it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:25<00:51,  1.17it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:49,  1.16it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:47,  1.16it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:31<00:45,  1.16it/s]
 44%|████████████████████████████████████▍                                             | 40/90 [00:34<00:43,  1.16it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:41,  1.16it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:37<00:39,  1.15it/s]
 52%|██████████████████████████████████████████▊                                       | 47/90 [00:40<00:37,  1.16it/s]
 54%|████████████████████████████████████████████▋                                     | 49/90 [00:42<00:35,  1.16it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:43<00:33,  1.16it/s]
 60%|█████████████████████████████████████████████████▏                                | 54/90 [00:46<00:31,  1.16it/s]
 62%|███████████████████████████████████████████████████                               | 56/90 [00:48<00:29,  1.16it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:50<00:27,  1.16it/s]
 68%|███████████████████████████████████████████████████████▌                          | 61/90 [00:52<00:24,  1.16it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.16it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:56<00:21,  1.16it/s]
 76%|█████████████████████████████████████████████████████████████▉                    | 68/90 [00:58<00:19,  1.16it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:00<00:17,  1.16it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:02<00:15,  1.16it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 75/90 [01:04<00:12,  1.16it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.17it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.16it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:10<00:06,  1.16it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.17it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.4310661554336548
train F1 is 0.8657487034797668
  7%|█████▉                                                                             | 2/28 [00:00<00:09,  2.62it/s]
 29%|███████████████████████▋                                                           | 8/28 [00:03<00:07,  2.54it/s]
 46%|██████████████████████████████████████                                            | 13/28 [00:05<00:05,  2.52it/s]
 64%|████████████████████████████████████████████████████▋                             | 18/28 [00:07<00:03,  2.53it/s]
 82%|███████████████████████████████████████████████████████████████████▎              | 23/28 [00:09<00:01,  2.56it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.4372449815273285
val F1 is 0.6405228972434998
Epoch 76/100, learning rate: 3.2706064221461546e-07
Train Loss: 0.3359, Train Acc: 0.8667, Train f1: 0.8657, Train Precision: 0.8540, Train Recall: 0.8778, Train AUC: 0.9372
Valitadion Loss: 0.6443, Validation Acc: 0.6953, Vall f1: 0.6405, Val Precision: 0.6012, Val Recall: 0.6853, Val AUC: 0.7386
  2%|█▊                                                                                 | 2/90 [00:01<01:18,  1.12it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:15,  1.14it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:11,  1.16it/s]
 10%|████████▎                                                                          | 9/90 [00:07<01:09,  1.16it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:07,  1.17it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:05,  1.16it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:03,  1.16it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:02,  1.16it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.16it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.16it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:55,  1.16it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.17it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:25<00:51,  1.16it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:50,  1.16it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:47,  1.16it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:31<00:45,  1.16it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:43,  1.16it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.16it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:37<00:39,  1.16it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:37,  1.16it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:44<00:33,  1.16it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:45<00:32,  1.16it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.16it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:50<00:27,  1.16it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:51<00:25,  1.16it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.16it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:56<00:21,  1.16it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:57<00:19,  1.16it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.16it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:02<00:15,  1.16it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:03<00:13,  1.16it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.16it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.16it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:09<00:07,  1.16it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:11<00:06,  1.16it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:09,  2.82it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:09,  2.82it/s]
New threshold is 0.4893897473812103
train F1 is 0.859649121761322
 21%|█████████████████▊                                                                 | 6/28 [00:02<00:08,  2.57it/s]
 39%|████████████████████████████████▏                                                 | 11/28 [00:04<00:06,  2.54it/s]
 57%|██████████████████████████████████████████████▊                                   | 16/28 [00:06<00:04,  2.53it/s]
 79%|████████████████████████████████████████████████████████████████▍                 | 22/28 [00:08<00:02,  2.56it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.54it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.54it/s]
New threshold is 0.4854732155799866
val F1 is 0.6428571343421936
Epoch 77/100, learning rate: 2.699674772374047e-07
Train Loss: 0.3446, Train Acc: 0.8632, Train f1: 0.8596, Train Precision: 0.8642, Train Recall: 0.8551, Train AUC: 0.9330
Valitadion Loss: 0.6517, Validation Acc: 0.6953, Vall f1: 0.6429, Val Precision: 0.6000, Val Recall: 0.6923, Val AUC: 0.7375
  1%|▉                                                                                  | 1/90 [00:00<01:21,  1.10it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:14,  1.16it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:12,  1.16it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:10,  1.16it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:07,  1.16it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:06,  1.16it/s]
 17%|█████████████▋                                                                    | 15/90 [00:12<01:04,  1.17it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:01,  1.16it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<01:00,  1.15it/s]
 24%|████████████████████                                                              | 22/90 [00:18<00:58,  1.16it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:55,  1.16it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:54,  1.16it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:25<00:52,  1.16it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:49,  1.16it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.16it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:31<00:47,  1.15it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:44,  1.14it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:43,  1.13it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:41,  1.12it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:39<00:40,  1.12it/s]
 52%|██████████████████████████████████████████▊                                       | 47/90 [00:40<00:38,  1.12it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:35,  1.12it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:45<00:33,  1.13it/s]
 60%|█████████████████████████████████████████████████▏                                | 54/90 [00:47<00:31,  1.15it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.16it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:51<00:26,  1.16it/s]
 68%|███████████████████████████████████████████████████████▌                          | 61/90 [00:53<00:25,  1.16it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.16it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:57<00:20,  1.16it/s]
 76%|█████████████████████████████████████████████████████████████▉                    | 68/90 [00:59<00:18,  1.16it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.16it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:03<00:14,  1.16it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 75/90 [01:05<00:12,  1.16it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 78/90 [01:07<00:10,  1.16it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:09<00:08,  1.16it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:11<00:06,  1.15it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 85/90 [01:13<00:04,  1.16it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:15<00:02,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:17<00:00,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:17<00:00,  1.16it/s]
New threshold is 0.45221245288848877
train F1 is 0.8421052694320679
 14%|███████████▊                                                                       | 4/28 [00:01<00:09,  2.60it/s]
 32%|██████████████████████████▋                                                        | 9/28 [00:03<00:07,  2.54it/s]
 50%|█████████████████████████████████████████                                         | 14/28 [00:05<00:05,  2.56it/s]
 68%|███████████████████████████████████████████████████████▋                          | 19/28 [00:07<00:03,  2.52it/s]
 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.50it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.46904829144477844
val F1 is 0.647249162197113
Epoch 78/100, learning rate: 2.179878971265265e-07
Train Loss: 0.3570, Train Acc: 0.8436, Train f1: 0.8421, Train Precision: 0.8328, Train Recall: 0.8517, Train AUC: 0.9249
Valitadion Loss: 0.6472, Validation Acc: 0.6981, Vall f1: 0.6472, Val Precision: 0.6024, Val Recall: 0.6993, Val AUC: 0.7404
  3%|██▊                                                                                | 3/90 [00:02<01:15,  1.15it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:13,  1.15it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:11,  1.16it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:08,  1.16it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:07,  1.16it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:05,  1.16it/s]
 19%|███████████████▍                                                                  | 17/90 [00:14<01:02,  1.16it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:00,  1.17it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.17it/s]
 27%|█████████████████████▊                                                            | 24/90 [00:20<00:56,  1.17it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:54,  1.17it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.17it/s]
 34%|████████████████████████████▏                                                     | 31/90 [00:26<00:50,  1.16it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:49,  1.16it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:47,  1.16it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:31<00:45,  1.16it/s]
 44%|████████████████████████████████████▍                                             | 40/90 [00:34<00:43,  1.16it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:41,  1.16it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:37<00:39,  1.16it/s]
 52%|██████████████████████████████████████████▊                                       | 47/90 [00:40<00:36,  1.16it/s]
 54%|████████████████████████████████████████████▋                                     | 49/90 [00:42<00:35,  1.16it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:43<00:33,  1.16it/s]
 60%|█████████████████████████████████████████████████▏                                | 54/90 [00:46<00:31,  1.15it/s]
 62%|███████████████████████████████████████████████████                               | 56/90 [00:48<00:29,  1.15it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:50<00:27,  1.15it/s]
 68%|███████████████████████████████████████████████████████▌                          | 61/90 [00:52<00:25,  1.16it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.15it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:56<00:21,  1.15it/s]
 76%|█████████████████████████████████████████████████████████████▉                    | 68/90 [00:58<00:19,  1.15it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:00<00:17,  1.16it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:02<00:15,  1.16it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 75/90 [01:04<00:12,  1.16it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.15it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.16it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:10<00:06,  1.16it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.16it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
New threshold is 0.45648759603500366
train F1 is 0.8559102416038513
  7%|█████▉                                                                             | 2/28 [00:00<00:09,  2.61it/s]
 25%|████████████████████▊                                                              | 7/28 [00:02<00:08,  2.53it/s]
 46%|██████████████████████████████████████                                            | 13/28 [00:05<00:05,  2.53it/s]
 64%|████████████████████████████████████████████████████▋                             | 18/28 [00:07<00:03,  2.51it/s]
 82%|███████████████████████████████████████████████████████████████████▎              | 23/28 [00:09<00:01,  2.54it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.4532216191291809
val F1 is 0.6539682745933533
Epoch 79/100, learning rate: 1.7127554172048022e-07
Train Loss: 0.3390, Train Acc: 0.8573, Train f1: 0.8559, Train Precision: 0.8464, Train Recall: 0.8656, Train AUC: 0.9359
Valitadion Loss: 0.6439, Validation Acc: 0.6981, Vall f1: 0.6540, Val Precision: 0.5988, Val Recall: 0.7203, Val AUC: 0.7413
  2%|█▊                                                                                 | 2/90 [00:01<01:18,  1.12it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:15,  1.14it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:12,  1.15it/s]
 10%|████████▎                                                                          | 9/90 [00:07<01:09,  1.16it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:08,  1.16it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:05,  1.16it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:03,  1.16it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:01,  1.17it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.16it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.17it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:55,  1.17it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:54,  1.16it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:25<00:51,  1.16it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:50,  1.16it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.16it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:31<00:45,  1.16it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:44,  1.16it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.16it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:38<00:39,  1.16it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:38,  1.15it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:44<00:33,  1.16it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:45<00:31,  1.17it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.17it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:50<00:27,  1.17it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:51<00:25,  1.17it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.16it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:56<00:21,  1.16it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:57<00:19,  1.16it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.16it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:02<00:15,  1.16it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:03<00:13,  1.16it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.16it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.17it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:09<00:07,  1.16it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:11<00:06,  1.16it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.16it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:10,  2.58it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:10,  2.58it/s]
New threshold is 0.4673382639884949
train F1 is 0.8519480228424072
 21%|█████████████████▊                                                                 | 6/28 [00:02<00:08,  2.53it/s]
 39%|████████████████████████████████▏                                                 | 11/28 [00:04<00:06,  2.51it/s]
 57%|██████████████████████████████████████████████▊                                   | 16/28 [00:06<00:04,  2.52it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 21/28 [00:08<00:02,  2.51it/s]
 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.54it/s]
 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.54it/s]
New threshold is 0.4565395712852478
val F1 is 0.6539682745933533
Epoch 80/100, learning rate: 1.2996848213729188e-07
Train Loss: 0.3541, Train Acc: 0.8538, Train f1: 0.8519, Train Precision: 0.8454, Train Recall: 0.8586, Train AUC: 0.9274
Valitadion Loss: 0.6474, Validation Acc: 0.6981, Vall f1: 0.6540, Val Precision: 0.5988, Val Recall: 0.7203, Val AUC: 0.7406
  1%|▉                                                                                  | 1/90 [00:00<01:21,  1.09it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:14,  1.15it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:12,  1.15it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:10,  1.16it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:07,  1.16it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:06,  1.16it/s]
 17%|█████████████▋                                                                    | 15/90 [00:12<01:04,  1.16it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:01,  1.17it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<01:00,  1.16it/s]
 24%|████████████████████                                                              | 22/90 [00:19<00:58,  1.16it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:55,  1.16it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:54,  1.16it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:25<00:52,  1.16it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:49,  1.16it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.16it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:31<00:46,  1.16it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:43,  1.17it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.16it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:40,  1.16it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:38<00:38,  1.16it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:34,  1.16it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:44<00:32,  1.16it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.16it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.16it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:50<00:26,  1.17it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.16it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.15it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:56<00:20,  1.16it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.16it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.16it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:02<00:14,  1.16it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.16it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.16it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:09<00:08,  1.15it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:10<00:06,  1.16it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.16it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:15<00:02,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.44214221835136414
train F1 is 0.8576329350471497
 14%|███████████▊                                                                       | 4/28 [00:01<00:09,  2.58it/s]
 32%|██████████████████████████▋                                                        | 9/28 [00:03<00:07,  2.54it/s]
 50%|█████████████████████████████████████████                                         | 14/28 [00:05<00:05,  2.54it/s]
 68%|███████████████████████████████████████████████████████▋                          | 19/28 [00:07<00:03,  2.52it/s]
 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.54it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.5017252564430237
val F1 is 0.6426229476928711
Epoch 81/100, learning rate: 9.418881266763563e-08
Train Loss: 0.3405, Train Acc: 0.8581, Train f1: 0.8576, Train Precision: 0.8432, Train Recall: 0.8726, Train AUC: 0.9364
Valitadion Loss: 0.6513, Validation Acc: 0.6981, Vall f1: 0.6426, Val Precision: 0.6049, Val Recall: 0.6853, Val AUC: 0.7385
  2%|█▊                                                                                 | 2/90 [00:01<01:18,  1.12it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:13,  1.15it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:11,  1.16it/s]
 10%|████████▎                                                                          | 9/90 [00:07<01:09,  1.16it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:07,  1.16it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:05,  1.16it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:03,  1.16it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:01,  1.16it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.17it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.16it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:55,  1.16it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.16it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:25<00:51,  1.16it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:49,  1.15it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:47,  1.16it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:31<00:45,  1.16it/s]
 44%|████████████████████████████████████▍                                             | 40/90 [00:34<00:43,  1.16it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:41,  1.16it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:38<00:40,  1.15it/s]
 52%|██████████████████████████████████████████▊                                       | 47/90 [00:40<00:37,  1.15it/s]
 54%|████████████████████████████████████████████▋                                     | 49/90 [00:42<00:35,  1.16it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:44<00:33,  1.16it/s]
 60%|█████████████████████████████████████████████████▏                                | 54/90 [00:46<00:31,  1.16it/s]
 62%|███████████████████████████████████████████████████                               | 56/90 [00:48<00:29,  1.16it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:50<00:27,  1.16it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:51<00:25,  1.16it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.13it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:56<00:21,  1.15it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:57<00:19,  1.16it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:00<00:17,  1.15it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:02<00:15,  1.16it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:03<00:13,  1.15it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.16it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.16it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:10<00:07,  1.16it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.16it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:16<00:01,  1.16it/s]
  7%|█████▉                                                                             | 2/28 [00:00<00:09,  2.61it/s]
  7%|█████▉                                                                             | 2/28 [00:00<00:09,  2.61it/s]
New threshold is 0.5007765889167786
train F1 is 0.8588957190513611
 25%|████████████████████▊                                                              | 7/28 [00:02<00:08,  2.53it/s]
 43%|███████████████████████████████████▏                                              | 12/28 [00:04<00:06,  2.54it/s]
 61%|█████████████████████████████████████████████████▊                                | 17/28 [00:06<00:04,  2.52it/s]
 79%|████████████████████████████████████████████████████████████████▍                 | 22/28 [00:08<00:02,  2.54it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.53it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.53it/s]
New threshold is 0.5121742486953735
val F1 is 0.6447368264198303
Epoch 82/100, learning rate: 6.404228989182781e-08
Train Loss: 0.3365, Train Acc: 0.8624, Train f1: 0.8589, Train Precision: 0.8627, Train Recall: 0.8551, Train AUC: 0.9370
Valitadion Loss: 0.6547, Validation Acc: 0.7008, Vall f1: 0.6447, Val Precision: 0.6087, Val Recall: 0.6853, Val AUC: 0.7377
  2%|█▊                                                                                 | 2/90 [00:01<01:17,  1.13it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:14,  1.15it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:12,  1.16it/s]
 10%|████████▎                                                                          | 9/90 [00:07<01:10,  1.15it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:08,  1.15it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:06,  1.16it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:03,  1.16it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:02,  1.16it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<01:00,  1.16it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.16it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:56,  1.16it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:54,  1.16it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:25<00:52,  1.15it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:49,  1.16it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.16it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:31<00:46,  1.16it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:44,  1.16it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.16it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:40,  1.16it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:37,  1.16it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:34,  1.17it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:45<00:32,  1.15it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.16it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.16it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:51<00:25,  1.16it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.16it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.15it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:57<00:19,  1.16it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.16it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.15it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:03<00:13,  1.16it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.16it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 78/90 [01:07<00:10,  1.15it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:09<00:08,  1.16it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:11<00:06,  1.16it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 85/90 [01:13<00:04,  1.16it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:15<00:02,  1.16it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
New threshold is 0.5451925992965698
train F1 is 0.8677905797958374
 18%|██████████████▊                                                                    | 5/28 [00:01<00:09,  2.54it/s]
 36%|█████████████████████████████▎                                                    | 10/28 [00:03<00:07,  2.51it/s]
 54%|███████████████████████████████████████████▉                                      | 15/28 [00:05<00:05,  2.55it/s]
 71%|██████████████████████████████████████████████████████████▌                       | 20/28 [00:07<00:03,  2.52it/s]
 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.52it/s]
 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.52it/s]
New threshold is 0.5012316703796387
val F1 is 0.6402640342712402
Epoch 83/100, learning rate: 3.9618020087385905e-08
Train Loss: 0.3200, Train Acc: 0.8726, Train f1: 0.8678, Train Precision: 0.8827, Train Recall: 0.8534, Train AUC: 0.9457
Valitadion Loss: 0.6513, Validation Acc: 0.6981, Vall f1: 0.6403, Val Precision: 0.6062, Val Recall: 0.6783, Val AUC: 0.7381
  1%|▉                                                                                  | 1/90 [00:00<01:21,  1.09it/s]
  3%|██▊                                                                                | 3/90 [00:02<01:16,  1.13it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:14,  1.15it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:11,  1.15it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:09,  1.16it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:07,  1.16it/s]
 17%|█████████████▋                                                                    | 15/90 [00:13<01:04,  1.16it/s]
 19%|███████████████▍                                                                  | 17/90 [00:14<01:02,  1.16it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:00,  1.16it/s]
 24%|████████████████████                                                              | 22/90 [00:19<00:58,  1.16it/s]
 27%|█████████████████████▊                                                            | 24/90 [00:20<00:56,  1.17it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:55,  1.16it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:25<00:52,  1.16it/s]
 34%|████████████████████████████▏                                                     | 31/90 [00:26<00:50,  1.16it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:49,  1.16it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:31<00:46,  1.16it/s]
 42%|██████████████████████████████████▌                                               | 38/90 [00:32<00:44,  1.16it/s]
 44%|████████████████████████████████████▍                                             | 40/90 [00:34<00:43,  1.15it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:40,  1.16it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:38<00:38,  1.16it/s]
 52%|██████████████████████████████████████████▊                                       | 47/90 [00:40<00:37,  1.16it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:34,  1.16it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:44<00:32,  1.16it/s]
 60%|█████████████████████████████████████████████████▏                                | 54/90 [00:46<00:31,  1.16it/s]
 62%|███████████████████████████████████████████████████                               | 56/90 [00:48<00:29,  1.16it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:50<00:26,  1.15it/s]
 68%|███████████████████████████████████████████████████████▌                          | 61/90 [00:52<00:24,  1.16it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.17it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:56<00:20,  1.16it/s]
 76%|█████████████████████████████████████████████████████████████▉                    | 68/90 [00:58<00:18,  1.17it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:00<00:17,  1.16it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:02<00:14,  1.16it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 75/90 [01:04<00:12,  1.16it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.16it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:09<00:08,  1.16it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:10<00:06,  1.16it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.16it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:15<00:02,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.4760138988494873
train F1 is 0.8691099286079407
 14%|███████████▊                                                                       | 4/28 [00:01<00:09,  2.60it/s]
 32%|██████████████████████████▋                                                        | 9/28 [00:03<00:07,  2.53it/s]
 50%|█████████████████████████████████████████                                         | 14/28 [00:05<00:05,  2.52it/s]
 68%|███████████████████████████████████████████████████████▋                          | 19/28 [00:07<00:03,  2.50it/s]
 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.50it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.5026915073394775
val F1 is 0.6402640342712402
Epoch 84/100, learning rate: 2.098819585109748e-08
Train Loss: 0.3285, Train Acc: 0.8718, Train f1: 0.8691, Train Precision: 0.8691, Train Recall: 0.8691, Train AUC: 0.9408
Valitadion Loss: 0.6522, Validation Acc: 0.6981, Vall f1: 0.6403, Val Precision: 0.6062, Val Recall: 0.6783, Val AUC: 0.7378
  2%|█▊                                                                                 | 2/90 [00:01<01:17,  1.13it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:13,  1.15it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:11,  1.16it/s]
 10%|████████▎                                                                          | 9/90 [00:07<01:09,  1.16it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:07,  1.16it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:05,  1.16it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:04,  1.16it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:01,  1.16it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:58,  1.17it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.16it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:55,  1.16it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.16it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:25<00:51,  1.16it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:49,  1.16it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:47,  1.16it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:31<00:45,  1.16it/s]
 44%|████████████████████████████████████▍                                             | 40/90 [00:34<00:43,  1.15it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:41,  1.15it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:38<00:39,  1.15it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:38,  1.16it/s]
 54%|████████████████████████████████████████████▋                                     | 49/90 [00:42<00:35,  1.16it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:44<00:33,  1.16it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:45<00:31,  1.16it/s]
 62%|███████████████████████████████████████████████████                               | 56/90 [00:48<00:29,  1.15it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:50<00:27,  1.16it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:51<00:25,  1.16it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.15it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:56<00:21,  1.15it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:57<00:19,  1.15it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:00<00:17,  1.16it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:02<00:15,  1.15it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:03<00:13,  1.15it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.15it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.15it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:10<00:07,  1.16it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.16it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:16<00:01,  1.16it/s]
  7%|█████▉                                                                             | 2/28 [00:00<00:09,  2.61it/s]
  7%|█████▉                                                                             | 2/28 [00:00<00:09,  2.61it/s]
New threshold is 0.5036665797233582
train F1 is 0.8518189787864685
 25%|████████████████████▊                                                              | 7/28 [00:02<00:08,  2.54it/s]
 43%|███████████████████████████████████▏                                              | 12/28 [00:04<00:06,  2.53it/s]
 61%|█████████████████████████████████████████████████▊                                | 17/28 [00:06<00:04,  2.52it/s]
 79%|████████████████████████████████████████████████████████████████▍                 | 22/28 [00:08<00:02,  2.52it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.53it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.53it/s]
New threshold is 0.48572367429733276
val F1 is 0.6426229476928711
Epoch 85/100, learning rate: 8.207882714096908e-09
Train Loss: 0.3422, Train Acc: 0.8573, Train f1: 0.8518, Train Precision: 0.8664, Train Recall: 0.8377, Train AUC: 0.9330
Valitadion Loss: 0.6524, Validation Acc: 0.6981, Vall f1: 0.6426, Val Precision: 0.6049, Val Recall: 0.6853, Val AUC: 0.7379
  2%|█▊                                                                                 | 2/90 [00:01<01:17,  1.13it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:14,  1.16it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:12,  1.16it/s]
 10%|████████▎                                                                          | 9/90 [00:07<01:10,  1.15it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:08,  1.16it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:06,  1.16it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:03,  1.16it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:01,  1.16it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<01:00,  1.16it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.16it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:56,  1.16it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:54,  1.16it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:25<00:53,  1.15it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:50,  1.15it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.15it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:31<00:46,  1.15it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:44,  1.15it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.16it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:40,  1.15it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:38,  1.16it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:34,  1.16it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:45<00:31,  1.16it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.15it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.16it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:51<00:25,  1.16it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.16it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.15it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:57<00:20,  1.15it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.16it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.15it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:03<00:14,  1.15it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.15it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 78/90 [01:07<00:10,  1.16it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:09<00:08,  1.15it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:11<00:06,  1.15it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 85/90 [01:13<00:04,  1.16it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:15<00:02,  1.15it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
New threshold is 0.45779648423194885
train F1 is 0.8626086711883545
 18%|██████████████▊                                                                    | 5/28 [00:01<00:09,  2.54it/s]
 36%|█████████████████████████████▎                                                    | 10/28 [00:03<00:07,  2.49it/s]
 54%|███████████████████████████████████████████▉                                      | 15/28 [00:05<00:05,  2.50it/s]
 71%|██████████████████████████████████████████████████████████▌                       | 20/28 [00:07<00:03,  2.50it/s]
 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.51it/s]
  1%|▉                                                                                  | 1/90 [00:00<01:20,  1.11it/s]
  1%|▉                                                                                  | 1/90 [00:00<01:20,  1.11it/s]
New threshold is 0.48541152477264404
val F1 is 0.6426229476928711
Epoch 86/100, learning rate: 1.3148563806533674e-09
Train Loss: 0.3285, Train Acc: 0.8650, Train f1: 0.8626, Train Precision: 0.8596, Train Recall: 0.8656, Train AUC: 0.9413
Valitadion Loss: 0.6524, Validation Acc: 0.6981, Vall f1: 0.6426, Val Precision: 0.6049, Val Recall: 0.6853, Val AUC: 0.7378
  3%|██▊                                                                                | 3/90 [00:02<01:16,  1.14it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:14,  1.15it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:12,  1.15it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:09,  1.15it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:07,  1.16it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:05,  1.16it/s]
 19%|███████████████▍                                                                  | 17/90 [00:14<01:03,  1.16it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:01,  1.16it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.15it/s]
 27%|█████████████████████▊                                                            | 24/90 [00:20<00:57,  1.15it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:55,  1.14it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:55,  1.13it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:26<00:53,  1.12it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:50,  1.12it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:49,  1.12it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:32<00:47,  1.12it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:34<00:45,  1.11it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:43,  1.11it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:38<00:41,  1.12it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:40<00:39,  1.12it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:42<00:37,  1.12it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:44<00:35,  1.12it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:46<00:32,  1.12it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:48<00:31,  1.12it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:50<00:29,  1.12it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:52<00:27,  1.12it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:54<00:24,  1.12it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:56<00:23,  1.12it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:58<00:21,  1.12it/s]
 76%|█████████████████████████████████████████████████████████████▉                    | 68/90 [01:00<00:19,  1.12it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:02<00:17,  1.11it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:04<00:15,  1.12it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 75/90 [01:06<00:13,  1.11it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:08<00:11,  1.12it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:10<00:08,  1.12it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:12<00:07,  1.12it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:14<00:05,  1.12it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:16<00:03,  1.11it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:19<00:00,  1.11it/s]
  7%|█████▉                                                                             | 2/28 [00:00<00:10,  2.38it/s]
  7%|█████▉                                                                             | 2/28 [00:00<00:10,  2.38it/s]
New threshold is 0.5024451017379761
train F1 is 0.845470666885376
 25%|████████████████████▊                                                              | 7/28 [00:02<00:08,  2.36it/s]
 39%|████████████████████████████████▏                                                 | 11/28 [00:04<00:07,  2.32it/s]
 57%|██████████████████████████████████████████████▊                                   | 16/28 [00:06<00:05,  2.33it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 21/28 [00:09<00:03,  2.31it/s]
 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:10<00:01,  2.31it/s]
  1%|▉                                                                                  | 1/90 [00:00<01:20,  1.11it/s]
  1%|▉                                                                                  | 1/90 [00:00<01:20,  1.11it/s]
New threshold is 0.3970470428466797
val F1 is 0.6529411673545837
Epoch 87/100, learning rate: 3.999917875545951e-06
Train Loss: 0.3428, Train Acc: 0.8513, Train f1: 0.8455, Train Precision: 0.8608, Train Recall: 0.8307, Train AUC: 0.9346
Valitadion Loss: 0.6741, Validation Acc: 0.6731, Vall f1: 0.6529, Val Precision: 0.5635, Val Recall: 0.7762, Val AUC: 0.7208
  3%|██▊                                                                                | 3/90 [00:02<01:17,  1.12it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:15,  1.13it/s]
  9%|███████▍                                                                           | 8/90 [00:07<01:11,  1.15it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:09,  1.15it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:08,  1.15it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:06,  1.15it/s]
 19%|███████████████▍                                                                  | 17/90 [00:14<01:03,  1.15it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:02,  1.14it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<01:00,  1.15it/s]
 27%|█████████████████████▊                                                            | 24/90 [00:20<00:57,  1.15it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:55,  1.14it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.15it/s]
 34%|████████████████████████████▏                                                     | 31/90 [00:27<00:51,  1.14it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:49,  1.14it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:47,  1.15it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:32<00:46,  1.15it/s]
 44%|████████████████████████████████████▍                                             | 40/90 [00:34<00:43,  1.15it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:41,  1.15it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:38<00:39,  1.15it/s]
 52%|██████████████████████████████████████████▊                                       | 47/90 [00:41<00:37,  1.15it/s]
 54%|████████████████████████████████████████████▋                                     | 49/90 [00:42<00:35,  1.15it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:44<00:34,  1.15it/s]
 60%|█████████████████████████████████████████████████▏                                | 54/90 [00:47<00:31,  1.15it/s]
 62%|███████████████████████████████████████████████████                               | 56/90 [00:48<00:29,  1.15it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:50<00:27,  1.16it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:52<00:26,  1.15it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.14it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:56<00:21,  1.14it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:58<00:20,  1.15it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:01<00:17,  1.15it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:02<00:15,  1.15it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:04<00:13,  1.15it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:07<00:11,  1.15it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.16it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:10<00:07,  1.15it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:12<00:06,  1.15it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.15it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:16<00:01,  1.15it/s]
  7%|█████▉                                                                             | 2/28 [00:00<00:09,  2.63it/s]
  7%|█████▉                                                                             | 2/28 [00:00<00:09,  2.63it/s]
New threshold is 0.4853994846343994
train F1 is 0.8324697613716125
 25%|████████████████████▊                                                              | 7/28 [00:02<00:08,  2.55it/s]
 43%|███████████████████████████████████▏                                              | 12/28 [00:04<00:06,  2.51it/s]
 61%|█████████████████████████████████████████████████▊                                | 17/28 [00:06<00:04,  2.54it/s]
 79%|████████████████████████████████████████████████████████████████▍                 | 22/28 [00:08<00:02,  2.52it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.51it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.51it/s]
New threshold is 0.27379491925239563
val F1 is 0.6644737124443054
Epoch 88/100, learning rate: 3.998686143619347e-06
Train Loss: 0.3726, Train Acc: 0.8342, Train f1: 0.8325, Train Precision: 0.8239, Train Recall: 0.8412, Train AUC: 0.9184
Valitadion Loss: 0.6241, Validation Acc: 0.7175, Vall f1: 0.6645, Val Precision: 0.6273, Val Recall: 0.7063, Val AUC: 0.7463
  1%|▉                                                                                  | 1/90 [00:00<01:21,  1.09it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:14,  1.15it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:12,  1.15it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:11,  1.15it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:08,  1.16it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:06,  1.15it/s]
 17%|█████████████▋                                                                    | 15/90 [00:13<01:04,  1.16it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:01,  1.16it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<01:00,  1.16it/s]
 24%|████████████████████                                                              | 22/90 [00:19<00:58,  1.16it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:56,  1.16it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:54,  1.16it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:25<00:52,  1.16it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:50,  1.16it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.16it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:31<00:46,  1.16it/s]
 42%|██████████████████████████████████▌                                               | 38/90 [00:32<00:44,  1.16it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.15it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:40,  1.16it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:38<00:38,  1.16it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:34,  1.16it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:44<00:32,  1.16it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.16it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.16it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:51<00:26,  1.16it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.16it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.16it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:57<00:20,  1.15it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.15it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.16it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:03<00:14,  1.15it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.16it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 78/90 [01:07<00:10,  1.16it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:09<00:08,  1.16it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:11<00:06,  1.16it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 85/90 [01:13<00:04,  1.16it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:15<00:02,  1.15it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:16<00:00,  1.16it/s]
New threshold is 0.4740431010723114
train F1 is 0.834645688533783
 14%|███████████▊                                                                       | 4/28 [00:01<00:09,  2.55it/s]
 32%|██████████████████████████▋                                                        | 9/28 [00:03<00:07,  2.54it/s]
 54%|███████████████████████████████████████████▉                                      | 15/28 [00:05<00:05,  2.52it/s]
 71%|██████████████████████████████████████████████████████████▌                       | 20/28 [00:07<00:03,  2.49it/s]
 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.53it/s]
  1%|▉                                                                                  | 1/90 [00:00<01:20,  1.10it/s]
  1%|▉                                                                                  | 1/90 [00:00<01:20,  1.10it/s]
New threshold is 0.6311613917350769
val F1 is 0.6148648858070374
Epoch 89/100, learning rate: 3.995977223496612e-06
Train Loss: 0.3683, Train Acc: 0.8385, Train f1: 0.8346, Train Precision: 0.8368, Train Recall: 0.8325, Train AUC: 0.9175
Valitadion Loss: 0.6915, Validation Acc: 0.6842, Vall f1: 0.6149, Val Precision: 0.5948, Val Recall: 0.6364, Val AUC: 0.7255
  3%|██▊                                                                                | 3/90 [00:02<01:16,  1.14it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:14,  1.15it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:12,  1.15it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:08,  1.16it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:07,  1.16it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:05,  1.15it/s]
 19%|███████████████▍                                                                  | 17/90 [00:14<01:03,  1.16it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:02,  1.16it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.16it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.16it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:56,  1.16it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.16it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:26<00:51,  1.15it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:50,  1.15it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:47,  1.16it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:32<00:45,  1.16it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:43,  1.16it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:41,  1.15it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:38<00:39,  1.15it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:38,  1.15it/s]
 54%|████████████████████████████████████████████▋                                     | 49/90 [00:42<00:35,  1.15it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:44<00:33,  1.16it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:45<00:32,  1.16it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.15it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:50<00:27,  1.15it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:51<00:25,  1.16it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.16it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:56<00:21,  1.15it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:58<00:19,  1.16it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.15it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:02<00:15,  1.15it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:04<00:13,  1.16it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.16it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.16it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:10<00:07,  1.16it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:11<00:06,  1.16it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:16<00:01,  1.16it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:09,  2.71it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:09,  2.71it/s]
New threshold is 0.4930594563484192
train F1 is 0.8533801436424255
 21%|█████████████████▊                                                                 | 6/28 [00:02<00:08,  2.55it/s]
 39%|████████████████████████████████▏                                                 | 11/28 [00:04<00:06,  2.51it/s]
 57%|██████████████████████████████████████████████▊                                   | 16/28 [00:06<00:04,  2.50it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 21/28 [00:08<00:02,  2.50it/s]
 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.52it/s]
 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.52it/s]
New threshold is 0.39666447043418884
val F1 is 0.6428571343421936
Epoch 90/100, learning rate: 3.991793117285902e-06
Train Loss: 0.3628, Train Acc: 0.8573, Train f1: 0.8534, Train Precision: 0.8587, Train Recall: 0.8482, Train AUC: 0.9227
Valitadion Loss: 0.6234, Validation Acc: 0.6953, Vall f1: 0.6429, Val Precision: 0.6000, Val Recall: 0.6923, Val AUC: 0.7457
  1%|▉                                                                                  | 1/90 [00:00<01:19,  1.12it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:15,  1.14it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:12,  1.15it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:11,  1.15it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:09,  1.15it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:06,  1.15it/s]
 17%|█████████████▋                                                                    | 15/90 [00:13<01:05,  1.15it/s]
 19%|███████████████▍                                                                  | 17/90 [00:14<01:03,  1.16it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<01:00,  1.15it/s]
 24%|████████████████████                                                              | 22/90 [00:19<00:58,  1.16it/s]
 27%|█████████████████████▊                                                            | 24/90 [00:20<00:56,  1.16it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:54,  1.16it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:25<00:52,  1.16it/s]
 34%|████████████████████████████▏                                                     | 31/90 [00:26<00:50,  1.16it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.16it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:31<00:46,  1.16it/s]
 42%|██████████████████████████████████▌                                               | 38/90 [00:32<00:44,  1.16it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.16it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:40,  1.16it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:38<00:38,  1.16it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:34,  1.16it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:44<00:32,  1.16it/s]
 60%|█████████████████████████████████████████████████▏                                | 54/90 [00:46<00:31,  1.16it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.16it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:51<00:26,  1.16it/s]
 68%|███████████████████████████████████████████████████████▌                          | 61/90 [00:52<00:25,  1.16it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.15it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:57<00:20,  1.15it/s]
 76%|█████████████████████████████████████████████████████████████▉                    | 68/90 [00:58<00:19,  1.16it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.15it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:03<00:14,  1.15it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 75/90 [01:04<00:12,  1.15it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 78/90 [01:07<00:10,  1.15it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:09<00:08,  1.15it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:11<00:06,  1.16it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.15it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:15<00:02,  1.15it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:17<00:00,  1.15it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:17<00:00,  1.15it/s]
New threshold is 0.4490312933921814
train F1 is 0.8583840131759644
 14%|███████████▊                                                                       | 4/28 [00:01<00:09,  2.53it/s]
 32%|██████████████████████████▋                                                        | 9/28 [00:03<00:07,  2.54it/s]
 50%|█████████████████████████████████████████                                         | 14/28 [00:05<00:05,  2.51it/s]
 68%|███████████████████████████████████████████████████████▋                          | 19/28 [00:07<00:03,  2.51it/s]
 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.51it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.35822269320487976
val F1 is 0.6413792967796326
Epoch 91/100, learning rate: 3.986136917375624e-06
Train Loss: 0.3446, Train Acc: 0.8607, Train f1: 0.8584, Train Precision: 0.8547, Train Recall: 0.8621, Train AUC: 0.9323
Valitadion Loss: 0.6093, Validation Acc: 0.7119, Vall f1: 0.6414, Val Precision: 0.6327, Val Recall: 0.6503, Val AUC: 0.7536
  2%|█▊                                                                                 | 2/90 [00:01<01:18,  1.12it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:14,  1.15it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:11,  1.15it/s]
 10%|████████▎                                                                          | 9/90 [00:07<01:09,  1.16it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:07,  1.16it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:05,  1.16it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:03,  1.16it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:01,  1.16it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.16it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.16it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:55,  1.16it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:54,  1.14it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:26<00:52,  1.15it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:50,  1.15it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:48,  1.14it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:32<00:46,  1.15it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:44,  1.16it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:41,  1.15it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:38<00:39,  1.15it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:38,  1.15it/s]
 54%|████████████████████████████████████████████▋                                     | 49/90 [00:42<00:35,  1.16it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:44<00:33,  1.16it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:45<00:32,  1.15it/s]
 62%|███████████████████████████████████████████████████                               | 56/90 [00:48<00:29,  1.15it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:50<00:27,  1.15it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:52<00:25,  1.16it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.16it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:56<00:21,  1.15it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:58<00:19,  1.16it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.16it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:02<00:15,  1.16it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:04<00:13,  1.17it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.16it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.16it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:10<00:07,  1.16it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:11<00:06,  1.15it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:16<00:01,  1.16it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:09,  2.71it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:09,  2.71it/s]
New threshold is 0.5313563942909241
train F1 is 0.8384200930595398
 21%|█████████████████▊                                                                 | 6/28 [00:02<00:08,  2.55it/s]
 43%|███████████████████████████████████▏                                              | 12/28 [00:04<00:06,  2.53it/s]
 61%|█████████████████████████████████████████████████▊                                | 17/28 [00:06<00:04,  2.51it/s]
 79%|████████████████████████████████████████████████████████████████▍                 | 22/28 [00:08<00:02,  2.50it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.51it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.51it/s]
New threshold is 0.5296854376792908
val F1 is 0.6275861859321594
Epoch 92/100, learning rate: 3.979012804148902e-06
Train Loss: 0.3538, Train Acc: 0.8462, Train f1: 0.8384, Train Precision: 0.8632, Train Recall: 0.8150, Train AUC: 0.9268
Valitadion Loss: 0.6342, Validation Acc: 0.7008, Vall f1: 0.6276, Val Precision: 0.6190, Val Recall: 0.6364, Val AUC: 0.7466
  1%|▉                                                                                  | 1/90 [00:00<01:21,  1.09it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:15,  1.14it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:13,  1.15it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:10,  1.16it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:08,  1.16it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:06,  1.16it/s]
 17%|█████████████▋                                                                    | 15/90 [00:13<01:04,  1.16it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:02,  1.16it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<01:00,  1.16it/s]
 24%|████████████████████                                                              | 22/90 [00:19<00:58,  1.16it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:56,  1.16it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:54,  1.16it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:25<00:52,  1.16it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:49,  1.16it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.16it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:31<00:46,  1.17it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:44,  1.16it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.16it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:40,  1.16it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:38<00:39,  1.15it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:34,  1.16it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:44<00:32,  1.16it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.15it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.16it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:51<00:26,  1.16it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.16it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.16it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:57<00:20,  1.15it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.15it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.15it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:03<00:14,  1.15it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.15it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 78/90 [01:07<00:10,  1.15it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:09<00:08,  1.16it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:10<00:06,  1.16it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 85/90 [01:13<00:04,  1.15it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:15<00:02,  1.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:17<00:00,  1.15it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:17<00:00,  1.15it/s]
New threshold is 0.466917484998703
train F1 is 0.8554112315177917
 14%|███████████▊                                                                       | 4/28 [00:01<00:09,  2.52it/s]
 32%|██████████████████████████▋                                                        | 9/28 [00:03<00:07,  2.50it/s]
 50%|█████████████████████████████████████████                                         | 14/28 [00:05<00:05,  2.51it/s]
 68%|███████████████████████████████████████████████████████▋                          | 19/28 [00:07<00:03,  2.50it/s]
 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.53it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.6293833255767822
val F1 is 0.6643356680870056
Epoch 93/100, learning rate: 3.970426042893954e-06
Train Loss: 0.3538, Train Acc: 0.8573, Train f1: 0.8554, Train Precision: 0.8488, Train Recall: 0.8621, Train AUC: 0.9253
Valitadion Loss: 0.6282, Validation Acc: 0.7341, Vall f1: 0.6643, Val Precision: 0.6643, Val Recall: 0.6643, Val AUC: 0.7601
  3%|██▊                                                                                | 3/90 [00:02<01:16,  1.14it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:13,  1.15it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:12,  1.15it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:09,  1.16it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:07,  1.16it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:05,  1.16it/s]
 19%|███████████████▍                                                                  | 17/90 [00:14<01:02,  1.16it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:01,  1.16it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.16it/s]
 27%|█████████████████████▊                                                            | 24/90 [00:20<00:56,  1.16it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:55,  1.16it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.16it/s]
 34%|████████████████████████████▏                                                     | 31/90 [00:26<00:51,  1.15it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:49,  1.16it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:47,  1.15it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:32<00:46,  1.15it/s]
 44%|████████████████████████████████████▍                                             | 40/90 [00:34<00:43,  1.15it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:41,  1.15it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:38<00:39,  1.15it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:38,  1.15it/s]
 54%|████████████████████████████████████████████▋                                     | 49/90 [00:42<00:35,  1.15it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:44<00:33,  1.15it/s]
 60%|█████████████████████████████████████████████████▏                                | 54/90 [00:46<00:31,  1.15it/s]
 62%|███████████████████████████████████████████████████                               | 56/90 [00:48<00:29,  1.15it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:50<00:27,  1.15it/s]
 68%|███████████████████████████████████████████████████████▌                          | 61/90 [00:52<00:25,  1.16it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.15it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:56<00:21,  1.15it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:58<00:20,  1.14it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:00<00:17,  1.15it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:02<00:15,  1.15it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:04<00:13,  1.15it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.16it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.15it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:10<00:07,  1.15it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.15it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:16<00:01,  1.15it/s]
  7%|█████▉                                                                             | 2/28 [00:00<00:09,  2.66it/s]
  7%|█████▉                                                                             | 2/28 [00:00<00:09,  2.66it/s]
New threshold is 0.46641287207603455
train F1 is 0.8591065406799316
 25%|████████████████████▊                                                              | 7/28 [00:02<00:08,  2.51it/s]
 43%|███████████████████████████████████▏                                              | 12/28 [00:04<00:06,  2.50it/s]
 61%|█████████████████████████████████████████████████▊                                | 17/28 [00:06<00:04,  2.50it/s]
 79%|████████████████████████████████████████████████████████████████▍                 | 22/28 [00:08<00:02,  2.50it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.51it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.51it/s]
New threshold is 0.4488431215286255
val F1 is 0.6601307392120361
Epoch 94/100, learning rate: 3.960382979912614e-06
Train Loss: 0.3390, Train Acc: 0.8598, Train f1: 0.8591, Train Precision: 0.8460, Train Recall: 0.8726, Train AUC: 0.9330
Valitadion Loss: 0.6398, Validation Acc: 0.7119, Vall f1: 0.6601, Val Precision: 0.6196, Val Recall: 0.7063, Val AUC: 0.7465
  1%|▉                                                                                  | 1/90 [00:00<01:20,  1.11it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:15,  1.14it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:13,  1.15it/s]
  9%|███████▍                                                                           | 8/90 [00:06<01:11,  1.15it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:08,  1.15it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:06,  1.15it/s]
 17%|█████████████▋                                                                    | 15/90 [00:13<01:04,  1.15it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:02,  1.16it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<01:01,  1.15it/s]
 24%|████████████████████                                                              | 22/90 [00:19<00:58,  1.15it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:56,  1.15it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:54,  1.16it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:25<00:52,  1.15it/s]
 34%|████████████████████████████▏                                                     | 31/90 [00:26<00:50,  1.16it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.15it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:31<00:46,  1.16it/s]
 42%|██████████████████████████████████▌                                               | 38/90 [00:33<00:45,  1.15it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.16it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:40,  1.16it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:39<00:38,  1.16it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.15it/s]
 56%|█████████████████████████████████████████████▌                                    | 50/90 [00:43<00:34,  1.16it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:45<00:32,  1.16it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.16it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.16it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:51<00:26,  1.16it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.16it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.16it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:57<00:20,  1.15it/s]
 76%|█████████████████████████████████████████████████████████████▉                    | 68/90 [00:58<00:19,  1.15it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.15it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:03<00:14,  1.15it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 75/90 [01:05<00:13,  1.14it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 78/90 [01:07<00:10,  1.15it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:09<00:08,  1.15it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:11<00:06,  1.15it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 85/90 [01:13<00:04,  1.15it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:15<00:02,  1.15it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:17<00:00,  1.15it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:17<00:00,  1.15it/s]
New threshold is 0.4587547779083252
train F1 is 0.8687391877174377
 14%|███████████▊                                                                       | 4/28 [00:01<00:09,  2.54it/s]
 32%|██████████████████████████▋                                                        | 9/28 [00:03<00:07,  2.51it/s]
 50%|█████████████████████████████████████████                                         | 14/28 [00:05<00:05,  2.50it/s]
 68%|███████████████████████████████████████████████████████▋                          | 19/28 [00:07<00:03,  2.50it/s]
 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.51it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.25535300374031067
val F1 is 0.6447368264198303
Epoch 95/100, learning rate: 3.948891037829915e-06
Train Loss: 0.3271, Train Acc: 0.8701, Train f1: 0.8687, Train Precision: 0.8598, Train Recall: 0.8778, Train AUC: 0.9390
Valitadion Loss: 0.6483, Validation Acc: 0.7008, Vall f1: 0.6447, Val Precision: 0.6087, Val Recall: 0.6853, Val AUC: 0.7513
  2%|█▊                                                                                 | 2/90 [00:01<01:18,  1.13it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:13,  1.15it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:12,  1.15it/s]
 10%|████████▎                                                                          | 9/90 [00:07<01:10,  1.15it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:07,  1.16it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:05,  1.16it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:04,  1.15it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:01,  1.16it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.16it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.16it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:55,  1.16it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.15it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:26<00:51,  1.16it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:49,  1.15it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:47,  1.15it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:32<00:46,  1.15it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:44,  1.15it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:41,  1.16it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:38<00:39,  1.16it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:38,  1.15it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.15it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:44<00:33,  1.15it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:45<00:32,  1.15it/s]
 62%|███████████████████████████████████████████████████                               | 56/90 [00:48<00:29,  1.15it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:50<00:27,  1.15it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:52<00:26,  1.15it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.15it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:56<00:21,  1.16it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:58<00:19,  1.15it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.15it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:02<00:15,  1.15it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:04<00:13,  1.15it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:05<00:12,  1.15it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.15it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:10<00:07,  1.15it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:12<00:06,  1.15it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:16<00:01,  1.16it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:09,  2.75it/s]
  4%|██▉                                                                                | 1/28 [00:00<00:09,  2.75it/s]
New threshold is 0.4537633955478668
train F1 is 0.8541666865348816
 21%|█████████████████▊                                                                 | 6/28 [00:02<00:08,  2.51it/s]
 39%|████████████████████████████████▏                                                 | 11/28 [00:04<00:06,  2.47it/s]
 57%|██████████████████████████████████████████████▊                                   | 16/28 [00:06<00:04,  2.47it/s]
 75%|█████████████████████████████████████████████████████████████▌                    | 21/28 [00:08<00:02,  2.48it/s]
 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.49it/s]
 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.49it/s]
New threshold is 0.7268293499946594
val F1 is 0.6315789222717285
Epoch 96/100, learning rate: 3.935958710108172e-06
Train Loss: 0.3389, Train Acc: 0.8564, Train f1: 0.8542, Train Precision: 0.8497, Train Recall: 0.8586, Train AUC: 0.9316
Valitadion Loss: 0.7599, Validation Acc: 0.6898, Vall f1: 0.6316, Val Precision: 0.5963, Val Recall: 0.6713, Val AUC: 0.7474
  1%|▉                                                                                  | 1/90 [00:00<01:21,  1.09it/s]
  3%|██▊                                                                                | 3/90 [00:02<01:17,  1.13it/s]
  7%|█████▌                                                                             | 6/90 [00:05<01:13,  1.14it/s]
  9%|███████▍                                                                           | 8/90 [00:07<01:11,  1.15it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:09,  1.15it/s]
 14%|███████████▊                                                                      | 13/90 [00:11<01:06,  1.15it/s]
 17%|█████████████▋                                                                    | 15/90 [00:13<01:05,  1.15it/s]
 19%|███████████████▍                                                                  | 17/90 [00:14<01:03,  1.15it/s]
 22%|██████████████████▏                                                               | 20/90 [00:17<01:00,  1.16it/s]
 24%|████████████████████                                                              | 22/90 [00:19<00:58,  1.15it/s]
 27%|█████████████████████▊                                                            | 24/90 [00:20<00:57,  1.15it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:54,  1.15it/s]
 32%|██████████████████████████▍                                                       | 29/90 [00:25<00:52,  1.16it/s]
 34%|████████████████████████████▏                                                     | 31/90 [00:26<00:51,  1.15it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:49,  1.15it/s]
 40%|████████████████████████████████▊                                                 | 36/90 [00:31<00:46,  1.15it/s]
 42%|██████████████████████████████████▌                                               | 38/90 [00:33<00:45,  1.15it/s]
 44%|████████████████████████████████████▍                                             | 40/90 [00:34<00:43,  1.15it/s]
 48%|███████████████████████████████████████▏                                          | 43/90 [00:37<00:40,  1.16it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:39<00:38,  1.16it/s]
 52%|██████████████████████████████████████████▊                                       | 47/90 [00:40<00:37,  1.15it/s]
 54%|████████████████████████████████████████████▋                                     | 49/90 [00:42<00:35,  1.15it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:45<00:32,  1.15it/s]
 60%|█████████████████████████████████████████████████▏                                | 54/90 [00:46<00:31,  1.15it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.16it/s]
 66%|█████████████████████████████████████████████████████▊                            | 59/90 [00:51<00:26,  1.16it/s]
 68%|███████████████████████████████████████████████████████▌                          | 61/90 [00:52<00:25,  1.16it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.16it/s]
 73%|████████████████████████████████████████████████████████████▏                     | 66/90 [00:57<00:20,  1.16it/s]
 76%|█████████████████████████████████████████████████████████████▉                    | 68/90 [00:58<00:19,  1.15it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:00<00:17,  1.15it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:03<00:14,  1.15it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 75/90 [01:05<00:13,  1.15it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.15it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:09<00:08,  1.15it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:11<00:06,  1.15it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.15it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:15<00:02,  1.15it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:17<00:00,  1.16it/s]
 11%|████████▉                                                                          | 3/28 [00:01<00:09,  2.58it/s]
 11%|████████▉                                                                          | 3/28 [00:01<00:09,  2.58it/s]
New threshold is 0.4673013985157013
train F1 is 0.8669527769088745
 29%|███████████████████████▋                                                           | 8/28 [00:03<00:08,  2.47it/s]
 46%|██████████████████████████████████████                                            | 13/28 [00:05<00:06,  2.48it/s]
 64%|████████████████████████████████████████████████████▋                             | 18/28 [00:07<00:04,  2.48it/s]
 82%|███████████████████████████████████████████████████████████████████▎              | 23/28 [00:09<00:01,  2.51it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.6715266108512878
val F1 is 0.6363636255264282
Epoch 97/100, learning rate: 3.921595554769639e-06
Train Loss: 0.3118, Train Acc: 0.8675, Train f1: 0.8670, Train Precision: 0.8530, Train Recall: 0.8813, Train AUC: 0.9447
Valitadion Loss: 0.7206, Validation Acc: 0.6898, Vall f1: 0.6364, Val Precision: 0.5939, Val Recall: 0.6853, Val AUC: 0.7543
  2%|█▊                                                                                 | 2/90 [00:01<01:18,  1.12it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:15,  1.15it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:11,  1.16it/s]
 10%|████████▎                                                                          | 9/90 [00:07<01:10,  1.15it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:08,  1.15it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:06,  1.15it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:04,  1.16it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:02,  1.15it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.16it/s]
 26%|████████████████████▉                                                             | 23/90 [00:19<00:57,  1.16it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:56,  1.15it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:54,  1.15it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:26<00:52,  1.15it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:50,  1.15it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.15it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:32<00:46,  1.14it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:44,  1.15it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.15it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:38<00:39,  1.15it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:39<00:38,  1.16it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.15it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:44<00:34,  1.15it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:46<00:32,  1.14it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.14it/s]
 63%|███████████████████████████████████████████████████▉                              | 57/90 [00:49<00:28,  1.15it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:52<00:26,  1.15it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.15it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.15it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:58<00:20,  1.15it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [01:00<00:18,  1.15it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.15it/s]
 81%|██████████████████████████████████████████████████████████████████▌               | 73/90 [01:03<00:14,  1.15it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 75/90 [01:05<00:13,  1.15it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 78/90 [01:07<00:10,  1.15it/s]
 89%|████████████████████████████████████████████████████████████████████████▉         | 80/90 [01:09<00:08,  1.15it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:11<00:06,  1.15it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:13<00:05,  1.15it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:15<00:02,  1.14it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:17<00:00,  1.15it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:17<00:00,  1.15it/s]
New threshold is 0.44908246397972107
train F1 is 0.8539130687713623
 11%|████████▉                                                                          | 3/28 [00:01<00:09,  2.54it/s]
 29%|███████████████████████▋                                                           | 8/28 [00:03<00:08,  2.47it/s]
 46%|██████████████████████████████████████                                            | 13/28 [00:05<00:06,  2.48it/s]
 64%|████████████████████████████████████████████████████▋                             | 18/28 [00:07<00:04,  2.48it/s]
 82%|███████████████████████████████████████████████████████████████████▎              | 23/28 [00:09<00:02,  2.48it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
  0%|                                                                                           | 0/90 [00:00<?, ?it/s]
New threshold is 0.6367222666740417
val F1 is 0.6392405033111572
Epoch 98/100, learning rate: 3.905812187332365e-06
Train Loss: 0.3334, Train Acc: 0.8564, Train f1: 0.8539, Train Precision: 0.8510, Train Recall: 0.8569, Train AUC: 0.9334
Valitadion Loss: 0.7180, Validation Acc: 0.6842, Vall f1: 0.6392, Val Precision: 0.5838, Val Recall: 0.7063, Val AUC: 0.7468
  2%|█▊                                                                                 | 2/90 [00:01<01:18,  1.12it/s]
  4%|███▋                                                                               | 4/90 [00:03<01:15,  1.14it/s]
  8%|██████▍                                                                            | 7/90 [00:06<01:12,  1.14it/s]
 10%|████████▎                                                                          | 9/90 [00:07<01:10,  1.15it/s]
 12%|██████████                                                                        | 11/90 [00:09<01:08,  1.15it/s]
 16%|████████████▊                                                                     | 14/90 [00:12<01:06,  1.15it/s]
 18%|██████████████▌                                                                   | 16/90 [00:13<01:04,  1.15it/s]
 20%|████████████████▍                                                                 | 18/90 [00:15<01:02,  1.15it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<01:00,  1.14it/s]
 26%|████████████████████▉                                                             | 23/90 [00:20<00:58,  1.15it/s]
 28%|██████████████████████▊                                                           | 25/90 [00:21<00:56,  1.15it/s]
 30%|████████████████████████▌                                                         | 27/90 [00:23<00:54,  1.15it/s]
 33%|███████████████████████████▎                                                      | 30/90 [00:26<00:52,  1.15it/s]
 36%|█████████████████████████████▏                                                    | 32/90 [00:27<00:50,  1.15it/s]
 38%|██████████████████████████████▉                                                   | 34/90 [00:29<00:48,  1.15it/s]
 41%|█████████████████████████████████▋                                                | 37/90 [00:32<00:45,  1.15it/s]
 43%|███████████████████████████████████▌                                              | 39/90 [00:33<00:44,  1.15it/s]
 46%|█████████████████████████████████████▎                                            | 41/90 [00:35<00:42,  1.16it/s]
 49%|████████████████████████████████████████                                          | 44/90 [00:38<00:39,  1.15it/s]
 51%|█████████████████████████████████████████▉                                        | 46/90 [00:40<00:38,  1.16it/s]
 53%|███████████████████████████████████████████▋                                      | 48/90 [00:41<00:36,  1.16it/s]
 57%|██████████████████████████████████████████████▍                                   | 51/90 [00:44<00:33,  1.15it/s]
 59%|████████████████████████████████████████████████▎                                 | 53/90 [00:46<00:32,  1.15it/s]
 61%|██████████████████████████████████████████████████                                | 55/90 [00:47<00:30,  1.16it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:50<00:27,  1.15it/s]
 67%|██████████████████████████████████████████████████████▋                           | 60/90 [00:52<00:25,  1.16it/s]
 69%|████████████████████████████████████████████████████████▍                         | 62/90 [00:53<00:24,  1.16it/s]
 71%|██████████████████████████████████████████████████████████▎                       | 64/90 [00:55<00:22,  1.16it/s]
 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:58<00:19,  1.15it/s]
 77%|██████████████████████████████████████████████████████████████▊                   | 69/90 [00:59<00:18,  1.15it/s]
 79%|████████████████████████████████████████████████████████████████▋                 | 71/90 [01:01<00:16,  1.16it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 74/90 [01:04<00:13,  1.15it/s]
 84%|█████████████████████████████████████████████████████████████████████▏            | 76/90 [01:06<00:12,  1.15it/s]
 87%|███████████████████████████████████████████████████████████████████████           | 78/90 [01:07<00:10,  1.15it/s]
 90%|█████████████████████████████████████████████████████████████████████████▊        | 81/90 [01:10<00:07,  1.15it/s]
 92%|███████████████████████████████████████████████████████████████████████████▌      | 83/90 [01:12<00:06,  1.14it/s]
 94%|█████████████████████████████████████████████████████████████████████████████▍    | 85/90 [01:13<00:04,  1.15it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:15<00:02,  1.15it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
New threshold is 0.4820134937763214
train F1 is 0.8729472756385803
 18%|██████████████▊                                                                    | 5/28 [00:01<00:09,  2.50it/s]
 36%|█████████████████████████████▎                                                    | 10/28 [00:03<00:07,  2.52it/s]
 54%|███████████████████████████████████████████▉                                      | 15/28 [00:06<00:05,  2.48it/s]
 71%|██████████████████████████████████████████████████████████▌                       | 20/28 [00:08<00:03,  2.50it/s]
 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.52it/s]
 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.52it/s]
New threshold is 0.31793442368507385
val F1 is 0.653333306312561
Epoch 99/100, learning rate: 3.88862027296448e-06
Train Loss: 0.3125, Train Acc: 0.8744, Train f1: 0.8729, Train Precision: 0.8647, Train Recall: 0.8813, Train AUC: 0.9440
Valitadion Loss: 0.6471, Validation Acc: 0.7119, Vall f1: 0.6533, Val Precision: 0.6242, Val Recall: 0.6853, Val AUC: 0.7544
  1%|▉                                                                                  | 1/90 [00:00<01:21,  1.09it/s]
  3%|██▊                                                                                | 3/90 [00:02<01:17,  1.13it/s]
  6%|████▌                                                                              | 5/90 [00:04<01:14,  1.14it/s]
  9%|███████▍                                                                           | 8/90 [00:07<01:11,  1.15it/s]
 11%|█████████                                                                         | 10/90 [00:08<01:09,  1.16it/s]
 13%|██████████▉                                                                       | 12/90 [00:10<01:07,  1.16it/s]
 17%|█████████████▋                                                                    | 15/90 [00:13<01:05,  1.15it/s]
 19%|███████████████▍                                                                  | 17/90 [00:14<01:03,  1.15it/s]
 21%|█████████████████▎                                                                | 19/90 [00:16<01:01,  1.15it/s]
 23%|███████████████████▏                                                              | 21/90 [00:18<00:59,  1.15it/s]
 27%|█████████████████████▊                                                            | 24/90 [00:20<00:57,  1.16it/s]
 29%|███████████████████████▋                                                          | 26/90 [00:22<00:55,  1.16it/s]
 31%|█████████████████████████▌                                                        | 28/90 [00:24<00:53,  1.16it/s]
 34%|████████████████████████████▏                                                     | 31/90 [00:26<00:51,  1.15it/s]
 37%|██████████████████████████████                                                    | 33/90 [00:28<00:49,  1.15it/s]
 39%|███████████████████████████████▉                                                  | 35/90 [00:30<00:47,  1.16it/s]
 42%|██████████████████████████████████▌                                               | 38/90 [00:32<00:45,  1.15it/s]
 44%|████████████████████████████████████▍                                             | 40/90 [00:34<00:43,  1.15it/s]
 47%|██████████████████████████████████████▎                                           | 42/90 [00:36<00:41,  1.15it/s]
 50%|█████████████████████████████████████████                                         | 45/90 [00:39<00:39,  1.15it/s]
 52%|██████████████████████████████████████████▊                                       | 47/90 [00:40<00:37,  1.15it/s]
 54%|████████████████████████████████████████████▋                                     | 49/90 [00:42<00:35,  1.15it/s]
 58%|███████████████████████████████████████████████▍                                  | 52/90 [00:45<00:32,  1.16it/s]
 60%|█████████████████████████████████████████████████▏                                | 54/90 [00:46<00:31,  1.16it/s]
 62%|███████████████████████████████████████████████████                               | 56/90 [00:48<00:29,  1.15it/s]
 64%|████████████████████████████████████████████████████▊                             | 58/90 [00:50<00:27,  1.15it/s]
 68%|███████████████████████████████████████████████████████▌                          | 61/90 [00:52<00:25,  1.15it/s]
 70%|█████████████████████████████████████████████████████████▍                        | 63/90 [00:54<00:23,  1.15it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 65/90 [00:56<00:21,  1.15it/s]
 76%|█████████████████████████████████████████████████████████████▉                    | 68/90 [00:59<00:19,  1.15it/s]
 78%|███████████████████████████████████████████████████████████████▊                  | 70/90 [01:00<00:17,  1.16it/s]
 80%|█████████████████████████████████████████████████████████████████▌                | 72/90 [01:02<00:15,  1.15it/s]
 83%|████████████████████████████████████████████████████████████████████▎             | 75/90 [01:05<00:12,  1.16it/s]
 86%|██████████████████████████████████████████████████████████████████████▏           | 77/90 [01:06<00:11,  1.15it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 79/90 [01:08<00:09,  1.16it/s]
 91%|██████████████████████████████████████████████████████████████████████████▋       | 82/90 [01:11<00:06,  1.15it/s]
 93%|████████████████████████████████████████████████████████████████████████████▌     | 84/90 [01:12<00:05,  1.16it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▎   | 86/90 [01:14<00:03,  1.16it/s]
 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:16<00:01,  1.16it/s]
  7%|█████▉                                                                             | 2/28 [00:00<00:09,  2.61it/s]
  7%|█████▉                                                                             | 2/28 [00:00<00:09,  2.61it/s]
New threshold is 0.4716990292072296
train F1 is 0.8846487402915955
 25%|████████████████████▊                                                              | 7/28 [00:02<00:08,  2.52it/s]
 43%|███████████████████████████████████▏                                              | 12/28 [00:04<00:06,  2.51it/s]
 61%|█████████████████████████████████████████████████▊                                | 17/28 [00:06<00:04,  2.52it/s]
 79%|████████████████████████████████████████████████████████████████▍                 | 22/28 [00:08<00:02,  2.52it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
New threshold is 0.3061436414718628
val F1 is 0.6646341681480408
Epoch 100/100, learning rate: 3.8700325178627085e-06
Train Loss: 0.2818, Train Acc: 0.8863, Train f1: 0.8846, Train Precision: 0.8793, Train Recall: 0.8901, Train AUC: 0.9565
Valitadion Loss: 0.6722, Validation Acc: 0.6953, Vall f1: 0.6646, Val Precision: 0.5892, Val Recall: 0.7622, Val AUC: 0.7440
Training complete in 147m 37s
Best val auc: 0.672897
  7%|█████▉                                                                             | 2/28 [00:03<00:44,  1.70s/it]
 25%|████████████████████▊                                                              | 7/28 [00:05<00:10,  1.95it/s]
 43%|███████████████████████████████████▏                                              | 12/28 [00:07<00:06,  2.44it/s]
 61%|█████████████████████████████████████████████████▊                                | 17/28 [00:09<00:04,  2.56it/s]
 79%|████████████████████████████████████████████████████████████████▍                 | 22/28 [00:11<00:02,  2.55it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:13<00:00,  2.54it/s]
 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:13<00:00,  2.54it/s]
New threshold is 0.3061436414718628
Inference complete in 0m 14s
F1 Score = : 0.664634
AUC Score = : 0.743985
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:14<00:00,  1.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:14<00:00,  1.99it/s]