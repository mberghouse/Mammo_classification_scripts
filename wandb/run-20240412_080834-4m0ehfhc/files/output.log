
  1%|▉                                                                                  | 1/84 [00:01<01:30,  1.09s/it]
stem.conv.weight
stem.conv.bias
stem.norm.weight
stem.norm.bias
stages.0.blocks.0.0.cpe1.proj.weight
stages.0.blocks.0.0.cpe1.proj.bias
stages.0.blocks.0.0.norm1.weight
stages.0.blocks.0.0.norm1.bias
stages.0.blocks.0.0.attn.qkv.weight
stages.0.blocks.0.0.attn.qkv.bias
stages.0.blocks.0.0.attn.proj.weight
stages.0.blocks.0.0.attn.proj.bias
stages.0.blocks.0.0.cpe2.proj.weight
stages.0.blocks.0.0.cpe2.proj.bias
stages.0.blocks.0.0.norm2.weight
stages.0.blocks.0.0.norm2.bias
stages.0.blocks.0.0.mlp.fc1.weight
stages.0.blocks.0.0.mlp.fc1.bias
stages.0.blocks.0.0.mlp.fc2.weight
stages.0.blocks.0.0.mlp.fc2.bias
stages.0.blocks.0.1.cpe1.proj.weight
stages.0.blocks.0.1.cpe1.proj.bias
stages.0.blocks.0.1.norm1.weight
stages.0.blocks.0.1.norm1.bias
stages.0.blocks.0.1.attn.qkv.weight
stages.0.blocks.0.1.attn.qkv.bias
stages.0.blocks.0.1.attn.proj.weight
stages.0.blocks.0.1.attn.proj.bias
stages.0.blocks.0.1.cpe2.proj.weight
stages.0.blocks.0.1.cpe2.proj.bias
stages.0.blocks.0.1.norm2.weight
stages.0.blocks.0.1.norm2.bias
stages.0.blocks.0.1.mlp.fc1.weight
stages.0.blocks.0.1.mlp.fc1.bias
stages.0.blocks.0.1.mlp.fc2.weight
stages.0.blocks.0.1.mlp.fc2.bias
stages.1.downsample.norm.weight
stages.1.downsample.norm.bias
stages.1.downsample.conv.weight
stages.1.downsample.conv.bias
stages.1.blocks.0.0.cpe1.proj.weight
stages.1.blocks.0.0.cpe1.proj.bias
stages.1.blocks.0.0.norm1.weight
stages.1.blocks.0.0.norm1.bias
stages.1.blocks.0.0.attn.qkv.weight
stages.1.blocks.0.0.attn.qkv.bias
stages.1.blocks.0.0.attn.proj.weight
stages.1.blocks.0.0.attn.proj.bias
stages.1.blocks.0.0.cpe2.proj.weight
stages.1.blocks.0.0.cpe2.proj.bias
stages.1.blocks.0.0.norm2.weight
stages.1.blocks.0.0.norm2.bias
stages.1.blocks.0.0.mlp.fc1.weight
stages.1.blocks.0.0.mlp.fc1.bias
stages.1.blocks.0.0.mlp.fc2.weight
stages.1.blocks.0.0.mlp.fc2.bias
stages.1.blocks.0.1.cpe1.proj.weight
stages.1.blocks.0.1.cpe1.proj.bias
stages.1.blocks.0.1.norm1.weight
stages.1.blocks.0.1.norm1.bias
stages.1.blocks.0.1.attn.qkv.weight
stages.1.blocks.0.1.attn.qkv.bias
stages.1.blocks.0.1.attn.proj.weight
stages.1.blocks.0.1.attn.proj.bias
stages.1.blocks.0.1.cpe2.proj.weight
stages.1.blocks.0.1.cpe2.proj.bias
stages.1.blocks.0.1.norm2.weight
stages.1.blocks.0.1.norm2.bias
stages.1.blocks.0.1.mlp.fc1.weight
stages.1.blocks.0.1.mlp.fc1.bias
stages.1.blocks.0.1.mlp.fc2.weight
stages.1.blocks.0.1.mlp.fc2.bias
stages.2.downsample.norm.weight
stages.2.downsample.norm.bias
stages.2.downsample.conv.weight
stages.2.downsample.conv.bias
stages.2.blocks.0.0.cpe1.proj.weight
stages.2.blocks.0.0.cpe1.proj.bias
stages.2.blocks.0.0.norm1.weight
stages.2.blocks.0.0.norm1.bias
stages.2.blocks.0.0.attn.qkv.weight
stages.2.blocks.0.0.attn.qkv.bias
stages.2.blocks.0.0.attn.proj.weight
stages.2.blocks.0.0.attn.proj.bias
stages.2.blocks.0.0.cpe2.proj.weight
stages.2.blocks.0.0.cpe2.proj.bias
stages.2.blocks.0.0.norm2.weight
stages.2.blocks.0.0.norm2.bias
stages.2.blocks.0.0.mlp.fc1.weight
stages.2.blocks.0.0.mlp.fc1.bias
stages.2.blocks.0.0.mlp.fc2.weight
stages.2.blocks.0.0.mlp.fc2.bias
stages.2.blocks.0.1.cpe1.proj.weight
stages.2.blocks.0.1.cpe1.proj.bias
stages.2.blocks.0.1.norm1.weight
stages.2.blocks.0.1.norm1.bias
stages.2.blocks.0.1.attn.qkv.weight
stages.2.blocks.0.1.attn.qkv.bias
stages.2.blocks.0.1.attn.proj.weight
stages.2.blocks.0.1.attn.proj.bias
stages.2.blocks.0.1.cpe2.proj.weight
stages.2.blocks.0.1.cpe2.proj.bias
stages.2.blocks.0.1.norm2.weight
stages.2.blocks.0.1.norm2.bias
stages.2.blocks.0.1.mlp.fc1.weight
stages.2.blocks.0.1.mlp.fc1.bias
stages.2.blocks.0.1.mlp.fc2.weight
stages.2.blocks.0.1.mlp.fc2.bias
stages.2.blocks.1.0.cpe1.proj.weight
stages.2.blocks.1.0.cpe1.proj.bias
stages.2.blocks.1.0.norm1.weight
stages.2.blocks.1.0.norm1.bias
stages.2.blocks.1.0.attn.qkv.weight
stages.2.blocks.1.0.attn.qkv.bias
stages.2.blocks.1.0.attn.proj.weight
stages.2.blocks.1.0.attn.proj.bias
stages.2.blocks.1.0.cpe2.proj.weight
stages.2.blocks.1.0.cpe2.proj.bias
stages.2.blocks.1.0.norm2.weight
stages.2.blocks.1.0.norm2.bias
stages.2.blocks.1.0.mlp.fc1.weight
stages.2.blocks.1.0.mlp.fc1.bias
stages.2.blocks.1.0.mlp.fc2.weight
stages.2.blocks.1.0.mlp.fc2.bias
stages.2.blocks.1.1.cpe1.proj.weight
stages.2.blocks.1.1.cpe1.proj.bias
stages.2.blocks.1.1.norm1.weight
stages.2.blocks.1.1.norm1.bias
stages.2.blocks.1.1.attn.qkv.weight
stages.2.blocks.1.1.attn.qkv.bias
stages.2.blocks.1.1.attn.proj.weight
stages.2.blocks.1.1.attn.proj.bias
stages.2.blocks.1.1.cpe2.proj.weight
stages.2.blocks.1.1.cpe2.proj.bias
stages.2.blocks.1.1.norm2.weight
stages.2.blocks.1.1.norm2.bias
stages.2.blocks.1.1.mlp.fc1.weight
stages.2.blocks.1.1.mlp.fc1.bias
stages.2.blocks.1.1.mlp.fc2.weight
stages.2.blocks.1.1.mlp.fc2.bias
stages.2.blocks.2.0.cpe1.proj.weight
stages.2.blocks.2.0.cpe1.proj.bias
stages.2.blocks.2.0.norm1.weight
stages.2.blocks.2.0.norm1.bias
stages.2.blocks.2.0.attn.qkv.weight
stages.2.blocks.2.0.attn.qkv.bias
stages.2.blocks.2.0.attn.proj.weight
stages.2.blocks.2.0.attn.proj.bias
stages.2.blocks.2.0.cpe2.proj.weight
stages.2.blocks.2.0.cpe2.proj.bias
stages.2.blocks.2.0.norm2.weight
stages.2.blocks.2.0.norm2.bias
stages.2.blocks.2.0.mlp.fc1.weight
stages.2.blocks.2.0.mlp.fc1.bias
stages.2.blocks.2.0.mlp.fc2.weight
stages.2.blocks.2.0.mlp.fc2.bias
stages.2.blocks.2.1.cpe1.proj.weight
stages.2.blocks.2.1.cpe1.proj.bias
stages.2.blocks.2.1.norm1.weight
stages.2.blocks.2.1.norm1.bias
stages.2.blocks.2.1.attn.qkv.weight
stages.2.blocks.2.1.attn.qkv.bias
stages.2.blocks.2.1.attn.proj.weight
stages.2.blocks.2.1.attn.proj.bias
stages.2.blocks.2.1.cpe2.proj.weight
stages.2.blocks.2.1.cpe2.proj.bias
stages.2.blocks.2.1.norm2.weight
stages.2.blocks.2.1.norm2.bias
stages.2.blocks.2.1.mlp.fc1.weight
stages.2.blocks.2.1.mlp.fc1.bias
stages.2.blocks.2.1.mlp.fc2.weight
stages.2.blocks.2.1.mlp.fc2.bias
stages.3.downsample.norm.weight
stages.3.downsample.norm.bias
stages.3.downsample.conv.weight
stages.3.downsample.conv.bias
stages.3.blocks.0.0.cpe1.proj.weight
stages.3.blocks.0.0.cpe1.proj.bias
stages.3.blocks.0.0.norm1.weight
stages.3.blocks.0.0.norm1.bias
stages.3.blocks.0.0.attn.qkv.weight
stages.3.blocks.0.0.attn.qkv.bias
stages.3.blocks.0.0.attn.proj.weight
stages.3.blocks.0.0.attn.proj.bias
stages.3.blocks.0.0.cpe2.proj.weight
stages.3.blocks.0.0.cpe2.proj.bias
stages.3.blocks.0.0.norm2.weight
stages.3.blocks.0.0.norm2.bias
stages.3.blocks.0.0.mlp.fc1.weight
stages.3.blocks.0.0.mlp.fc1.bias
stages.3.blocks.0.0.mlp.fc2.weight
stages.3.blocks.0.0.mlp.fc2.bias
stages.3.blocks.0.1.cpe1.proj.weight
stages.3.blocks.0.1.cpe1.proj.bias
stages.3.blocks.0.1.norm1.weight
stages.3.blocks.0.1.norm1.bias
stages.3.blocks.0.1.attn.qkv.weight
stages.3.blocks.0.1.attn.qkv.bias
stages.3.blocks.0.1.attn.proj.weight
stages.3.blocks.0.1.attn.proj.bias
stages.3.blocks.0.1.cpe2.proj.weight
stages.3.blocks.0.1.cpe2.proj.bias
stages.3.blocks.0.1.norm2.weight
stages.3.blocks.0.1.norm2.bias
stages.3.blocks.0.1.mlp.fc1.weight
stages.3.blocks.0.1.mlp.fc1.bias
stages.3.blocks.0.1.mlp.fc2.weight
stages.3.blocks.0.1.mlp.fc2.bias
head.norm.weight
head.norm.bias
head.fc.weight
head.fc.bias
head.fc.bias
DaVit(
  (stem): Stem(
    (conv): Conv2d(3, 96, kernel_size=(7, 7), stride=(4, 4), padding=(3, 3))
    (norm): LayerNorm2d((96,), eps=1e-05, elementwise_affine=True)
  )
  (stages): Sequential(
    (0): DaVitStage(
      (downsample): Identity()
      (blocks): Sequential(
        (0): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=96)
              (act): Identity()
            )
            (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=96, out_features=288, bias=True)
              (proj): Linear(in_features=96, out_features=96, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=96)
              (act): Identity()
            )
            (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=96, out_features=384, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=384, out_features=96, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=96)
              (act): Identity()
            )
            (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=96, out_features=288, bias=True)
              (proj): Linear(in_features=96, out_features=96, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=96)
              (act): Identity()
            )
            (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=96, out_features=384, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=384, out_features=96, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
      )
    )
    (1): DaVitStage(
      (downsample): Downsample(
        (norm): LayerNorm2d((96,), eps=1e-05, elementwise_affine=True)
        (conv): Conv2d(96, 192, kernel_size=(2, 2), stride=(2, 2))
      )
      (blocks): Sequential(
        (0): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192)
              (act): Identity()
            )
            (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=192, out_features=576, bias=True)
              (proj): Linear(in_features=192, out_features=192, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192)
              (act): Identity()
            )
            (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=192, out_features=768, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=768, out_features=192, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192)
              (act): Identity()
            )
            (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=192, out_features=576, bias=True)
              (proj): Linear(in_features=192, out_features=192, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192)
              (act): Identity()
            )
            (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=192, out_features=768, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=768, out_features=192, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
      )
    )
    (2): DaVitStage(
      (downsample): Downsample(
        (norm): LayerNorm2d((192,), eps=1e-05, elementwise_affine=True)
        (conv): Conv2d(192, 384, kernel_size=(2, 2), stride=(2, 2))
      )
      (blocks): Sequential(
        (0): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
        (1): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
        (2): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
      )
    )
    (3): DaVitStage(
      (downsample): Downsample(
        (norm): LayerNorm2d((384,), eps=1e-05, elementwise_affine=True)
        (conv): Conv2d(384, 768, kernel_size=(2, 2), stride=(2, 2))
      )
      (blocks): Sequential(
        (0): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(768, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=768)
              (act): Identity()
            )
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (proj): Linear(in_features=768, out_features=768, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(768, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=768)
              (act): Identity()
            )
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(768, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=768)
              (act): Identity()
            )
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (proj): Linear(in_features=768, out_features=768, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(768, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=768)
              (act): Identity()
            )
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
      )
    )
  )
  (norm_pre): Identity()
  (head): NormMlpClassifierHead(
    (global_pool): SelectAdaptivePool2d(pool_type=avg, flatten=Identity())
    (norm): LayerNorm2d((768,), eps=1e-05, elementwise_affine=True)
    (flatten): Flatten(start_dim=1, end_dim=-1)
    (pre_logits): Identity()
    (drop): Dropout(p=0.0, inplace=False)
    (fc): Sequential(
      (0): Dropout(p=0.2, inplace=False)
      (1): Linear(in_features=768, out_features=64, bias=False)
      (2): GELU(approximate='none')
      (3): Linear(in_features=64, out_features=1, bias=False)
      (4): Sigmoid()
    )
  )
)
Starting training...
--------------------




































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:13<00:02,  1.11it/s]
New threshold is 0.4347328245639801
train F1 is 0.4373056888580322
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.11it/s]




100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.50it/s]
  1%|▉                                                                                  | 1/84 [00:00<01:16,  1.08it/s]
New threshold is 0.42303797602653503
val F1 is 0.4426877498626709
Epoch 1/40, learning rate: 1.9864292578550327e-05
Train Loss: 0.6768, Train Acc: 0.5343, Train f1: 0.4373, Train Precision: 0.4315, Train Recall: 0.4433, Train AUC: 0.5171
Valitadion Loss: 0.6800, Validation Acc: 0.5070, Vall f1: 0.4427, Val Precision: 0.4179, Val Recall: 0.4706, Val AUC: 0.5163




































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:13<00:02,  1.11it/s]
New threshold is 0.40230005979537964
train F1 is 0.483011931180954
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.12it/s]



 71%|██████████████████████████████████████████████████████████▌                       | 15/21 [00:06<00:02,  2.42it/s]
New threshold is 0.3949805200099945

100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.49it/s]
Epoch 2/40, learning rate: 1.9460853615232776e-05
Train Loss: 0.6744, Train Acc: 0.5172, Train f1: 0.4830, Train Precision: 0.4290, Train Recall: 0.5525, Train AUC: 0.5317
Valitadion Loss: 0.6757, Validation Acc: 0.5874, Vall f1: 0.5462, Val Precision: 0.5035, Val Recall: 0.5966, Val AUC: 0.5967
train for epoch 3




































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:13<00:01,  1.11it/s]
New threshold is 0.41440099477767944
train F1 is 0.517756998538971
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.12it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.41it/s]
New threshold is 0.41252246499061584
val F1 is 0.5530303120613098
Epoch 3/40, learning rate: 1.8800633042879672e-05
Train Loss: 0.6697, Train Acc: 0.5575, Train f1: 0.5178, Train Precision: 0.4663, Train Recall: 0.5819, Train AUC: 0.5726
Valitadion Loss: 0.6726, Validation Acc: 0.5874, Vall f1: 0.5530, Val Precision: 0.5034, Val Recall: 0.6134, Val AUC: 0.6057
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.48it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:14<00:01,  1.11it/s]
New threshold is 0.4184632897377014
train F1 is 0.4753086566925049
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.12it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:06<00:01,  2.46it/s]
New threshold is 0.4430920481681824
val F1 is 0.523809552192688
Epoch 4/40, learning rate: 1.79015502286794e-05
Train Loss: 0.6710, Train Acc: 0.5626, Train f1: 0.4753, Train Precision: 0.4657, Train Recall: 0.4853, Train AUC: 0.5597
Valitadion Loss: 0.6751, Validation Acc: 0.5804, Vall f1: 0.5238, Val Precision: 0.4962, Val Recall: 0.5546, Val AUC: 0.5918
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.51it/s]





































 99%|█████████████████████████████████████████████████████████████████████████████████ | 83/84 [01:14<00:00,  1.11it/s]
New threshold is 0.41579729318618774
train F1 is 0.5539637207984924
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.12it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.44it/s]
New threshold is 0.3420482575893402
val F1 is 0.49166667461395264
Epoch 5/40, learning rate: 1.678800761592905e-05
Train Loss: 0.6592, Train Acc: 0.5995, Train f1: 0.5540, Train Precision: 0.5079, Train Recall: 0.6092, Train AUC: 0.6114
Valitadion Loss: 0.6873, Validation Acc: 0.5734, Vall f1: 0.4917, Val Precision: 0.4876, Val Recall: 0.4958, Val AUC: 0.5824
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.49it/s]





































 99%|█████████████████████████████████████████████████████████████████████████████████ | 83/84 [01:15<00:00,  1.08it/s]
New threshold is 0.42868441343307495
train F1 is 0.4855614900588989
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.11it/s]



 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:07<00:00,  2.46it/s]
New threshold is 0.440748006105423
val F1 is 0.5909090638160706
Epoch 6/40, learning rate: 1.549022840546991e-05
Train Loss: 0.6663, Train Acc: 0.5875, Train f1: 0.4856, Train Precision: 0.4946, Train Recall: 0.4769, Train AUC: 0.5777
Valitadion Loss: 0.6634, Validation Acc: 0.6224, Vall f1: 0.5909, Val Precision: 0.5379, Val Recall: 0.6555, Val AUC: 0.6471
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.51it/s]




































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:13<00:02,  1.11it/s]
New threshold is 0.4122690260410309
train F1 is 0.5456329584121704
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.12it/s]




 95%|██████████████████████████████████████████████████████████████████████████████    | 20/21 [00:08<00:00,  2.43it/s]
New threshold is 0.4052233099937439
val F1 is 0.6058394312858582
Epoch 7/40, learning rate: 1.4043436253115652e-05
Train Loss: 0.6564, Train Acc: 0.6029, Train f1: 0.5456, Train Precision: 0.5120, Train Recall: 0.5840, Train AUC: 0.6139
Valitadion Loss: 0.6582, Validation Acc: 0.6224, Vall f1: 0.6058, Val Precision: 0.5355, Val Recall: 0.6975, Val AUC: 0.6480
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.50it/s]




































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:13<00:02,  1.10it/s]
New threshold is 0.40856844186782837
train F1 is 0.5694715976715088
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.12it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.44it/s]
New threshold is 0.4354359805583954
val F1 is 0.5886792540550232
Epoch 8/40, learning rate: 1.2486899247303603e-05
Train Loss: 0.6509, Train Acc: 0.6226, Train f1: 0.5695, Train Precision: 0.5330, Train Recall: 0.6113, Train AUC: 0.6393
Valitadion Loss: 0.6518, Validation Acc: 0.6189, Vall f1: 0.5887, Val Precision: 0.5342, Val Recall: 0.6555, Val AUC: 0.6577
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.50it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:14<00:01,  1.12it/s]
New threshold is 0.407484769821167
train F1 is 0.5779467821121216
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.12it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:06<00:01,  2.44it/s]
New threshold is 0.5216863751411438
val F1 is 0.6000000238418579
Epoch 9/40, learning rate: 1.0862864114836052e-05
Train Loss: 0.6447, Train Acc: 0.6192, Train f1: 0.5779, Train Precision: 0.5278, Train Recall: 0.6387, Train AUC: 0.6502
Valitadion Loss: 0.6600, Validation Acc: 0.6503, Vall f1: 0.6000, Val Precision: 0.5725, Val Recall: 0.6303, Val AUC: 0.6633
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.49it/s]





































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:13<00:02,  1.11it/s]
New threshold is 0.40389543771743774
train F1 is 0.6251145601272583
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.11it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.41it/s]
New threshold is 0.4384229779243469
val F1 is 0.6235741376876831
Epoch 10/40, learning rate: 9.215409581951101e-06
Train Loss: 0.6245, Train Acc: 0.6492, Train f1: 0.6251, Train Precision: 0.5545, Train Recall: 0.7164, Train AUC: 0.6920
Valitadion Loss: 0.6301, Validation Acc: 0.6538, Vall f1: 0.6236, Val Precision: 0.5694, Val Recall: 0.6891, Val AUC: 0.6953
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.48it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:14<00:01,  1.11it/s]
New threshold is 0.41502535343170166
train F1 is 0.6384976506233215
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.11it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.45it/s]
New threshold is 0.38145017623901367
val F1 is 0.6538461446762085
Epoch 11/40, learning rate: 7.589250012207144e-06
Train Loss: 0.6018, Train Acc: 0.6698, Train f1: 0.6385, Train Precision: 0.5772, Train Recall: 0.7143, Train AUC: 0.7242
Valitadion Loss: 0.6194, Validation Acc: 0.6853, Vall f1: 0.6538, Val Precision: 0.6028, Val Recall: 0.7143, Val AUC: 0.7173
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.49it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:14<00:01,  1.11it/s]
New threshold is 0.40796709060668945
train F1 is 0.6360294222831726
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.11it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:06<00:01,  2.43it/s]
New threshold is 0.39011600613594055
val F1 is 0.6666666865348816
Epoch 12/40, learning rate: 6.0285217922261386e-06
Train Loss: 0.6006, Train Acc: 0.6604, Train f1: 0.6360, Train Precision: 0.5654, Train Recall: 0.7269, Train AUC: 0.7184
Valitadion Loss: 0.6120, Validation Acc: 0.6818, Vall f1: 0.6667, Val Precision: 0.5909, Val Recall: 0.7647, Val AUC: 0.7251
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.49it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:14<00:01,  1.10it/s]
New threshold is 0.3985261023044586
train F1 is 0.6703296899795532
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.11it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.41it/s]
New threshold is 0.2784089148044586
val F1 is 0.6814814805984497
Epoch 13/40, learning rate: 4.5755854045895805e-06
Train Loss: 0.5913, Train Acc: 0.6913, Train f1: 0.6703, Train Precision: 0.5942, Train Recall: 0.7689, Train AUC: 0.7337
Valitadion Loss: 0.6099, Validation Acc: 0.6993, Vall f1: 0.6815, Val Precision: 0.6093, Val Recall: 0.7731, Val AUC: 0.7507
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:14<00:01,  1.10it/s]
New threshold is 0.41751646995544434
train F1 is 0.6513410210609436
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.11it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.40it/s]
New threshold is 0.5169007182121277
val F1 is 0.661478579044342
Epoch 14/40, learning rate: 3.269875701408523e-06
Train Loss: 0.5772, Train Acc: 0.6878, Train f1: 0.6513, Train Precision: 0.5986, Train Recall: 0.7143, Train AUC: 0.7557
Valitadion Loss: 0.6044, Validation Acc: 0.6958, Vall f1: 0.6615, Val Precision: 0.6159, Val Recall: 0.7143, Val AUC: 0.7487
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:14<00:01,  1.10it/s]
New threshold is 0.3890428841114044
train F1 is 0.6940966248512268
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.11it/s]



100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.45it/s]
  0%|                                                                                           | 0/84 [00:00<?, ?it/s]
New threshold is 0.4595836102962494
val F1 is 0.6614173054695129
Epoch 15/40, learning rate: 2.146831583851016e-06
Train Loss: 0.5604, Train Acc: 0.7067, Train f1: 0.6941, Train Precision: 0.6044, Train Recall: 0.8151, Train AUC: 0.7716
Valitadion Loss: 0.5889, Validation Acc: 0.6993, Vall f1: 0.6614, Val Precision: 0.6222, Val Recall: 0.7059, Val AUC: 0.7573





































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:13<00:02,  1.10it/s]
New threshold is 0.44228988885879517
train F1 is 0.6882745623588562
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.11it/s]




 95%|██████████████████████████████████████████████████████████████████████████████    | 20/21 [00:08<00:00,  2.42it/s]
New threshold is 0.47283321619033813
val F1 is 0.658823549747467
Epoch 16/40, learning rate: 1.2369341377147044e-06
Train Loss: 0.5505, Train Acc: 0.7196, Train f1: 0.6883, Train Precision: 0.6300, Train Recall: 0.7584, Train AUC: 0.7837
Valitadion Loss: 0.5840, Validation Acc: 0.6958, Vall f1: 0.6588, Val Precision: 0.6176, Val Recall: 0.7059, Val AUC: 0.7620
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]




































100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.11it/s]
  0%|                                                                                           | 0/21 [00:00<?, ?it/s]
New threshold is 0.4197329580783844
train F1 is 0.6884939074516296




 95%|██████████████████████████████████████████████████████████████████████████████    | 20/21 [00:08<00:00,  2.40it/s]
New threshold is 0.46686452627182007
val F1 is 0.6719367504119873
Epoch 17/40, learning rate: 5.648793314741472e-07
Train Loss: 0.5468, Train Acc: 0.7144, Train f1: 0.6885, Train Precision: 0.6206, Train Recall: 0.7731, Train AUC: 0.7863
Valitadion Loss: 0.5839, Validation Acc: 0.7098, Vall f1: 0.6719, Val Precision: 0.6343, Val Recall: 0.7143, Val AUC: 0.7615
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]




































100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.11it/s]
  0%|                                                                                           | 0/21 [00:00<?, ?it/s]
New threshold is 0.37892258167266846
train F1 is 0.7036705613136292




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:07<00:00,  2.36it/s]
New threshold is 0.47363460063934326
val F1 is 0.6666666865348816
Epoch 18/40, learning rate: 1.4890773100692442e-07
Train Loss: 0.5457, Train Acc: 0.7161, Train f1: 0.7037, Train Precision: 0.6131, Train Recall: 0.8256, Train AUC: 0.7865
Valitadion Loss: 0.5814, Validation Acc: 0.6993, Vall f1: 0.6667, Val Precision: 0.6187, Val Recall: 0.7227, Val AUC: 0.7625
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.44it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:14<00:01,  1.10it/s]
New threshold is 0.4396554231643677
train F1 is 0.6999059319496155
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.11it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.40it/s]
New threshold is 0.4869081377983093
val F1 is 0.6640316247940063
Epoch 19/40, learning rate: 3.0942353668218756e-10
Train Loss: 0.5334, Train Acc: 0.7264, Train f1: 0.6999, Train Precision: 0.6337, Train Recall: 0.7815, Train AUC: 0.8037
Valitadion Loss: 0.5815, Validation Acc: 0.7028, Vall f1: 0.6640, Val Precision: 0.6269, Val Recall: 0.7059, Val AUC: 0.7627
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.45it/s]





































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:13<00:02,  1.10it/s]
New threshold is 0.4686031937599182
train F1 is 0.6369930505752563
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:15<00:00,  1.11it/s]




 95%|██████████████████████████████████████████████████████████████████████████████    | 20/21 [00:08<00:00,  2.39it/s]
New threshold is 0.2956172525882721
val F1 is 0.6530612111091614
Epoch 20/40, learning rate: 1.9969173338872615e-05
Train Loss: 0.5693, Train Acc: 0.6852, Train f1: 0.6370, Train Precision: 0.6019, Train Recall: 0.6765, Train AUC: 0.7585
Valitadion Loss: 0.6622, Validation Acc: 0.7028, Vall f1: 0.6531, Val Precision: 0.6349, Val Recall: 0.6723, Val AUC: 0.7345
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.43it/s]





































 99%|█████████████████████████████████████████████████████████████████████████████████ | 83/84 [01:15<00:00,  1.10it/s]
New threshold is 0.39836663007736206
train F1 is 0.6244175434112549
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.37it/s]
New threshold is 0.4309951066970825
val F1 is 0.643410861492157
Epoch 21/40, learning rate: 1.987066410425045e-05
Train Loss: 0.6067, Train Acc: 0.6544, Train f1: 0.6244, Train Precision: 0.5611, Train Recall: 0.7038, Train AUC: 0.7149
Valitadion Loss: 0.5971, Validation Acc: 0.6783, Vall f1: 0.6434, Val Precision: 0.5971, Val Recall: 0.6975, Val AUC: 0.7446
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.44it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:14<00:01,  1.09it/s]
New threshold is 0.4397641122341156
train F1 is 0.6544046401977539
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.37it/s]
New threshold is 0.3281210660934448
val F1 is 0.6439393758773804
Epoch 22/40, learning rate: 1.970506474943219e-05
Train Loss: 0.5716, Train Acc: 0.6938, Train f1: 0.6544, Train Precision: 0.6068, Train Recall: 0.7101, Train AUC: 0.7566
Valitadion Loss: 0.6214, Validation Acc: 0.6713, Vall f1: 0.6439, Val Precision: 0.5862, Val Recall: 0.7143, Val AUC: 0.7418
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.43it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]
  0%|                                                                                           | 0/21 [00:00<?, ?it/s]
New threshold is 0.39983099699020386
train F1 is 0.6419752836227417




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:08<00:00,  2.35it/s]
New threshold is 0.5066850185394287
val F1 is 0.661478579044342
Epoch 23/40, learning rate: 1.9473500840141124e-05
Train Loss: 0.5813, Train Acc: 0.6767, Train f1: 0.6420, Train Precision: 0.5858, Train Recall: 0.7101, Train AUC: 0.7438
Valitadion Loss: 0.6297, Validation Acc: 0.6958, Vall f1: 0.6615, Val Precision: 0.6159, Val Recall: 0.7143, Val AUC: 0.7493
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.41it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.10it/s]
New threshold is 0.4385809600353241
train F1 is 0.6782273650169373
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.36it/s]
New threshold is 0.4113258123397827
val F1 is 0.6715866923332214
Epoch 24/40, learning rate: 1.9177546297962497e-05
Train Loss: 0.5504, Train Acc: 0.7136, Train f1: 0.6782, Train Precision: 0.6263, Train Recall: 0.7395, Train AUC: 0.7857
Valitadion Loss: 0.5881, Validation Acc: 0.6888, Vall f1: 0.6716, Val Precision: 0.5987, Val Recall: 0.7647, Val AUC: 0.7573
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.43it/s]





































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:14<00:02,  1.10it/s]
New threshold is 0.4385395050048828
train F1 is 0.6588921546936035
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.42it/s]
  0%|                                                                                           | 0/84 [00:00<?, ?it/s]
New threshold is 0.5082976222038269
val F1 is 0.6315789222717285
Epoch 25/40, learning rate: 1.881921270252292e-05
Train Loss: 0.5543, Train Acc: 0.6990, Train f1: 0.6589, Train Precision: 0.6130, Train Recall: 0.7122, Train AUC: 0.7804
Valitadion Loss: 0.6318, Validation Acc: 0.6818, Vall f1: 0.6316, Val Precision: 0.6094, Val Recall: 0.6555, Val AUC: 0.7243





































100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]
  0%|                                                                                           | 0/21 [00:00<?, ?it/s]
New threshold is 0.4481050372123718
train F1 is 0.6740442514419556




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:07<00:00,  2.37it/s]
New threshold is 0.33468398451805115
val F1 is 0.6613546013832092
Epoch 26/40, learning rate: 1.8400935618942642e-05
Train Loss: 0.5576, Train Acc: 0.7221, Train f1: 0.6740, Train Precision: 0.6467, Train Recall: 0.7038, Train AUC: 0.7749
Valitadion Loss: 0.6031, Validation Acc: 0.7028, Vall f1: 0.6614, Val Precision: 0.6288, Val Recall: 0.6975, Val AUC: 0.7584
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.43it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:14<00:01,  1.09it/s]
New threshold is 0.4537861943244934
train F1 is 0.6813187003135681
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.41it/s]
  0%|                                                                                           | 0/84 [00:00<?, ?it/s]
New threshold is 0.31398364901542664
val F1 is 0.6746031641960144
Epoch 27/40, learning rate: 1.7925558043492013e-05
Train Loss: 0.5271, Train Acc: 0.7264, Train f1: 0.6813, Train Precision: 0.6495, Train Recall: 0.7164, Train AUC: 0.8027
Valitadion Loss: 0.5778, Validation Acc: 0.7133, Vall f1: 0.6746, Val Precision: 0.6391, Val Recall: 0.7143, Val AUC: 0.7972






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 83/84 [01:15<00:00,  1.10it/s]
New threshold is 0.4173736274242401
train F1 is 0.6948453783988953
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.37it/s]
New threshold is 0.5025506615638733
val F1 is 0.6842105388641357
Epoch 28/40, learning rate: 1.739631107997055e-05
Train Loss: 0.5046, Train Acc: 0.7461, Train f1: 0.6948, Train Precision: 0.6822, Train Recall: 0.7080, Train AUC: 0.8222
Valitadion Loss: 0.5934, Validation Acc: 0.7063, Vall f1: 0.6842, Val Precision: 0.6190, Val Recall: 0.7647, Val AUC: 0.7722
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.42it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.10it/s]
New threshold is 0.42045965790748596
train F1 is 0.7198404669761658
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.37it/s]
New threshold is 0.4697929620742798
val F1 is 0.6279069781303406
Epoch 29/40, learning rate: 1.6816791978149873e-05
Train Loss: 0.4877, Train Acc: 0.7590, Train f1: 0.7198, Train Precision: 0.6850, Train Recall: 0.7584, Train AUC: 0.8378
Valitadion Loss: 0.6080, Validation Acc: 0.6643, Vall f1: 0.6279, Val Precision: 0.5827, Val Recall: 0.6807, Val AUC: 0.7502
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.42it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 83/84 [01:16<00:00,  1.09it/s]
New threshold is 0.41178447008132935
train F1 is 0.7167167067527771
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.35it/s]
New threshold is 0.34467828273773193
val F1 is 0.6641509532928467
Epoch 30/40, learning rate: 1.6190939683551365e-05
Train Loss: 0.4850, Train Acc: 0.7573, Train f1: 0.7167, Train Precision: 0.6845, Train Recall: 0.7521, Train AUC: 0.8389
Valitadion Loss: 0.5779, Validation Acc: 0.6888, Vall f1: 0.6642, Val Precision: 0.6027, Val Recall: 0.7395, Val AUC: 0.7759
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.40it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.09it/s]
New threshold is 0.38093626499176025
train F1 is 0.7205588817596436
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.37it/s]
New threshold is 0.645392656326294
val F1 is 0.5955555438995361
Epoch 31/40, learning rate: 1.5523008064744873e-05
Train Loss: 0.4768, Train Acc: 0.7599, Train f1: 0.7206, Train Precision: 0.6863, Train Recall: 0.7584, Train AUC: 0.8449
Valitadion Loss: 0.6429, Validation Acc: 0.6818, Vall f1: 0.5956, Val Precision: 0.6321, Val Recall: 0.5630, Val AUC: 0.7275
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.42it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]
  0%|                                                                                           | 0/21 [00:00<?, ?it/s]
New threshold is 0.3882599174976349
train F1 is 0.726202130317688




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:08<00:00,  2.34it/s]
New threshold is 0.24471180140972137
val F1 is 0.6566037535667419
Epoch 32/40, learning rate: 1.4817537000140316e-05
Train Loss: 0.4722, Train Acc: 0.7607, Train f1: 0.7262, Train Precision: 0.6814, Train Recall: 0.7773, Train AUC: 0.8460
Valitadion Loss: 0.6579, Validation Acc: 0.6818, Vall f1: 0.6566, Val Precision: 0.5959, Val Recall: 0.7311, Val AUC: 0.7484
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.41it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.09it/s]
New threshold is 0.4073895812034607
train F1 is 0.7349753975868225
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.39it/s]
New threshold is 0.43071937561035156
val F1 is 0.6827309131622314
Epoch 33/40, learning rate: 1.407932152079303e-05
Train Loss: 0.4763, Train Acc: 0.7693, Train f1: 0.7350, Train Precision: 0.6920, Train Recall: 0.7836, Train AUC: 0.8444
Valitadion Loss: 0.5871, Validation Acc: 0.7238, Vall f1: 0.6827, Val Precision: 0.6538, Val Recall: 0.7143, Val AUC: 0.7784
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.43it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]
  0%|                                                                                           | 0/21 [00:00<?, ?it/s]
New threshold is 0.47070547938346863
train F1 is 0.752173900604248




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:07<00:00,  2.37it/s]
New threshold is 0.5892491936683655
val F1 is 0.6462882161140442
Epoch 34/40, learning rate: 1.3313379218956768e-05
Train Loss: 0.4463, Train Acc: 0.8045, Train f1: 0.7522, Train Precision: 0.7793, Train Recall: 0.7269, Train AUC: 0.8649
Valitadion Loss: 0.6112, Validation Acc: 0.7168, Vall f1: 0.6463, Val Precision: 0.6727, Val Recall: 0.6218, Val AUC: 0.7572
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.43it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.08it/s]
New threshold is 0.40962913632392883
train F1 is 0.771784245967865
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.42it/s]
  0%|                                                                                           | 0/84 [00:00<?, ?it/s]
New threshold is 0.5623515844345093
val F1 is 0.631147563457489
Epoch 35/40, learning rate: 1.2524916143905793e-05
Train Loss: 0.4331, Train Acc: 0.8113, Train f1: 0.7718, Train Precision: 0.7623, Train Recall: 0.7815, Train AUC: 0.8778
Valitadion Loss: 0.6190, Validation Acc: 0.6853, Vall f1: 0.6311, Val Precision: 0.6160, Val Recall: 0.6471, Val AUC: 0.7662






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 83/84 [01:16<00:00,  1.09it/s]
New threshold is 0.47473806142807007
train F1 is 0.782608687877655
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.36it/s]
New threshold is 0.35119426250457764
val F1 is 0.6454183459281921
Epoch 36/40, learning rate: 1.1719291416829545e-05
Train Loss: 0.4028, Train Acc: 0.8242, Train f1: 0.7826, Train Precision: 0.7901, Train Recall: 0.7752, Train AUC: 0.8946
Valitadion Loss: 0.6092, Validation Acc: 0.6888, Vall f1: 0.6454, Val Precision: 0.6136, Val Recall: 0.6807, Val AUC: 0.7686
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.42it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.09it/s]
New threshold is 0.4094180762767792
train F1 is 0.7942973375320435
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.42it/s]
  0%|                                                                                           | 0/84 [00:00<?, ?it/s]
New threshold is 0.46352189779281616
val F1 is 0.6260162591934204
Epoch 37/40, learning rate: 1.0901980805309577e-05
Train Loss: 0.3960, Train Acc: 0.8268, Train f1: 0.7943, Train Precision: 0.7708, Train Recall: 0.8193, Train AUC: 0.9000
Valitadion Loss: 0.6298, Validation Acc: 0.6783, Vall f1: 0.6260, Val Precision: 0.6063, Val Recall: 0.6471, Val AUC: 0.7394





































100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]
  0%|                                                                                           | 0/21 [00:00<?, ?it/s]
New threshold is 0.4208497703075409
train F1 is 0.7849686741828918




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:08<00:00,  2.36it/s]
New threshold is 0.5488296747207642
val F1 is 0.6518518328666687
Epoch 38/40, learning rate: 1.0078539504960164e-05
Train Loss: 0.4054, Train Acc: 0.8233, Train f1: 0.7850, Train Precision: 0.7801, Train Recall: 0.7899, Train AUC: 0.8941
Valitadion Loss: 0.6533, Validation Acc: 0.6713, Vall f1: 0.6519, Val Precision: 0.5828, Val Recall: 0.7395, Val AUC: 0.7521
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.42it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.10it/s]
New threshold is 0.4606105387210846
train F1 is 0.8062826991081238
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.35it/s]
New threshold is 0.3297252058982849
val F1 is 0.6166666746139526
Epoch 39/40, learning rate: 9.254564381202913e-06
Train Loss: 0.3656, Train Acc: 0.8413, Train f1: 0.8063, Train Precision: 0.8038, Train Recall: 0.8088, Train AUC: 0.9153
Valitadion Loss: 0.6331, Validation Acc: 0.6783, Vall f1: 0.6167, Val Precision: 0.6116, Val Recall: 0.6218, Val AUC: 0.7451
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.41it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]
  0%|                                                                                           | 0/21 [00:00<?, ?it/s]
New threshold is 0.35916948318481445
train F1 is 0.7971745729446411




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:08<00:00,  2.37it/s]
New threshold is 0.4120205342769623
val F1 is 0.6584362387657166
Epoch 40/40, learning rate: 8.435655927814925e-06
Train Loss: 0.3762, Train Acc: 0.8276, Train f1: 0.7972, Train Precision: 0.7670, Train Recall: 0.8298, Train AUC: 0.9080
Valitadion Loss: 0.6032, Validation Acc: 0.7098, Vall f1: 0.6584, Val Precision: 0.6452, Val Recall: 0.6723, Val AUC: 0.7664
Training complete in 56m 20s
Best val auc: 0.684211
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.42it/s]




100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:09<00:00,  2.23it/s]
New threshold is 0.4120205342769623
Inference complete in 0m 9s
F1 Score = : 0.658436
AUC Score = : 0.766417
Acc Score = : 0.709790