
  0%|                                                                                           | 0/98 [00:00<?, ?it/s]
stem.conv.weight
stem.conv.bias
stem.norm.weight
stem.norm.bias
stages.0.blocks.0.0.cpe1.proj.weight
stages.0.blocks.0.0.cpe1.proj.bias
stages.0.blocks.0.0.norm1.weight
stages.0.blocks.0.0.norm1.bias
stages.0.blocks.0.0.attn.qkv.weight
stages.0.blocks.0.0.attn.qkv.bias
stages.0.blocks.0.0.attn.proj.weight
stages.0.blocks.0.0.attn.proj.bias
stages.0.blocks.0.0.cpe2.proj.weight
stages.0.blocks.0.0.cpe2.proj.bias
stages.0.blocks.0.0.norm2.weight
stages.0.blocks.0.0.norm2.bias
stages.0.blocks.0.0.mlp.fc1.weight
stages.0.blocks.0.0.mlp.fc1.bias
stages.0.blocks.0.0.mlp.fc2.weight
stages.0.blocks.0.0.mlp.fc2.bias
stages.0.blocks.0.1.cpe1.proj.weight
stages.0.blocks.0.1.cpe1.proj.bias
stages.0.blocks.0.1.norm1.weight
stages.0.blocks.0.1.norm1.bias
stages.0.blocks.0.1.attn.qkv.weight
stages.0.blocks.0.1.attn.qkv.bias
stages.0.blocks.0.1.attn.proj.weight
stages.0.blocks.0.1.attn.proj.bias
stages.0.blocks.0.1.cpe2.proj.weight
stages.0.blocks.0.1.cpe2.proj.bias
stages.0.blocks.0.1.norm2.weight
stages.0.blocks.0.1.norm2.bias
stages.0.blocks.0.1.mlp.fc1.weight
stages.0.blocks.0.1.mlp.fc1.bias
stages.0.blocks.0.1.mlp.fc2.weight
stages.0.blocks.0.1.mlp.fc2.bias
stages.1.downsample.norm.weight
stages.1.downsample.norm.bias
stages.1.downsample.conv.weight
stages.1.downsample.conv.bias
stages.1.blocks.0.0.cpe1.proj.weight
stages.1.blocks.0.0.cpe1.proj.bias
stages.1.blocks.0.0.norm1.weight
stages.1.blocks.0.0.norm1.bias
stages.1.blocks.0.0.attn.qkv.weight
stages.1.blocks.0.0.attn.qkv.bias
stages.1.blocks.0.0.attn.proj.weight
stages.1.blocks.0.0.attn.proj.bias
stages.1.blocks.0.0.cpe2.proj.weight
stages.1.blocks.0.0.cpe2.proj.bias
stages.1.blocks.0.0.norm2.weight
stages.1.blocks.0.0.norm2.bias
stages.1.blocks.0.0.mlp.fc1.weight
stages.1.blocks.0.0.mlp.fc1.bias
stages.1.blocks.0.0.mlp.fc2.weight
stages.1.blocks.0.0.mlp.fc2.bias
stages.1.blocks.0.1.cpe1.proj.weight
stages.1.blocks.0.1.cpe1.proj.bias
stages.1.blocks.0.1.norm1.weight
stages.1.blocks.0.1.norm1.bias
stages.1.blocks.0.1.attn.qkv.weight
stages.1.blocks.0.1.attn.qkv.bias
stages.1.blocks.0.1.attn.proj.weight
stages.1.blocks.0.1.attn.proj.bias
stages.1.blocks.0.1.cpe2.proj.weight
stages.1.blocks.0.1.cpe2.proj.bias
stages.1.blocks.0.1.norm2.weight
stages.1.blocks.0.1.norm2.bias
stages.1.blocks.0.1.mlp.fc1.weight
stages.1.blocks.0.1.mlp.fc1.bias
stages.1.blocks.0.1.mlp.fc2.weight
stages.1.blocks.0.1.mlp.fc2.bias
stages.2.downsample.norm.weight
stages.2.downsample.norm.bias
stages.2.downsample.conv.weight
stages.2.downsample.conv.bias
stages.2.blocks.0.0.cpe1.proj.weight
stages.2.blocks.0.0.cpe1.proj.bias
stages.2.blocks.0.0.norm1.weight
stages.2.blocks.0.0.norm1.bias
stages.2.blocks.0.0.attn.qkv.weight
stages.2.blocks.0.0.attn.qkv.bias
stages.2.blocks.0.0.attn.proj.weight
stages.2.blocks.0.0.attn.proj.bias
stages.2.blocks.0.0.cpe2.proj.weight
stages.2.blocks.0.0.cpe2.proj.bias
stages.2.blocks.0.0.norm2.weight
stages.2.blocks.0.0.norm2.bias
stages.2.blocks.0.0.mlp.fc1.weight
stages.2.blocks.0.0.mlp.fc1.bias
stages.2.blocks.0.0.mlp.fc2.weight
stages.2.blocks.0.0.mlp.fc2.bias
stages.2.blocks.0.1.cpe1.proj.weight
stages.2.blocks.0.1.cpe1.proj.bias
stages.2.blocks.0.1.norm1.weight
stages.2.blocks.0.1.norm1.bias
stages.2.blocks.0.1.attn.qkv.weight
stages.2.blocks.0.1.attn.qkv.bias
stages.2.blocks.0.1.attn.proj.weight
stages.2.blocks.0.1.attn.proj.bias
stages.2.blocks.0.1.cpe2.proj.weight
stages.2.blocks.0.1.cpe2.proj.bias
stages.2.blocks.0.1.norm2.weight
stages.2.blocks.0.1.norm2.bias
stages.2.blocks.0.1.mlp.fc1.weight
stages.2.blocks.0.1.mlp.fc1.bias
stages.2.blocks.0.1.mlp.fc2.weight
stages.2.blocks.0.1.mlp.fc2.bias
stages.2.blocks.1.0.cpe1.proj.weight
stages.2.blocks.1.0.cpe1.proj.bias
stages.2.blocks.1.0.norm1.weight
stages.2.blocks.1.0.norm1.bias
stages.2.blocks.1.0.attn.qkv.weight
stages.2.blocks.1.0.attn.qkv.bias
stages.2.blocks.1.0.attn.proj.weight
stages.2.blocks.1.0.attn.proj.bias
stages.2.blocks.1.0.cpe2.proj.weight
stages.2.blocks.1.0.cpe2.proj.bias
stages.2.blocks.1.0.norm2.weight
stages.2.blocks.1.0.norm2.bias
stages.2.blocks.1.0.mlp.fc1.weight
stages.2.blocks.1.0.mlp.fc1.bias
stages.2.blocks.1.0.mlp.fc2.weight
stages.2.blocks.1.0.mlp.fc2.bias
stages.2.blocks.1.1.cpe1.proj.weight
stages.2.blocks.1.1.cpe1.proj.bias
stages.2.blocks.1.1.norm1.weight
stages.2.blocks.1.1.norm1.bias
stages.2.blocks.1.1.attn.qkv.weight
stages.2.blocks.1.1.attn.qkv.bias
stages.2.blocks.1.1.attn.proj.weight
stages.2.blocks.1.1.attn.proj.bias
stages.2.blocks.1.1.cpe2.proj.weight
stages.2.blocks.1.1.cpe2.proj.bias
stages.2.blocks.1.1.norm2.weight
stages.2.blocks.1.1.norm2.bias
stages.2.blocks.1.1.mlp.fc1.weight
stages.2.blocks.1.1.mlp.fc1.bias
stages.2.blocks.1.1.mlp.fc2.weight
stages.2.blocks.1.1.mlp.fc2.bias
stages.2.blocks.2.0.cpe1.proj.weight
stages.2.blocks.2.0.cpe1.proj.bias
stages.2.blocks.2.0.norm1.weight
stages.2.blocks.2.0.norm1.bias
stages.2.blocks.2.0.attn.qkv.weight
stages.2.blocks.2.0.attn.qkv.bias
stages.2.blocks.2.0.attn.proj.weight
stages.2.blocks.2.0.attn.proj.bias
stages.2.blocks.2.0.cpe2.proj.weight
stages.2.blocks.2.0.cpe2.proj.bias
stages.2.blocks.2.0.norm2.weight
stages.2.blocks.2.0.norm2.bias
stages.2.blocks.2.0.mlp.fc1.weight
stages.2.blocks.2.0.mlp.fc1.bias
stages.2.blocks.2.0.mlp.fc2.weight
stages.2.blocks.2.0.mlp.fc2.bias
stages.2.blocks.2.1.cpe1.proj.weight
stages.2.blocks.2.1.cpe1.proj.bias
stages.2.blocks.2.1.norm1.weight
stages.2.blocks.2.1.norm1.bias
stages.2.blocks.2.1.attn.qkv.weight
stages.2.blocks.2.1.attn.qkv.bias
stages.2.blocks.2.1.attn.proj.weight
stages.2.blocks.2.1.attn.proj.bias
stages.2.blocks.2.1.cpe2.proj.weight
stages.2.blocks.2.1.cpe2.proj.bias
stages.2.blocks.2.1.norm2.weight
stages.2.blocks.2.1.norm2.bias
stages.2.blocks.2.1.mlp.fc1.weight
stages.2.blocks.2.1.mlp.fc1.bias
stages.2.blocks.2.1.mlp.fc2.weight
stages.2.blocks.2.1.mlp.fc2.bias
stages.3.downsample.norm.weight
stages.3.downsample.norm.bias
stages.3.downsample.conv.weight
stages.3.downsample.conv.bias
stages.3.blocks.0.0.cpe1.proj.weight
stages.3.blocks.0.0.cpe1.proj.bias
stages.3.blocks.0.0.norm1.weight
stages.3.blocks.0.0.norm1.bias
stages.3.blocks.0.0.attn.qkv.weight
stages.3.blocks.0.0.attn.qkv.bias
stages.3.blocks.0.0.attn.proj.weight
stages.3.blocks.0.0.attn.proj.bias
stages.3.blocks.0.0.cpe2.proj.weight
stages.3.blocks.0.0.cpe2.proj.bias
stages.3.blocks.0.0.norm2.weight
stages.3.blocks.0.0.norm2.bias
stages.3.blocks.0.0.mlp.fc1.weight
stages.3.blocks.0.0.mlp.fc1.bias
stages.3.blocks.0.0.mlp.fc2.weight
stages.3.blocks.0.0.mlp.fc2.bias
stages.3.blocks.0.1.cpe1.proj.weight
stages.3.blocks.0.1.cpe1.proj.bias
stages.3.blocks.0.1.norm1.weight
stages.3.blocks.0.1.norm1.bias
stages.3.blocks.0.1.attn.qkv.weight
stages.3.blocks.0.1.attn.qkv.bias
stages.3.blocks.0.1.attn.proj.weight
stages.3.blocks.0.1.attn.proj.bias
stages.3.blocks.0.1.cpe2.proj.weight
stages.3.blocks.0.1.cpe2.proj.bias
stages.3.blocks.0.1.norm2.weight
stages.3.blocks.0.1.norm2.bias
stages.3.blocks.0.1.mlp.fc1.weight
stages.3.blocks.0.1.mlp.fc1.bias
stages.3.blocks.0.1.mlp.fc2.weight
stages.3.blocks.0.1.mlp.fc2.bias
head.norm.weight
head.norm.bias
head.fc.weight
head.fc.bias
head.fc.bias
DaVit(
  (stem): Stem(
    (conv): Conv2d(3, 96, kernel_size=(7, 7), stride=(4, 4), padding=(3, 3))
    (norm): LayerNorm2d((96,), eps=1e-05, elementwise_affine=True)
  )
  (stages): Sequential(
    (0): DaVitStage(
      (downsample): Identity()
      (blocks): Sequential(
        (0): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=96)
              (act): Identity()
            )
            (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=96, out_features=288, bias=True)
              (proj): Linear(in_features=96, out_features=96, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=96)
              (act): Identity()
            )
            (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=96, out_features=384, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=384, out_features=96, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=96)
              (act): Identity()
            )
            (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=96, out_features=288, bias=True)
              (proj): Linear(in_features=96, out_features=96, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=96)
              (act): Identity()
            )
            (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=96, out_features=384, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=384, out_features=96, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
      )
    )
    (1): DaVitStage(
      (downsample): Downsample(
        (norm): LayerNorm2d((96,), eps=1e-05, elementwise_affine=True)
        (conv): Conv2d(96, 192, kernel_size=(2, 2), stride=(2, 2))
      )
      (blocks): Sequential(
        (0): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192)
              (act): Identity()
            )
            (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=192, out_features=576, bias=True)
              (proj): Linear(in_features=192, out_features=192, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192)
              (act): Identity()
            )
            (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=192, out_features=768, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=768, out_features=192, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192)
              (act): Identity()
            )
            (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=192, out_features=576, bias=True)
              (proj): Linear(in_features=192, out_features=192, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192)
              (act): Identity()
            )
            (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=192, out_features=768, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=768, out_features=192, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
      )
    )
    (2): DaVitStage(
      (downsample): Downsample(
        (norm): LayerNorm2d((192,), eps=1e-05, elementwise_affine=True)
        (conv): Conv2d(192, 384, kernel_size=(2, 2), stride=(2, 2))
      )
      (blocks): Sequential(
        (0): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
        (1): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
        (2): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
      )
    )
    (3): DaVitStage(
      (downsample): Downsample(
        (norm): LayerNorm2d((384,), eps=1e-05, elementwise_affine=True)
        (conv): Conv2d(384, 768, kernel_size=(2, 2), stride=(2, 2))
      )
      (blocks): Sequential(
        (0): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(768, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=768)
              (act): Identity()
            )
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (proj): Linear(in_features=768, out_features=768, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(768, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=768)
              (act): Identity()
            )
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(768, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=768)
              (act): Identity()
            )
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (proj): Linear(in_features=768, out_features=768, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(768, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=768)
              (act): Identity()
            )
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
      )
    )
  )
  (norm_pre): Identity()
  (head): NormMlpClassifierHead(
    (global_pool): SelectAdaptivePool2d(pool_type=avg, flatten=Identity())
    (norm): LayerNorm2d((768,), eps=1e-05, elementwise_affine=True)
    (flatten): Flatten(start_dim=1, end_dim=-1)
    (pre_logits): Identity()
    (drop): Dropout(p=0.0, inplace=False)
    (fc): Sequential(
      (0): Dropout(p=0.2, inplace=False)
      (1): Linear(in_features=768, out_features=64, bias=False)
      (2): LeakyReLU(negative_slope=0.1, inplace=True)
      (3): Linear(in_features=64, out_features=1, bias=False)
      (4): Sigmoid()
    )
  )
)
Starting training...
--------------------







































 99%|█████████████████████████████████████████████████████████████████████████████████▏| 97/98 [01:20<00:00,  1.28it/s]
New threshold is 0.4920419752597809
train F1 is 0.46609359979629517
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:23<00:00,  1.18it/s]





 90%|██████████████████████████████████████████████████████████████████████████        | 28/31 [00:10<00:01,  2.71it/s]
New threshold is 0.504494845867157
val F1 is 0.5094339847564697
Epoch 1/40, learning rate: 1.981543834798841e-05
Train Loss: 0.6936, Train Acc: 0.5222, Train f1: 0.4661, Train Precision: 0.5010, Train Recall: 0.4357, Train AUC: 0.5077
Valitadion Loss: 0.6924, Validation Acc: 0.5679, Vall f1: 0.5094, Val Precision: 0.4629, Val Recall: 0.5664, Val AUC: 0.5867
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.77it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▎ | 96/98 [01:15<00:01,  1.27it/s]
New threshold is 0.489962100982666
train F1 is 0.5053957104682922
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]





 94%|████████████████████████████████████████████████████████████████████████████▋     | 29/31 [00:10<00:00,  2.71it/s]
New threshold is 0.5105435252189636
val F1 is 0.5324675440788269
Epoch 2/40, learning rate: 1.926856599297291e-05
Train Loss: 0.6901, Train Acc: 0.5299, Train f1: 0.5054, Train Precision: 0.5091, Train Recall: 0.5018, Train AUC: 0.5385
Valitadion Loss: 0.6873, Validation Acc: 0.6011, Vall f1: 0.5325, Val Precision: 0.4970, Val Recall: 0.5734, Val AUC: 0.6275
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.78it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▎ | 96/98 [01:15<00:01,  1.28it/s]
New threshold is 0.46255993843078613
train F1 is 0.5760257244110107
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]




 81%|██████████████████████████████████████████████████████████████████▏               | 25/31 [00:09<00:02,  2.81it/s]
New threshold is 0.5051530599594116
val F1 is 0.5082508325576782
Epoch 3/40, learning rate: 1.8379569269019054e-05
Train Loss: 0.6868, Train Acc: 0.5496, Train f1: 0.5760, Train Precision: 0.5242, Train Recall: 0.6393, Train AUC: 0.5606
Valitadion Loss: 0.6899, Validation Acc: 0.5873, Vall f1: 0.5083, Val Precision: 0.4812, Val Recall: 0.5385, Val AUC: 0.5974
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:10<00:00,  2.84it/s]





































 97%|███████████████████████████████████████████████████████████████████████████████▍  | 95/98 [01:14<00:02,  1.28it/s]
New threshold is 0.48547399044036865
train F1 is 0.502782940864563
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.29it/s]





 87%|███████████████████████████████████████████████████████████████████████▍          | 27/31 [00:09<00:01,  2.70it/s]
New threshold is 0.4546644389629364
val F1 is 0.5302013158798218
Epoch 4/40, learning rate: 1.7181263118568742e-05
Train Loss: 0.6886, Train Acc: 0.5419, Train f1: 0.5028, Train Precision: 0.5232, Train Recall: 0.4839, Train AUC: 0.5463
Valitadion Loss: 0.6762, Validation Acc: 0.6122, Vall f1: 0.5302, Val Precision: 0.5097, Val Recall: 0.5524, Val AUC: 0.6231
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.79it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▎ | 96/98 [01:15<00:01,  1.28it/s]
New threshold is 0.4734686017036438
train F1 is 0.5198156833648682
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]





 94%|████████████████████████████████████████████████████████████████████████████▋     | 29/31 [00:10<00:00,  2.74it/s]
New threshold is 0.5772204995155334
val F1 is 0.5379746556282043
Epoch 5/40, learning rate: 1.5717879816382145e-05
Train Loss: 0.6888, Train Acc: 0.5547, Train f1: 0.5198, Train Precision: 0.5371, Train Recall: 0.5036, Train AUC: 0.5584
Valitadion Loss: 0.7148, Validation Acc: 0.5956, Vall f1: 0.5380, Val Precision: 0.4913, Val Recall: 0.5944, Val AUC: 0.6250
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.81it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▎ | 96/98 [01:15<00:01,  1.28it/s]
New threshold is 0.491284042596817
train F1 is 0.5674740672111511
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]




 81%|██████████████████████████████████████████████████████████████████▏               | 25/31 [00:09<00:02,  2.73it/s]
New threshold is 0.46929696202278137
val F1 is 0.5688073635101318
Epoch 6/40, learning rate: 1.4043436253115652e-05
Train Loss: 0.6783, Train Acc: 0.5726, Train f1: 0.5675, Train Precision: 0.5503, Train Recall: 0.5857, Train AUC: 0.5994
Valitadion Loss: 0.6596, Validation Acc: 0.6094, Vall f1: 0.5688, Val Precision: 0.5054, Val Recall: 0.6503, Val AUC: 0.6666
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.78it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████▏| 97/98 [01:16<00:00,  1.27it/s]
New threshold is 0.48176518082618713
train F1 is 0.5476190447807312
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]




 84%|████████████████████████████████████████████████████████████████████▊             | 26/31 [00:09<00:01,  2.74it/s]
New threshold is 0.4701460003852844
val F1 is 0.5850746035575867
Epoch 7/40, learning rate: 1.2219740045906977e-05
Train Loss: 0.6768, Train Acc: 0.5778, Train f1: 0.5476, Train Precision: 0.5620, Train Recall: 0.5339, Train AUC: 0.5994
Valitadion Loss: 0.6626, Validation Acc: 0.6150, Vall f1: 0.5851, Val Precision: 0.5104, Val Recall: 0.6853, Val AUC: 0.6762
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.79it/s]





































 97%|███████████████████████████████████████████████████████████████████████████████▍  | 95/98 [01:14<00:02,  1.29it/s]
New threshold is 0.4758048951625824
train F1 is 0.5828970074653625
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]





 90%|██████████████████████████████████████████████████████████████████████████        | 28/31 [00:10<00:01,  2.75it/s]
New threshold is 0.486287385225296
val F1 is 0.5652173757553101
Epoch 8/40, learning rate: 1.0314108075075903e-05
Train Loss: 0.6700, Train Acc: 0.5915, Train f1: 0.5829, Train Precision: 0.5700, Train Recall: 0.5964, Train AUC: 0.6248
Valitadion Loss: 0.6579, Validation Acc: 0.6122, Vall f1: 0.5652, Val Precision: 0.5084, Val Recall: 0.6364, Val AUC: 0.6627
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.81it/s]





































 97%|███████████████████████████████████████████████████████████████████████████████▍  | 95/98 [01:14<00:02,  1.28it/s]
New threshold is 0.49714988470077515
train F1 is 0.6074342727661133
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.29it/s]





 94%|████████████████████████████████████████████████████████████████████████████▋     | 29/31 [00:10<00:00,  2.75it/s]
New threshold is 0.3669893741607666
val F1 is 0.5918367505073547
Epoch 9/40, learning rate: 8.396881661072036e-06
Train Loss: 0.6615, Train Acc: 0.6299, Train f1: 0.6074, Train Precision: 0.6169, Train Recall: 0.5982, Train AUC: 0.6479
Valitadion Loss: 0.6502, Validation Acc: 0.6676, Vall f1: 0.5918, Val Precision: 0.5762, Val Recall: 0.6084, Val AUC: 0.6933
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.81it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▎ | 96/98 [01:15<00:01,  1.28it/s]
New threshold is 0.45469391345977783
train F1 is 0.5909494161605835
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]




 81%|██████████████████████████████████████████████████████████████████▏               | 25/31 [00:09<00:02,  2.75it/s]
New threshold is 0.5633770823478699
val F1 is 0.5787781476974487
Epoch 10/40, learning rate: 6.5388301022836e-06
Train Loss: 0.6589, Train Acc: 0.6060, Train f1: 0.5909, Train Precision: 0.5873, Train Recall: 0.5946, Train AUC: 0.6463
Valitadion Loss: 0.6693, Validation Acc: 0.6371, Vall f1: 0.5788, Val Precision: 0.5357, Val Recall: 0.6294, Val AUC: 0.6722
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:10<00:00,  2.84it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]
  0%|                                                                                           | 0/31 [00:00<?, ?it/s]
New threshold is 0.45695769786834717
train F1 is 0.6390328407287598





 87%|███████████████████████████████████████████████████████████████████████▍          | 27/31 [00:09<00:01,  2.75it/s]
New threshold is 0.5375112295150757
val F1 is 0.6225165724754333
Epoch 11/40, learning rate: 4.808538415182387e-06
Train Loss: 0.6366, Train Acc: 0.6427, Train f1: 0.6390, Train Precision: 0.6187, Train Recall: 0.6607, Train AUC: 0.6917
Valitadion Loss: 0.6513, Validation Acc: 0.6842, Vall f1: 0.6225, Val Precision: 0.5912, Val Recall: 0.6573, Val AUC: 0.7059
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.80it/s]





































 97%|███████████████████████████████████████████████████████████████████████████████▍  | 95/98 [01:14<00:02,  1.29it/s]
New threshold is 0.5081002712249756
train F1 is 0.626185953617096
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]





 94%|████████████████████████████████████████████████████████████████████████████▋     | 29/31 [00:10<00:00,  2.78it/s]
New threshold is 0.4281812310218811
val F1 is 0.6168830990791321
Epoch 12/40, learning rate: 3.269875701408523e-06
Train Loss: 0.6309, Train Acc: 0.6632, Train f1: 0.6262, Train Precision: 0.6680, Train Recall: 0.5893, Train AUC: 0.7029
Valitadion Loss: 0.6274, Validation Acc: 0.6731, Vall f1: 0.6169, Val Precision: 0.5758, Val Recall: 0.6643, Val AUC: 0.7169
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:10<00:00,  2.83it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▎ | 96/98 [01:15<00:01,  1.28it/s]
New threshold is 0.48568615317344666
train F1 is 0.6165556907653809
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]




 81%|██████████████████████████████████████████████████████████████████▏               | 25/31 [00:09<00:02,  2.74it/s]
New threshold is 0.5117312073707581
val F1 is 0.6268656849861145
Epoch 13/40, learning rate: 1.9796375902703355e-06
Train Loss: 0.6227, Train Acc: 0.6556, Train f1: 0.6166, Train Precision: 0.6599, Train Recall: 0.5786, Train AUC: 0.7129
Valitadion Loss: 0.6473, Validation Acc: 0.6537, Vall f1: 0.6269, Val Precision: 0.5469, Val Recall: 0.7343, Val AUC: 0.7146
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.79it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.29it/s]
  0%|                                                                                           | 0/31 [00:00<?, ?it/s]
New threshold is 0.4449276030063629
train F1 is 0.6621043682098389





 87%|███████████████████████████████████████████████████████████████████████▍          | 27/31 [00:09<00:01,  2.74it/s]
New threshold is 0.48012852668762207
val F1 is 0.6300578117370605
Epoch 14/40, learning rate: 9.854497796051008e-07
Train Loss: 0.6131, Train Acc: 0.6624, Train f1: 0.6621, Train Precision: 0.6355, Train Recall: 0.6911, Train AUC: 0.7299
Valitadion Loss: 0.6407, Validation Acc: 0.6454, Vall f1: 0.6301, Val Precision: 0.5369, Val Recall: 0.7622, Val AUC: 0.7116
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.81it/s]





































 97%|███████████████████████████████████████████████████████████████████████████████▍  | 95/98 [01:14<00:02,  1.28it/s]
New threshold is 0.4619067907333374
train F1 is 0.682624101638794
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]





 94%|████████████████████████████████████████████████████████████████████████████▋     | 29/31 [00:10<00:00,  2.73it/s]
New threshold is 0.5121046304702759
val F1 is 0.6103895902633667
Epoch 15/40, learning rate: 3.2401006019694856e-07
Train Loss: 0.6052, Train Acc: 0.6940, Train f1: 0.6826, Train Precision: 0.6778, Train Recall: 0.6875, Train AUC: 0.7473
Valitadion Loss: 0.6363, Validation Acc: 0.6676, Vall f1: 0.6104, Val Precision: 0.5697, Val Recall: 0.6573, Val AUC: 0.7188
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.79it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▎ | 96/98 [01:15<00:01,  1.28it/s]
New threshold is 0.4621956944465637
train F1 is 0.6672598123550415
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]




100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.81it/s]
  0%|                                                                                           | 0/98 [00:00<?, ?it/s]
New threshold is 0.5204728245735168
val F1 is 0.6129032373428345
Epoch 16/40, learning rate: 1.9733714730648627e-08
Train Loss: 0.6026, Train Acc: 0.6803, Train f1: 0.6673, Train Precision: 0.6649, Train Recall: 0.6696, Train AUC: 0.7479
Valitadion Loss: 0.6385, Validation Acc: 0.6676, Vall f1: 0.6129, Val Precision: 0.5689, Val Recall: 0.6643, Val AUC: 0.7187






































 99%|█████████████████████████████████████████████████████████████████████████████████▏| 97/98 [01:15<00:00,  1.28it/s]
New threshold is 0.44745585322380066
train F1 is 0.6575809121131897
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]




 84%|████████████████████████████████████████████████████████████████████▊             | 26/31 [00:09<00:01,  2.71it/s]
New threshold is 0.47202247381210327
val F1 is 0.6206896305084229
Epoch 17/40, learning rate: 1.997901515862922e-05
Train Loss: 0.6292, Train Acc: 0.6564, Train f1: 0.6576, Train Precision: 0.6287, Train Recall: 0.6893, Train AUC: 0.7008
Valitadion Loss: 0.6370, Validation Acc: 0.6648, Vall f1: 0.6207, Val Precision: 0.5625, Val Recall: 0.6923, Val AUC: 0.7133
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.79it/s]





































 97%|███████████████████████████████████████████████████████████████████████████████▍  | 95/98 [01:14<00:02,  1.27it/s]
New threshold is 0.4793224036693573
train F1 is 0.6214788556098938
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]





 87%|███████████████████████████████████████████████████████████████████████▍          | 27/31 [00:09<00:01,  2.73it/s]
New threshold is 0.41049274802207947
val F1 is 0.6191950440406799
Epoch 18/40, learning rate: 1.987066410425045e-05
Train Loss: 0.6377, Train Acc: 0.6325, Train f1: 0.6215, Train Precision: 0.6128, Train Recall: 0.6304, Train AUC: 0.6870
Valitadion Loss: 0.6183, Validation Acc: 0.6593, Vall f1: 0.6192, Val Precision: 0.5556, Val Recall: 0.6993, Val AUC: 0.7235
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.80it/s]





































 97%|███████████████████████████████████████████████████████████████████████████████▍  | 95/98 [01:14<00:02,  1.28it/s]
New threshold is 0.47451967000961304
train F1 is 0.6181172132492065
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]





 94%|████████████████████████████████████████████████████████████████████████████▋     | 29/31 [00:10<00:00,  2.73it/s]
New threshold is 0.4752342998981476
val F1 is 0.6172839403152466
Epoch 19/40, learning rate: 1.9671014630729196e-05
Train Loss: 0.6516, Train Acc: 0.6325, Train f1: 0.6181, Train Precision: 0.6148, Train Recall: 0.6214, Train AUC: 0.6587
Valitadion Loss: 0.6429, Validation Acc: 0.6565, Vall f1: 0.6173, Val Precision: 0.5525, Val Recall: 0.6993, Val AUC: 0.7142
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.80it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▎ | 96/98 [01:15<00:01,  1.27it/s]
New threshold is 0.4808061718940735
train F1 is 0.6245551705360413
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]




100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.79it/s]
  0%|                                                                                           | 0/98 [00:00<?, ?it/s]
New threshold is 0.4277913272380829
val F1 is 0.604651153087616
Epoch 20/40, learning rate: 1.9381913390129176e-05
Train Loss: 0.6405, Train Acc: 0.6393, Train f1: 0.6246, Train Precision: 0.6223, Train Recall: 0.6268, Train AUC: 0.6843
Valitadion Loss: 0.6200, Validation Acc: 0.6704, Vall f1: 0.6047, Val Precision: 0.5759, Val Recall: 0.6364, Val AUC: 0.7335






































 99%|█████████████████████████████████████████████████████████████████████████████████▏| 97/98 [01:15<00:00,  1.28it/s]
New threshold is 0.4824480414390564
train F1 is 0.6376554369926453
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]




 87%|███████████████████████████████████████████████████████████████████████▍          | 27/31 [00:09<00:01,  2.72it/s]
New threshold is 0.30220261216163635
val F1 is 0.6322188377380371
Epoch 21/40, learning rate: 1.900603441606122e-05
Train Loss: 0.6347, Train Acc: 0.6513, Train f1: 0.6377, Train Precision: 0.6343, Train Recall: 0.6411, Train AUC: 0.6915
Valitadion Loss: 0.6337, Validation Acc: 0.6648, Vall f1: 0.6322, Val Precision: 0.5591, Val Recall: 0.7273, Val AUC: 0.7436
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.81it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]
  3%|██▋                                                                                | 1/31 [00:00<00:10,  2.75it/s]
New threshold is 0.4806846082210541
train F1 is 0.6402877569198608





 90%|██████████████████████████████████████████████████████████████████████████        | 28/31 [00:10<00:01,  2.74it/s]
New threshold is 0.5184317231178284
val F1 is 0.6380367875099182
Epoch 22/40, learning rate: 1.8546854390286264e-05
Train Loss: 0.6230, Train Acc: 0.6581, Train f1: 0.6403, Train Precision: 0.6449, Train Recall: 0.6357, Train AUC: 0.7084
Valitadion Loss: 0.6360, Validation Acc: 0.6731, Vall f1: 0.6380, Val Precision: 0.5683, Val Recall: 0.7273, Val AUC: 0.7355
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.80it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▎ | 96/98 [01:15<00:01,  1.28it/s]
New threshold is 0.48532792925834656
train F1 is 0.6348903775215149
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]





 94%|████████████████████████████████████████████████████████████████████████████▋     | 29/31 [00:10<00:00,  2.71it/s]
New threshold is 0.5921743512153625
val F1 is 0.65625
Epoch 23/40, learning rate: 1.8008620485247415e-05
Train Loss: 0.6131, Train Acc: 0.6726, Train f1: 0.6349, Train Precision: 0.6810, Train Recall: 0.5946, Train AUC: 0.7171
Valitadion Loss: 0.6279, Validation Acc: 0.6953, Vall f1: 0.6562, Val Precision: 0.5932, Val Recall: 0.7343, Val AUC: 0.7710
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.80it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▎ | 96/98 [01:15<00:01,  1.26it/s]
New threshold is 0.47322404384613037
train F1 is 0.6678539514541626
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]




100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.79it/s]
  0%|                                                                                           | 0/98 [00:00<?, ?it/s]
New threshold is 0.5234859585762024
val F1 is 0.646258533000946
Epoch 24/40, learning rate: 1.739631107997055e-05
Train Loss: 0.6093, Train Acc: 0.6812, Train f1: 0.6679, Train Precision: 0.6661, Train Recall: 0.6696, Train AUC: 0.7257
Valitadion Loss: 0.6019, Validation Acc: 0.7119, Vall f1: 0.6463, Val Precision: 0.6291, Val Recall: 0.6643, Val AUC: 0.7701






































 99%|█████████████████████████████████████████████████████████████████████████████████▏| 97/98 [01:15<00:00,  1.28it/s]
New threshold is 0.47481295466423035
train F1 is 0.6666666865348816
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]




 81%|██████████████████████████████████████████████████████████████████▏               | 25/31 [00:09<00:02,  2.73it/s]
New threshold is 0.3507622480392456
val F1 is 0.6552901268005371
Epoch 25/40, learning rate: 1.671558971269071e-05
Train Loss: 0.5973, Train Acc: 0.6846, Train f1: 0.6667, Train Precision: 0.6746, Train Recall: 0.6589, Train AUC: 0.7429
Valitadion Loss: 0.5964, Validation Acc: 0.7202, Vall f1: 0.6553, Val Precision: 0.6400, Val Recall: 0.6713, Val AUC: 0.7721
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.81it/s]





































 97%|███████████████████████████████████████████████████████████████████████████████▍  | 95/98 [01:14<00:02,  1.28it/s]
New threshold is 0.4521218240261078
train F1 is 0.683882474899292
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]





 87%|███████████████████████████████████████████████████████████████████████▍          | 27/31 [00:09<00:01,  2.75it/s]
New threshold is 0.4594821333885193
val F1 is 0.6755852699279785
Epoch 26/40, learning rate: 1.597275269611805e-05
Train Loss: 0.5902, Train Acc: 0.6966, Train f1: 0.6839, Train Precision: 0.6821, Train Recall: 0.6857, Train AUC: 0.7466
Valitadion Loss: 0.5839, Validation Acc: 0.7313, Vall f1: 0.6756, Val Precision: 0.6474, Val Recall: 0.7063, Val AUC: 0.7701
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.79it/s]





































 97%|███████████████████████████████████████████████████████████████████████████████▍  | 95/98 [01:14<00:02,  1.28it/s]
New threshold is 0.46901756525039673
train F1 is 0.6808118224143982
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]





 94%|████████████████████████████████████████████████████████████████████████████▋     | 29/31 [00:10<00:00,  2.75it/s]
New threshold is 0.42726951837539673
val F1 is 0.6710097789764404
Epoch 27/40, learning rate: 1.5174670879874512e-05
Train Loss: 0.5586, Train Acc: 0.7043, Train f1: 0.6808, Train Precision: 0.7042, Train Recall: 0.6589, Train AUC: 0.7773
Valitadion Loss: 0.5689, Validation Acc: 0.7202, Vall f1: 0.6710, Val Precision: 0.6280, Val Recall: 0.7203, Val AUC: 0.7873
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.80it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▎ | 96/98 [01:15<00:01,  1.27it/s]
New threshold is 0.49281880259513855
train F1 is 0.6585593819618225
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]




100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.79it/s]
  0%|                                                                                           | 0/98 [00:00<?, ?it/s]
New threshold is 0.5492212772369385
val F1 is 0.6399999856948853
Epoch 28/40, learning rate: 1.432872609876785e-05
Train Loss: 0.6024, Train Acc: 0.6880, Train f1: 0.6586, Train Precision: 0.6916, Train Recall: 0.6286, Train AUC: 0.7341
Valitadion Loss: 0.6053, Validation Acc: 0.7008, Vall f1: 0.6400, Val Precision: 0.6115, Val Recall: 0.6713, Val AUC: 0.7638






































 99%|█████████████████████████████████████████████████████████████████████████████████▏| 97/98 [01:16<00:00,  1.28it/s]
New threshold is 0.46129074692726135
train F1 is 0.7324200868606567
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]




 84%|████████████████████████████████████████████████████████████████████▊             | 26/31 [00:09<00:01,  2.72it/s]
New threshold is 0.5651289224624634
val F1 is 0.6666666865348816
Epoch 29/40, learning rate: 1.3442742894722841e-05
Train Loss: 0.5291, Train Acc: 0.7496, Train f1: 0.7324, Train Precision: 0.7495, Train Recall: 0.7161, Train AUC: 0.8124
Valitadion Loss: 0.6378, Validation Acc: 0.7036, Vall f1: 0.6667, Val Precision: 0.6011, Val Recall: 0.7483, Val AUC: 0.7658
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.80it/s]





































 97%|███████████████████████████████████████████████████████████████████████████████▍  | 95/98 [01:14<00:02,  1.29it/s]
New threshold is 0.41318485140800476
train F1 is 0.7452991604804993
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]





 90%|██████████████████████████████████████████████████████████████████████████        | 28/31 [00:10<00:01,  2.73it/s]
New threshold is 0.48668840527534485
val F1 is 0.6484641432762146
Epoch 30/40, learning rate: 1.2524916143905793e-05
Train Loss: 0.5139, Train Acc: 0.7453, Train f1: 0.7453, Train Precision: 0.7148, Train Recall: 0.7786, Train AUC: 0.8229
Valitadion Loss: 0.5795, Validation Acc: 0.7147, Vall f1: 0.6485, Val Precision: 0.6333, Val Recall: 0.6643, Val AUC: 0.7717
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.80it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▎ | 96/98 [01:15<00:01,  1.27it/s]
New threshold is 0.4569729268550873
train F1 is 0.7373188138008118
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]





 94%|████████████████████████████████████████████████████████████████████████████▋     | 29/31 [00:10<00:00,  2.72it/s]
New threshold is 0.5195751786231995
val F1 is 0.6666666865348816
Epoch 31/40, learning rate: 1.1583735258453106e-05
Train Loss: 0.5180, Train Acc: 0.7521, Train f1: 0.7373, Train Precision: 0.7482, Train Recall: 0.7268, Train AUC: 0.8206
Valitadion Loss: 0.5876, Validation Acc: 0.7258, Vall f1: 0.6667, Val Precision: 0.6429, Val Recall: 0.6923, Val AUC: 0.7759
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.78it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▎ | 96/98 [01:15<00:01,  1.28it/s]
New threshold is 0.4457618296146393
train F1 is 0.7627416253089905
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]




100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.80it/s]
  0%|                                                                                           | 0/98 [00:00<?, ?it/s]
New threshold is 0.36239343881607056
val F1 is 0.684385359287262
Epoch 32/40, learning rate: 1.0627905663897875e-05
Train Loss: 0.4843, Train Acc: 0.7692, Train f1: 0.7627, Train Precision: 0.7509, Train Recall: 0.7750, Train AUC: 0.8479
Valitadion Loss: 0.5490, Validation Acc: 0.7368, Vall f1: 0.6844, Val Precision: 0.6519, Val Recall: 0.7203, Val AUC: 0.7950






































 98%|████████████████████████████████████████████████████████████████████████████████▎ | 96/98 [01:15<00:01,  1.28it/s]
New threshold is 0.40910786390304565
train F1 is 0.7855887413024902
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]




 81%|██████████████████████████████████████████████████████████████████▏               | 25/31 [00:09<00:02,  2.77it/s]
New threshold is 0.5199188590049744
val F1 is 0.680272102355957
Epoch 33/40, learning rate: 9.666268278586751e-06
Train Loss: 0.4636, Train Acc: 0.7915, Train f1: 0.7856, Train Precision: 0.7734, Train Recall: 0.7982, Train AUC: 0.8633
Valitadion Loss: 0.5876, Validation Acc: 0.7396, Vall f1: 0.6803, Val Precision: 0.6623, Val Recall: 0.6993, Val AUC: 0.7834
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.80it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]
  0%|                                                                                           | 0/31 [00:00<?, ?it/s]
New threshold is 0.3991450369358063
train F1 is 0.794400691986084





 87%|███████████████████████████████████████████████████████████████████████▍          | 27/31 [00:09<00:01,  2.71it/s]
New threshold is 0.5664377808570862
val F1 is 0.6644295454025269
Epoch 34/40, learning rate: 8.707717739859963e-06
Train Loss: 0.4241, Train Acc: 0.7991, Train f1: 0.7944, Train Precision: 0.7787, Train Recall: 0.8107, Train AUC: 0.8876
Valitadion Loss: 0.5980, Validation Acc: 0.7230, Vall f1: 0.6644, Val Precision: 0.6387, Val Recall: 0.6923, Val AUC: 0.7832
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.80it/s]





































 97%|███████████████████████████████████████████████████████████████████████████████▍  | 95/98 [01:14<00:02,  1.28it/s]
New threshold is 0.4382418990135193
train F1 is 0.7996422052383423
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]





 94%|████████████████████████████████████████████████████████████████████████████▋     | 29/31 [00:10<00:00,  2.73it/s]
New threshold is 0.5215614438056946
val F1 is 0.6866666674613953
Epoch 35/40, learning rate: 7.761120133359041e-06
Train Loss: 0.4246, Train Acc: 0.8085, Train f1: 0.7996, Train Precision: 0.8011, Train Recall: 0.7982, Train AUC: 0.8865
Valitadion Loss: 0.5727, Validation Acc: 0.7396, Vall f1: 0.6867, Val Precision: 0.6561, Val Recall: 0.7203, Val AUC: 0.7904
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.79it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▎ | 96/98 [01:15<00:01,  1.28it/s]
New threshold is 0.4261365234851837
train F1 is 0.8243727684020996
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]




100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.81it/s]
  0%|                                                                                           | 0/98 [00:00<?, ?it/s]
New threshold is 0.5559785962104797
val F1 is 0.6790123581886292
Epoch 36/40, learning rate: 6.8352309864226235e-06
Train Loss: 0.3910, Train Acc: 0.8325, Train f1: 0.8244, Train Precision: 0.8273, Train Recall: 0.8214, Train AUC: 0.9053
Valitadion Loss: 0.6369, Validation Acc: 0.7119, Vall f1: 0.6790, Val Precision: 0.6077, Val Recall: 0.7692, Val AUC: 0.7793






































 99%|█████████████████████████████████████████████████████████████████████████████████▏| 97/98 [01:16<00:00,  1.28it/s]
New threshold is 0.41181790828704834
train F1 is 0.8149465918540955
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]




 84%|████████████████████████████████████████████████████████████████████▊             | 26/31 [00:09<00:01,  2.71it/s]
New threshold is 0.36747658252716064
val F1 is 0.6907894611358643
Epoch 37/40, learning rate: 5.938614284088162e-06
Train Loss: 0.4059, Train Acc: 0.8222, Train f1: 0.8149, Train Precision: 0.8121, Train Recall: 0.8179, Train AUC: 0.8954
Valitadion Loss: 0.5710, Validation Acc: 0.7396, Vall f1: 0.6908, Val Precision: 0.6522, Val Recall: 0.7343, Val AUC: 0.7909
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.79it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]
  0%|                                                                                           | 0/31 [00:00<?, ?it/s]
New threshold is 0.41722020506858826
train F1 is 0.8453426957130432





 87%|███████████████████████████████████████████████████████████████████████▍          | 27/31 [00:09<00:01,  2.72it/s]
New threshold is 0.3637712299823761
val F1 is 0.690095841884613
Epoch 38/40, learning rate: 5.079563256758586e-06
Train Loss: 0.3611, Train Acc: 0.8496, Train f1: 0.8453, Train Precision: 0.8322, Train Recall: 0.8589, Train AUC: 0.9228
Valitadion Loss: 0.6096, Validation Acc: 0.7313, Vall f1: 0.6901, Val Precision: 0.6353, Val Recall: 0.7552, Val AUC: 0.7817
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.80it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▎ | 96/98 [01:15<00:01,  1.27it/s]
New threshold is 0.4135957658290863
train F1 is 0.8515555262565613
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]





 94%|████████████████████████████████████████████████████████████████████████████▋     | 29/31 [00:10<00:00,  2.72it/s]
New threshold is 0.5578347444534302
val F1 is 0.6732673048973083
Epoch 39/40, learning rate: 4.266023672206203e-06
Train Loss: 0.3465, Train Acc: 0.8573, Train f1: 0.8516, Train Precision: 0.8478, Train Recall: 0.8554, Train AUC: 0.9269
Valitadion Loss: 0.6244, Validation Acc: 0.7258, Vall f1: 0.6733, Val Precision: 0.6375, Val Recall: 0.7133, Val AUC: 0.7815
100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.78it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▎ | 96/98 [01:15<00:01,  1.27it/s]
New threshold is 0.4157632291316986
train F1 is 0.8578947186470032
100%|██████████████████████████████████████████████████████████████████████████████████| 98/98 [01:16<00:00,  1.28it/s]




100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:11<00:00,  2.80it/s]
  0%|                                                                                           | 0/31 [00:00<?, ?it/s]
New threshold is 0.518638014793396
val F1 is 0.6710963249206543
Epoch 40/40, learning rate: 3.505520341422189e-06
Train Loss: 0.3383, Train Acc: 0.8615, Train f1: 0.8579, Train Precision: 0.8431, Train Recall: 0.8732, Train AUC: 0.9330
Valitadion Loss: 0.6101, Validation Acc: 0.7258, Vall f1: 0.6711, Val Precision: 0.6392, Val Recall: 0.7063, Val AUC: 0.7790
Training complete in 58m 27s
Best val auc: 0.690789






 97%|███████████████████████████████████████████████████████████████████████████████▎  | 30/31 [00:12<00:00,  2.75it/s]
New threshold is 0.518638014793396
Inference complete in 0m 12s
F1 Score = : 0.671096
AUC Score = : 0.778982

100%|██████████████████████████████████████████████████████████████████████████████████| 31/31 [00:12<00:00,  2.56it/s]