
  1%|▉                                                                                  | 1/84 [00:01<01:32,  1.11s/it]
stem.conv.weight
stem.conv.bias
stem.norm.weight
stem.norm.bias
stages.0.blocks.0.0.cpe1.proj.weight
stages.0.blocks.0.0.cpe1.proj.bias
stages.0.blocks.0.0.norm1.weight
stages.0.blocks.0.0.norm1.bias
stages.0.blocks.0.0.attn.qkv.weight
stages.0.blocks.0.0.attn.qkv.bias
stages.0.blocks.0.0.attn.proj.weight
stages.0.blocks.0.0.attn.proj.bias
stages.0.blocks.0.0.cpe2.proj.weight
stages.0.blocks.0.0.cpe2.proj.bias
stages.0.blocks.0.0.norm2.weight
stages.0.blocks.0.0.norm2.bias
stages.0.blocks.0.0.mlp.fc1.weight
stages.0.blocks.0.0.mlp.fc1.bias
stages.0.blocks.0.0.mlp.fc2.weight
stages.0.blocks.0.0.mlp.fc2.bias
stages.0.blocks.0.1.cpe1.proj.weight
stages.0.blocks.0.1.cpe1.proj.bias
stages.0.blocks.0.1.norm1.weight
stages.0.blocks.0.1.norm1.bias
stages.0.blocks.0.1.attn.qkv.weight
stages.0.blocks.0.1.attn.qkv.bias
stages.0.blocks.0.1.attn.proj.weight
stages.0.blocks.0.1.attn.proj.bias
stages.0.blocks.0.1.cpe2.proj.weight
stages.0.blocks.0.1.cpe2.proj.bias
stages.0.blocks.0.1.norm2.weight
stages.0.blocks.0.1.norm2.bias
stages.0.blocks.0.1.mlp.fc1.weight
stages.0.blocks.0.1.mlp.fc1.bias
stages.0.blocks.0.1.mlp.fc2.weight
stages.0.blocks.0.1.mlp.fc2.bias
stages.1.downsample.norm.weight
stages.1.downsample.norm.bias
stages.1.downsample.conv.weight
stages.1.downsample.conv.bias
stages.1.blocks.0.0.cpe1.proj.weight
stages.1.blocks.0.0.cpe1.proj.bias
stages.1.blocks.0.0.norm1.weight
stages.1.blocks.0.0.norm1.bias
stages.1.blocks.0.0.attn.qkv.weight
stages.1.blocks.0.0.attn.qkv.bias
stages.1.blocks.0.0.attn.proj.weight
stages.1.blocks.0.0.attn.proj.bias
stages.1.blocks.0.0.cpe2.proj.weight
stages.1.blocks.0.0.cpe2.proj.bias
stages.1.blocks.0.0.norm2.weight
stages.1.blocks.0.0.norm2.bias
stages.1.blocks.0.0.mlp.fc1.weight
stages.1.blocks.0.0.mlp.fc1.bias
stages.1.blocks.0.0.mlp.fc2.weight
stages.1.blocks.0.0.mlp.fc2.bias
stages.1.blocks.0.1.cpe1.proj.weight
stages.1.blocks.0.1.cpe1.proj.bias
stages.1.blocks.0.1.norm1.weight
stages.1.blocks.0.1.norm1.bias
stages.1.blocks.0.1.attn.qkv.weight
stages.1.blocks.0.1.attn.qkv.bias
stages.1.blocks.0.1.attn.proj.weight
stages.1.blocks.0.1.attn.proj.bias
stages.1.blocks.0.1.cpe2.proj.weight
stages.1.blocks.0.1.cpe2.proj.bias
stages.1.blocks.0.1.norm2.weight
stages.1.blocks.0.1.norm2.bias
stages.1.blocks.0.1.mlp.fc1.weight
stages.1.blocks.0.1.mlp.fc1.bias
stages.1.blocks.0.1.mlp.fc2.weight
stages.1.blocks.0.1.mlp.fc2.bias
stages.2.downsample.norm.weight
stages.2.downsample.norm.bias
stages.2.downsample.conv.weight
stages.2.downsample.conv.bias
stages.2.blocks.0.0.cpe1.proj.weight
stages.2.blocks.0.0.cpe1.proj.bias
stages.2.blocks.0.0.norm1.weight
stages.2.blocks.0.0.norm1.bias
stages.2.blocks.0.0.attn.qkv.weight
stages.2.blocks.0.0.attn.qkv.bias
stages.2.blocks.0.0.attn.proj.weight
stages.2.blocks.0.0.attn.proj.bias
stages.2.blocks.0.0.cpe2.proj.weight
stages.2.blocks.0.0.cpe2.proj.bias
stages.2.blocks.0.0.norm2.weight
stages.2.blocks.0.0.norm2.bias
stages.2.blocks.0.0.mlp.fc1.weight
stages.2.blocks.0.0.mlp.fc1.bias
stages.2.blocks.0.0.mlp.fc2.weight
stages.2.blocks.0.0.mlp.fc2.bias
stages.2.blocks.0.1.cpe1.proj.weight
stages.2.blocks.0.1.cpe1.proj.bias
stages.2.blocks.0.1.norm1.weight
stages.2.blocks.0.1.norm1.bias
stages.2.blocks.0.1.attn.qkv.weight
stages.2.blocks.0.1.attn.qkv.bias
stages.2.blocks.0.1.attn.proj.weight
stages.2.blocks.0.1.attn.proj.bias
stages.2.blocks.0.1.cpe2.proj.weight
stages.2.blocks.0.1.cpe2.proj.bias
stages.2.blocks.0.1.norm2.weight
stages.2.blocks.0.1.norm2.bias
stages.2.blocks.0.1.mlp.fc1.weight
stages.2.blocks.0.1.mlp.fc1.bias
stages.2.blocks.0.1.mlp.fc2.weight
stages.2.blocks.0.1.mlp.fc2.bias
stages.2.blocks.1.0.cpe1.proj.weight
stages.2.blocks.1.0.cpe1.proj.bias
stages.2.blocks.1.0.norm1.weight
stages.2.blocks.1.0.norm1.bias
stages.2.blocks.1.0.attn.qkv.weight
stages.2.blocks.1.0.attn.qkv.bias
stages.2.blocks.1.0.attn.proj.weight
stages.2.blocks.1.0.attn.proj.bias
stages.2.blocks.1.0.cpe2.proj.weight
stages.2.blocks.1.0.cpe2.proj.bias
stages.2.blocks.1.0.norm2.weight
stages.2.blocks.1.0.norm2.bias
stages.2.blocks.1.0.mlp.fc1.weight
stages.2.blocks.1.0.mlp.fc1.bias
stages.2.blocks.1.0.mlp.fc2.weight
stages.2.blocks.1.0.mlp.fc2.bias
stages.2.blocks.1.1.cpe1.proj.weight
stages.2.blocks.1.1.cpe1.proj.bias
stages.2.blocks.1.1.norm1.weight
stages.2.blocks.1.1.norm1.bias
stages.2.blocks.1.1.attn.qkv.weight
stages.2.blocks.1.1.attn.qkv.bias
stages.2.blocks.1.1.attn.proj.weight
stages.2.blocks.1.1.attn.proj.bias
stages.2.blocks.1.1.cpe2.proj.weight
stages.2.blocks.1.1.cpe2.proj.bias
stages.2.blocks.1.1.norm2.weight
stages.2.blocks.1.1.norm2.bias
stages.2.blocks.1.1.mlp.fc1.weight
stages.2.blocks.1.1.mlp.fc1.bias
stages.2.blocks.1.1.mlp.fc2.weight
stages.2.blocks.1.1.mlp.fc2.bias
stages.2.blocks.2.0.cpe1.proj.weight
stages.2.blocks.2.0.cpe1.proj.bias
stages.2.blocks.2.0.norm1.weight
stages.2.blocks.2.0.norm1.bias
stages.2.blocks.2.0.attn.qkv.weight
stages.2.blocks.2.0.attn.qkv.bias
stages.2.blocks.2.0.attn.proj.weight
stages.2.blocks.2.0.attn.proj.bias
stages.2.blocks.2.0.cpe2.proj.weight
stages.2.blocks.2.0.cpe2.proj.bias
stages.2.blocks.2.0.norm2.weight
stages.2.blocks.2.0.norm2.bias
stages.2.blocks.2.0.mlp.fc1.weight
stages.2.blocks.2.0.mlp.fc1.bias
stages.2.blocks.2.0.mlp.fc2.weight
stages.2.blocks.2.0.mlp.fc2.bias
stages.2.blocks.2.1.cpe1.proj.weight
stages.2.blocks.2.1.cpe1.proj.bias
stages.2.blocks.2.1.norm1.weight
stages.2.blocks.2.1.norm1.bias
stages.2.blocks.2.1.attn.qkv.weight
stages.2.blocks.2.1.attn.qkv.bias
stages.2.blocks.2.1.attn.proj.weight
stages.2.blocks.2.1.attn.proj.bias
stages.2.blocks.2.1.cpe2.proj.weight
stages.2.blocks.2.1.cpe2.proj.bias
stages.2.blocks.2.1.norm2.weight
stages.2.blocks.2.1.norm2.bias
stages.2.blocks.2.1.mlp.fc1.weight
stages.2.blocks.2.1.mlp.fc1.bias
stages.2.blocks.2.1.mlp.fc2.weight
stages.2.blocks.2.1.mlp.fc2.bias
stages.3.downsample.norm.weight
stages.3.downsample.norm.bias
stages.3.downsample.conv.weight
stages.3.downsample.conv.bias
stages.3.blocks.0.0.cpe1.proj.weight
stages.3.blocks.0.0.cpe1.proj.bias
stages.3.blocks.0.0.norm1.weight
stages.3.blocks.0.0.norm1.bias
stages.3.blocks.0.0.attn.qkv.weight
stages.3.blocks.0.0.attn.qkv.bias
stages.3.blocks.0.0.attn.proj.weight
stages.3.blocks.0.0.attn.proj.bias
stages.3.blocks.0.0.cpe2.proj.weight
stages.3.blocks.0.0.cpe2.proj.bias
stages.3.blocks.0.0.norm2.weight
stages.3.blocks.0.0.norm2.bias
stages.3.blocks.0.0.mlp.fc1.weight
stages.3.blocks.0.0.mlp.fc1.bias
stages.3.blocks.0.0.mlp.fc2.weight
stages.3.blocks.0.0.mlp.fc2.bias
stages.3.blocks.0.1.cpe1.proj.weight
stages.3.blocks.0.1.cpe1.proj.bias
stages.3.blocks.0.1.norm1.weight
stages.3.blocks.0.1.norm1.bias
stages.3.blocks.0.1.attn.qkv.weight
stages.3.blocks.0.1.attn.qkv.bias
stages.3.blocks.0.1.attn.proj.weight
stages.3.blocks.0.1.attn.proj.bias
stages.3.blocks.0.1.cpe2.proj.weight
stages.3.blocks.0.1.cpe2.proj.bias
stages.3.blocks.0.1.norm2.weight
stages.3.blocks.0.1.norm2.bias
stages.3.blocks.0.1.mlp.fc1.weight
stages.3.blocks.0.1.mlp.fc1.bias
stages.3.blocks.0.1.mlp.fc2.weight
stages.3.blocks.0.1.mlp.fc2.bias
head.norm.weight
head.norm.bias
head.fc.weight
head.fc.bias
head.fc.bias
DaVit(
  (stem): Stem(
    (conv): Conv2d(3, 96, kernel_size=(7, 7), stride=(4, 4), padding=(3, 3))
    (norm): LayerNorm2d((96,), eps=1e-05, elementwise_affine=True)
  )
  (stages): Sequential(
    (0): DaVitStage(
      (downsample): Identity()
      (blocks): Sequential(
        (0): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=96)
              (act): Identity()
            )
            (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=96, out_features=288, bias=True)
              (proj): Linear(in_features=96, out_features=96, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=96)
              (act): Identity()
            )
            (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=96, out_features=384, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=384, out_features=96, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=96)
              (act): Identity()
            )
            (norm1): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=96, out_features=288, bias=True)
              (proj): Linear(in_features=96, out_features=96, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=96)
              (act): Identity()
            )
            (norm2): LayerNorm((96,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=96, out_features=384, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=384, out_features=96, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
      )
    )
    (1): DaVitStage(
      (downsample): Downsample(
        (norm): LayerNorm2d((96,), eps=1e-05, elementwise_affine=True)
        (conv): Conv2d(96, 192, kernel_size=(2, 2), stride=(2, 2))
      )
      (blocks): Sequential(
        (0): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192)
              (act): Identity()
            )
            (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=192, out_features=576, bias=True)
              (proj): Linear(in_features=192, out_features=192, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192)
              (act): Identity()
            )
            (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=192, out_features=768, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=768, out_features=192, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192)
              (act): Identity()
            )
            (norm1): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=192, out_features=576, bias=True)
              (proj): Linear(in_features=192, out_features=192, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(192, 192, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=192)
              (act): Identity()
            )
            (norm2): LayerNorm((192,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=192, out_features=768, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=768, out_features=192, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
      )
    )
    (2): DaVitStage(
      (downsample): Downsample(
        (norm): LayerNorm2d((192,), eps=1e-05, elementwise_affine=True)
        (conv): Conv2d(192, 384, kernel_size=(2, 2), stride=(2, 2))
      )
      (blocks): Sequential(
        (0): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
        (1): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
        (2): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm1): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=384, out_features=1152, bias=True)
              (proj): Linear(in_features=384, out_features=384, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(384, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=384)
              (act): Identity()
            )
            (norm2): LayerNorm((384,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=384, out_features=1536, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=1536, out_features=384, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
      )
    )
    (3): DaVitStage(
      (downsample): Downsample(
        (norm): LayerNorm2d((384,), eps=1e-05, elementwise_affine=True)
        (conv): Conv2d(384, 768, kernel_size=(2, 2), stride=(2, 2))
      )
      (blocks): Sequential(
        (0): Sequential(
          (0): SpatialBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(768, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=768)
              (act): Identity()
            )
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): WindowAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (proj): Linear(in_features=768, out_features=768, bias=True)
              (softmax): Softmax(dim=-1)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(768, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=768)
              (act): Identity()
            )
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
          (1): ChannelBlock(
            (cpe1): ConvPosEnc(
              (proj): Conv2d(768, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=768)
              (act): Identity()
            )
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): ChannelAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (proj): Linear(in_features=768, out_features=768, bias=True)
            )
            (drop_path1): Identity()
            (cpe2): ConvPosEnc(
              (proj): Conv2d(768, 768, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=768)
              (act): Identity()
            )
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.0, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (drop2): Dropout(p=0.0, inplace=False)
            )
            (drop_path2): Identity()
          )
        )
      )
    )
  )
  (norm_pre): Identity()
  (head): NormMlpClassifierHead(
    (global_pool): SelectAdaptivePool2d(pool_type=avg, flatten=Identity())
    (norm): LayerNorm2d((768,), eps=1e-05, elementwise_affine=True)
    (flatten): Flatten(start_dim=1, end_dim=-1)
    (pre_logits): Identity()
    (drop): Dropout(p=0.0, inplace=False)
    (fc): Sequential(
      (0): Dropout(p=0.2, inplace=False)
      (1): Linear(in_features=768, out_features=64, bias=False)
      (2): GELU(approximate='none')
      (3): Linear(in_features=64, out_features=1, bias=False)
      (4): Sigmoid()
    )
  )
)
Starting training...
--------------------





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.09it/s]
New threshold is 0.43004053831100464
train F1 is 0.4860486090183258
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:06<00:01,  2.47it/s]
New threshold is 0.41534900665283203
val F1 is 0.4920634925365448
Epoch 1/40, learning rate: 1.9864292578550327e-05
Train Loss: 0.6798, Train Acc: 0.5103, Train f1: 0.4860, Train Precision: 0.4286, Train Recall: 0.5613, Train AUC: 0.5064
Valitadion Loss: 0.6799, Validation Acc: 0.5524, Vall f1: 0.4921, Val Precision: 0.4662, Val Recall: 0.5210, Val AUC: 0.5475
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.49it/s]





































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:14<00:02,  1.09it/s]
New threshold is 0.4122850000858307
train F1 is 0.4768472909927368

100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:07<00:00,  2.45it/s]
New threshold is 0.380761981010437
val F1 is 0.5284552574157715
Epoch 2/40, learning rate: 1.9460853615232776e-05
Train Loss: 0.6731, Train Acc: 0.5446, Train f1: 0.4768, Train Precision: 0.4532, Train Recall: 0.5031, Train AUC: 0.5495
Valitadion Loss: 0.6750, Validation Acc: 0.5944, Vall f1: 0.5285, Val Precision: 0.5118, Val Recall: 0.5462, Val AUC: 0.6061
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.51it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.09it/s]
New threshold is 0.4268985688686371
train F1 is 0.5357798337936401
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.42it/s]
New threshold is 0.33826199173927307
val F1 is 0.5703421831130981
Epoch 3/40, learning rate: 1.8800633042879672e-05
Train Loss: 0.6675, Train Acc: 0.5660, Train f1: 0.5358, Train Precision: 0.4795, Train Recall: 0.6071, Train AUC: 0.5793
Valitadion Loss: 0.6788, Validation Acc: 0.6049, Vall f1: 0.5703, Val Precision: 0.5208, Val Recall: 0.6303, Val AUC: 0.6368
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.50it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 83/84 [01:16<00:00,  1.08it/s]
New threshold is 0.4054240584373474
train F1 is 0.48848849534988403
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.09it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.42it/s]
New threshold is 0.4125211536884308
val F1 is 0.568493127822876
Epoch 4/40, learning rate: 1.79015502286794e-05
Train Loss: 0.6724, Train Acc: 0.5617, Train f1: 0.4885, Train Precision: 0.4710, Train Recall: 0.5073, Train AUC: 0.5635
Valitadion Loss: 0.6723, Validation Acc: 0.5594, Vall f1: 0.5685, Val Precision: 0.4798, Val Recall: 0.6975, Val AUC: 0.6011
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.48it/s]





































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:14<00:02,  1.09it/s]
New threshold is 0.42769724130630493
train F1 is 0.53515625
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.45it/s]
New threshold is 0.3574891984462738
val F1 is 0.5677965879440308
Epoch 5/40, learning rate: 1.678800761592905e-05
Train Loss: 0.6617, Train Acc: 0.5918, Train f1: 0.5352, Train Precision: 0.5046, Train Recall: 0.5696, Train AUC: 0.6076
Valitadion Loss: 0.6651, Validation Acc: 0.6434, Vall f1: 0.5678, Val Precision: 0.5726, Val Recall: 0.5630, Val AUC: 0.6553
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.51it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 83/84 [01:16<00:00,  1.09it/s]
New threshold is 0.40252164006233215
train F1 is 0.561020016670227
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.10it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.41it/s]
New threshold is 0.3501017987728119
val F1 is 0.6000000238418579
Epoch 6/40, learning rate: 1.549022840546991e-05
Train Loss: 0.6533, Train Acc: 0.5866, Train f1: 0.5610, Train Precision: 0.4992, Train Recall: 0.6403, Train AUC: 0.6282
Valitadion Loss: 0.6601, Validation Acc: 0.6224, Vall f1: 0.6000, Val Precision: 0.5364, Val Recall: 0.6807, Val AUC: 0.6622
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.48it/s]





































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:14<00:02,  1.08it/s]
New threshold is 0.4065994620323181
train F1 is 0.5569143891334534
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.09it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.45it/s]
New threshold is 0.4011493921279907
val F1 is 0.5777778029441833
Epoch 7/40, learning rate: 1.4043436253115652e-05
Train Loss: 0.6451, Train Acc: 0.5961, Train f1: 0.5569, Train Precision: 0.5086, Train Recall: 0.6154, Train AUC: 0.6492
Valitadion Loss: 0.6558, Validation Acc: 0.6014, Vall f1: 0.5778, Val Precision: 0.5166, Val Recall: 0.6555, Val AUC: 0.6441
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.51it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.09it/s]
New threshold is 0.41803500056266785
train F1 is 0.5764499306678772
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.09it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.42it/s]
New threshold is 0.48402419686317444
val F1 is 0.5647059082984924
Epoch 8/40, learning rate: 1.2486899247303603e-05
Train Loss: 0.6515, Train Acc: 0.5866, Train f1: 0.5764, Train Precision: 0.4992, Train Recall: 0.6819, Train AUC: 0.6268
Valitadion Loss: 0.6636, Validation Acc: 0.6119, Vall f1: 0.5647, Val Precision: 0.5294, Val Recall: 0.6050, Val AUC: 0.6628
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.48it/s]





































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:14<00:02,  1.08it/s]
New threshold is 0.40362927317619324
train F1 is 0.5887764692306519
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.09it/s]




 95%|██████████████████████████████████████████████████████████████████████████████    | 20/21 [00:08<00:00,  2.44it/s]
New threshold is 0.4837062954902649
val F1 is 0.5916666388511658
Epoch 9/40, learning rate: 1.0862864114836052e-05
Train Loss: 0.6451, Train Acc: 0.6166, Train f1: 0.5888, Train Precision: 0.5281, Train Recall: 0.6653, Train AUC: 0.6491
Valitadion Loss: 0.6430, Validation Acc: 0.6573, Vall f1: 0.5917, Val Precision: 0.5868, Val Recall: 0.5966, Val AUC: 0.6844
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.48it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.08it/s]
New threshold is 0.43769124150276184
train F1 is 0.5878962278366089
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.09it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.42it/s]
New threshold is 0.44428232312202454
val F1 is 0.6299212574958801
Epoch 10/40, learning rate: 9.215409581951101e-06
Train Loss: 0.6312, Train Acc: 0.6321, Train f1: 0.5879, Train Precision: 0.5464, Train Recall: 0.6362, Train AUC: 0.6743
Valitadion Loss: 0.6401, Validation Acc: 0.6713, Vall f1: 0.6299, Val Precision: 0.5926, Val Recall: 0.6723, Val AUC: 0.6776
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.49it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.08it/s]
New threshold is 0.39417657256126404
train F1 is 0.6290322542190552
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:16<00:00,  1.09it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.42it/s]
New threshold is 0.44643735885620117
val F1 is 0.6320000290870667
Epoch 11/40, learning rate: 7.589250012207144e-06
Train Loss: 0.6307, Train Acc: 0.6449, Train f1: 0.6290, Train Precision: 0.5528, Train Recall: 0.7297, Train AUC: 0.6845
Valitadion Loss: 0.6449, Validation Acc: 0.6783, Vall f1: 0.6320, Val Precision: 0.6031, Val Recall: 0.6639, Val AUC: 0.6748
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.48it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.08it/s]
New threshold is 0.4685058891773224
train F1 is 0.5736738443374634
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.09it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.43it/s]
New threshold is 0.4945250153541565
val F1 is 0.6166008114814758
Epoch 12/40, learning rate: 6.0285217922261386e-06
Train Loss: 0.6357, Train Acc: 0.6278, Train f1: 0.5737, Train Precision: 0.5438, Train Recall: 0.6071, Train AUC: 0.6672
Valitadion Loss: 0.6407, Validation Acc: 0.6608, Vall f1: 0.6166, Val Precision: 0.5821, Val Recall: 0.6555, Val AUC: 0.6845
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.48it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.09it/s]
  0%|                                                                                           | 0/21 [00:00<?, ?it/s]
New threshold is 0.40503016114234924
train F1 is 0.6509519219398499




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:07<00:00,  2.41it/s]
New threshold is 0.5319117903709412
val F1 is 0.624535322189331
Epoch 13/40, learning rate: 4.5755854045895805e-06
Train Loss: 0.6035, Train Acc: 0.6698, Train f1: 0.6510, Train Precision: 0.5772, Train Recall: 0.7464, Train AUC: 0.7205
Valitadion Loss: 0.6430, Validation Acc: 0.6469, Vall f1: 0.6245, Val Precision: 0.5600, Val Recall: 0.7059, Val AUC: 0.6884
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]





































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:15<00:02,  1.08it/s]
New threshold is 0.4134092330932617
train F1 is 0.6531365513801575
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.09it/s]




 95%|██████████████████████████████████████████████████████████████████████████████    | 20/21 [00:08<00:00,  2.41it/s]
New threshold is 0.540661096572876
val F1 is 0.6240601539611816
Epoch 14/40, learning rate: 3.269875701408523e-06
Train Loss: 0.5999, Train Acc: 0.6775, Train f1: 0.6531, Train Precision: 0.5871, Train Recall: 0.7360, Train AUC: 0.7265
Valitadion Loss: 0.6422, Validation Acc: 0.6503, Vall f1: 0.6241, Val Precision: 0.5646, Val Recall: 0.6975, Val AUC: 0.6902
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.47it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:15<00:01,  1.08it/s]
New threshold is 0.4682167172431946
train F1 is 0.662135899066925
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.09it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.41it/s]
New threshold is 0.5175766944885254
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]
  0%|                                                                                           | 0/84 [00:00<?, ?it/s]
Epoch 15/40, learning rate: 2.146831583851016e-06
Train Loss: 0.5850, Train Acc: 0.7015, Train f1: 0.6621, Train Precision: 0.6211, Train Recall: 0.7089, Train AUC: 0.7452
Valitadion Loss: 0.6401, Validation Acc: 0.6678, Vall f1: 0.6545, Val Precision: 0.5769, Val Recall: 0.7563, Val AUC: 0.6914






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.07it/s]
New threshold is 0.41882604360580444
train F1 is 0.675000011920929
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.09it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.37it/s]
New threshold is 0.4498905539512634
val F1 is 0.6494464874267578
Epoch 16/40, learning rate: 1.2369341377147044e-06
Train Loss: 0.5870, Train Acc: 0.6878, Train f1: 0.6750, Train Precision: 0.5915, Train Recall: 0.7859, Train AUC: 0.7400
Valitadion Loss: 0.6235, Validation Acc: 0.6678, Vall f1: 0.6494, Val Precision: 0.5789, Val Recall: 0.7395, Val AUC: 0.7074
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.44it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.08it/s]
New threshold is 0.44636204838752747
train F1 is 0.6609029769897461
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.09it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.38it/s]
New threshold is 0.4928305149078369
val F1 is 0.654275119304657
Epoch 17/40, learning rate: 5.648793314741472e-07
Train Loss: 0.5780, Train Acc: 0.6973, Train f1: 0.6609, Train Precision: 0.6143, Train Recall: 0.7152, Train AUC: 0.7559
Valitadion Loss: 0.6248, Validation Acc: 0.6748, Vall f1: 0.6543, Val Precision: 0.5867, Val Recall: 0.7395, Val AUC: 0.7099
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.45it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.08it/s]
New threshold is 0.4269121587276459
train F1 is 0.6798493266105652
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.09it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.39it/s]
New threshold is 0.5009838938713074
val F1 is 0.654275119304657
Epoch 18/40, learning rate: 1.4890773100692442e-07
Train Loss: 0.5691, Train Acc: 0.7084, Train f1: 0.6798, Train Precision: 0.6213, Train Recall: 0.7505, Train AUC: 0.7666
Valitadion Loss: 0.6265, Validation Acc: 0.6748, Vall f1: 0.6543, Val Precision: 0.5867, Val Recall: 0.7395, Val AUC: 0.7079
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.43it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.07it/s]
New threshold is 0.47944608330726624
train F1 is 0.6608527302742004
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.09it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.38it/s]
New threshold is 0.5051019787788391
val F1 is 0.654275119304657
Epoch 19/40, learning rate: 3.0942353668218756e-10
Train Loss: 0.5740, Train Acc: 0.6998, Train f1: 0.6609, Train Precision: 0.6189, Train Recall: 0.7089, Train AUC: 0.7563
Valitadion Loss: 0.6273, Validation Acc: 0.6748, Vall f1: 0.6543, Val Precision: 0.5867, Val Recall: 0.7395, Val AUC: 0.7081
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.45it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.07it/s]
New threshold is 0.4363076984882355
train F1 is 0.6390115022659302
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.09it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.37it/s]
New threshold is 0.45537668466567993
val F1 is 0.5859375
Epoch 20/40, learning rate: 1.9969173338872615e-05
Train Loss: 0.6139, Train Acc: 0.6492, Train f1: 0.6390, Train Precision: 0.5552, Train Recall: 0.7526, Train AUC: 0.6969
Valitadion Loss: 0.6459, Validation Acc: 0.6294, Vall f1: 0.5859, Val Precision: 0.5474, Val Recall: 0.6303, Val AUC: 0.6703
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.44it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.07it/s]
New threshold is 0.40530386567115784
train F1 is 0.6175687909126282
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.08it/s]



 76%|██████████████████████████████████████████████████████████████▍                   | 16/21 [00:06<00:02,  2.39it/s]
New threshold is 0.5489509105682373
val F1 is 0.613545835018158
Epoch 21/40, learning rate: 1.987066410425045e-05
Train Loss: 0.6293, Train Acc: 0.6304, Train f1: 0.6176, Train Precision: 0.5387, Train Recall: 0.7235, Train AUC: 0.6796
Valitadion Loss: 0.6608, Validation Acc: 0.6608, Vall f1: 0.6135, Val Precision: 0.5833, Val Recall: 0.6471, Val AUC: 0.6762
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.45it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.08it/s]
New threshold is 0.4397537112236023
train F1 is 0.6132339239120483
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.09it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.38it/s]
New threshold is 0.4955618977546692
val F1 is 0.5785123705863953
Epoch 22/40, learning rate: 1.970506474943219e-05
Train Loss: 0.6225, Train Acc: 0.6441, Train f1: 0.6132, Train Precision: 0.5557, Train Recall: 0.6840, Train AUC: 0.6886
Valitadion Loss: 0.6539, Validation Acc: 0.6434, Vall f1: 0.5785, Val Precision: 0.5691, Val Recall: 0.5882, Val AUC: 0.6754
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.45it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.08it/s]
New threshold is 0.40431976318359375
train F1 is 0.6279683113098145
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.08it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.39it/s]
New threshold is 0.4632105529308319
val F1 is 0.6264150738716125
Epoch 23/40, learning rate: 1.9473500840141124e-05
Train Loss: 0.6206, Train Acc: 0.6372, Train f1: 0.6280, Train Precision: 0.5442, Train Recall: 0.7422, Train AUC: 0.6820
Valitadion Loss: 0.6395, Validation Acc: 0.6538, Vall f1: 0.6264, Val Precision: 0.5685, Val Recall: 0.6975, Val AUC: 0.6816
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.44it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.08it/s]
New threshold is 0.4514874517917633
train F1 is 0.6101048588752747
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.09it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.39it/s]
New threshold is 0.4846740663051605
val F1 is 0.6420664191246033
Epoch 24/40, learning rate: 1.9177546297962497e-05
Train Loss: 0.6140, Train Acc: 0.6492, Train f1: 0.6101, Train Precision: 0.5634, Train Recall: 0.6653, Train AUC: 0.7001
Valitadion Loss: 0.6292, Validation Acc: 0.6608, Vall f1: 0.6421, Val Precision: 0.5724, Val Recall: 0.7311, Val AUC: 0.7041
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.44it/s]







































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:18<00:01,  1.04it/s]
New threshold is 0.4592350721359253
train F1 is 0.6361136436462402
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:19<00:00,  1.06it/s]



100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:09<00:00,  2.27it/s]
  0%|                                                                                           | 0/84 [00:00<?, ?it/s]
New threshold is 0.5184664726257324
val F1 is 0.6086956262588501
Epoch 25/40, learning rate: 1.881921270252292e-05
Train Loss: 0.6035, Train Acc: 0.6595, Train f1: 0.6361, Train Precision: 0.5689, Train Recall: 0.7214, Train AUC: 0.7159
Valitadion Loss: 0.6331, Validation Acc: 0.6538, Vall f1: 0.6087, Val Precision: 0.5746, Val Recall: 0.6471, Val AUC: 0.7018






































100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:18<00:00,  1.07it/s]
  0%|                                                                                           | 0/21 [00:00<?, ?it/s]
New threshold is 0.46989768743515015
train F1 is 0.6508087515830994




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:07<00:00,  2.39it/s]
New threshold is 0.4565110504627228
val F1 is 0.6387832760810852
Epoch 26/40, learning rate: 1.8400935618942642e-05
Train Loss: 0.5894, Train Acc: 0.6852, Train f1: 0.6508, Train Precision: 0.6000, Train Recall: 0.7110, Train AUC: 0.7377
Valitadion Loss: 0.6122, Validation Acc: 0.6678, Vall f1: 0.6388, Val Precision: 0.5833, Val Recall: 0.7059, Val AUC: 0.7354
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.46it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.09it/s]
  0%|                                                                                           | 0/21 [00:00<?, ?it/s]
New threshold is 0.4684354066848755
train F1 is 0.6648401618003845




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:07<00:00,  2.39it/s]
New threshold is 0.4402634799480438
val F1 is 0.6739130616188049
Epoch 27/40, learning rate: 1.7925558043492013e-05
Train Loss: 0.5787, Train Acc: 0.6852, Train f1: 0.6648, Train Precision: 0.5928, Train Recall: 0.7568, Train AUC: 0.7493
Valitadion Loss: 0.6161, Validation Acc: 0.6853, Vall f1: 0.6739, Val Precision: 0.5924, Val Recall: 0.7815, Val AUC: 0.7270
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.44it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.08it/s]
  0%|                                                                                           | 0/21 [00:00<?, ?it/s]
New threshold is 0.4653163552284241
train F1 is 0.6771036982536316




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:07<00:00,  2.38it/s]
New threshold is 0.5073844790458679
val F1 is 0.6204379796981812
Epoch 28/40, learning rate: 1.739631107997055e-05
Train Loss: 0.5517, Train Acc: 0.7170, Train f1: 0.6771, Train Precision: 0.6396, Train Recall: 0.7193, Train AUC: 0.7826
Valitadion Loss: 0.6263, Validation Acc: 0.6364, Vall f1: 0.6204, Val Precision: 0.5484, Val Recall: 0.7143, Val AUC: 0.7156
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.45it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.07it/s]
New threshold is 0.4771547019481659
train F1 is 0.668615996837616
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.08it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.38it/s]
New threshold is 0.4979095458984375
val F1 is 0.6692913174629211
Epoch 29/40, learning rate: 1.6816791978149873e-05
Train Loss: 0.5583, Train Acc: 0.7084, Train f1: 0.6686, Train Precision: 0.6294, Train Recall: 0.7131, Train AUC: 0.7714
Valitadion Loss: 0.6041, Validation Acc: 0.7063, Vall f1: 0.6693, Val Precision: 0.6296, Val Recall: 0.7143, Val AUC: 0.7408
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.44it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.07it/s]
New threshold is 0.4716903865337372
train F1 is 0.6686508059501648
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.08it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.38it/s]
New threshold is 0.42299336194992065
val F1 is 0.6666666865348816
Epoch 30/40, learning rate: 1.6190939683551365e-05
Train Loss: 0.5478, Train Acc: 0.7136, Train f1: 0.6687, Train Precision: 0.6395, Train Recall: 0.7006, Train AUC: 0.7847
Valitadion Loss: 0.6021, Validation Acc: 0.6958, Vall f1: 0.6667, Val Precision: 0.6127, Val Recall: 0.7311, Val AUC: 0.7505
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.44it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.07it/s]
New threshold is 0.49352777004241943
train F1 is 0.6933867931365967
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.08it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.37it/s]
New threshold is 0.422986775636673
val F1 is 0.661478579044342
Epoch 31/40, learning rate: 1.5523008064744873e-05
Train Loss: 0.5171, Train Acc: 0.7376, Train f1: 0.6934, Train Precision: 0.6692, Train Recall: 0.7193, Train AUC: 0.8170
Valitadion Loss: 0.6071, Validation Acc: 0.6958, Vall f1: 0.6615, Val Precision: 0.6159, Val Recall: 0.7143, Val AUC: 0.7470
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.45it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.08it/s]
New threshold is 0.4713188409805298
train F1 is 0.6908358335494995
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.08it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.39it/s]
New threshold is 0.4339624047279358
val F1 is 0.6715866923332214
Epoch 32/40, learning rate: 1.4817537000140316e-05
Train Loss: 0.5177, Train Acc: 0.7367, Train f1: 0.6908, Train Precision: 0.6699, Train Recall: 0.7131, Train AUC: 0.8125
Valitadion Loss: 0.6119, Validation Acc: 0.6888, Vall f1: 0.6716, Val Precision: 0.5987, Val Recall: 0.7647, Val AUC: 0.7387
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.44it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.08it/s]
New threshold is 0.42363056540489197
train F1 is 0.71875
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.08it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.38it/s]
New threshold is 0.487569123506546
val F1 is 0.6053639650344849
Epoch 33/40, learning rate: 1.407932152079303e-05
Train Loss: 0.4908, Train Acc: 0.7530, Train f1: 0.7188, Train Precision: 0.6777, Train Recall: 0.7651, Train AUC: 0.8346
Valitadion Loss: 0.6269, Validation Acc: 0.6399, Vall f1: 0.6054, Val Precision: 0.5563, Val Recall: 0.6639, Val AUC: 0.7173
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.44it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.07it/s]
New threshold is 0.432263046503067
train F1 is 0.7324777841567993
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.08it/s]



 81%|██████████████████████████████████████████████████████████████████▍               | 17/21 [00:07<00:01,  2.36it/s]
New threshold is 0.41678673028945923
val F1 is 0.6406926512718201
Epoch 34/40, learning rate: 1.3313379218956768e-05
Train Loss: 0.4836, Train Acc: 0.7676, Train f1: 0.7325, Train Precision: 0.6974, Train Recall: 0.7713, Train AUC: 0.8388
Valitadion Loss: 0.5997, Validation Acc: 0.7098, Vall f1: 0.6407, Val Precision: 0.6607, Val Recall: 0.6218, Val AUC: 0.7574
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.43it/s]






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.08it/s]
New threshold is 0.414438933134079
train F1 is 0.7312687039375305
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.08it/s]



100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.43it/s]
  0%|                                                                                           | 0/84 [00:00<?, ?it/s]
New threshold is 0.3341793119907379
val F1 is 0.678966760635376
Epoch 35/40, learning rate: 1.2524916143905793e-05
Train Loss: 0.4682, Train Acc: 0.7693, Train f1: 0.7313, Train Precision: 0.7038, Train Recall: 0.7609, Train AUC: 0.8526
Valitadion Loss: 0.5865, Validation Acc: 0.6958, Vall f1: 0.6790, Val Precision: 0.6053, Val Recall: 0.7731, Val AUC: 0.7731






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.08it/s]
New threshold is 0.4224722385406494
train F1 is 0.7487586736679077
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.08it/s]



100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.43it/s]
  0%|                                                                                           | 0/84 [00:00<?, ?it/s]
New threshold is 0.4941715896129608
val F1 is 0.658730149269104
Epoch 36/40, learning rate: 1.1719291416829545e-05
Train Loss: 0.4564, Train Acc: 0.7830, Train f1: 0.7488, Train Precision: 0.7167, Train Recall: 0.7838, Train AUC: 0.8599
Valitadion Loss: 0.6221, Validation Acc: 0.6993, Vall f1: 0.6587, Val Precision: 0.6241, Val Recall: 0.6975, Val AUC: 0.7550






































 98%|████████████████████████████████████████████████████████████████████████████████  | 82/84 [01:16<00:01,  1.07it/s]
New threshold is 0.43853652477264404
train F1 is 0.7416413426399231
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.08it/s]



100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.44it/s]
  0%|                                                                                           | 0/84 [00:00<?, ?it/s]
New threshold is 0.3863022029399872
val F1 is 0.6443514823913574
Epoch 37/40, learning rate: 1.0901980805309577e-05
Train Loss: 0.4539, Train Acc: 0.7813, Train f1: 0.7416, Train Precision: 0.7233, Train Recall: 0.7609, Train AUC: 0.8615
Valitadion Loss: 0.5658, Validation Acc: 0.7028, Vall f1: 0.6444, Val Precision: 0.6417, Val Recall: 0.6471, Val AUC: 0.7716






































 96%|███████████████████████████████████████████████████████████████████████████████   | 81/84 [01:15<00:02,  1.07it/s]
New threshold is 0.38039839267730713
train F1 is 0.7526881694793701
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.08it/s]




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:08<00:00,  2.37it/s]
New threshold is 0.3273145854473114
val F1 is 0.671875
Epoch 38/40, learning rate: 1.0078539504960164e-05
Train Loss: 0.4330, Train Acc: 0.7830, Train f1: 0.7527, Train Precision: 0.7103, Train Recall: 0.8004, Train AUC: 0.8748
Valitadion Loss: 0.5770, Validation Acc: 0.7063, Vall f1: 0.6719, Val Precision: 0.6277, Val Recall: 0.7227, Val AUC: 0.7754
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.43it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.08it/s]
  0%|                                                                                           | 0/21 [00:00<?, ?it/s]
New threshold is 0.4692671298980713
train F1 is 0.7613039016723633




 90%|██████████████████████████████████████████████████████████████████████████▏       | 19/21 [00:07<00:00,  2.38it/s]
New threshold is 0.49401164054870605
val F1 is 0.643478274345398
Epoch 39/40, learning rate: 9.254564381202913e-06
Train Loss: 0.4292, Train Acc: 0.8053, Train f1: 0.7613, Train Precision: 0.7702, Train Recall: 0.7526, Train AUC: 0.8788
Valitadion Loss: 0.6096, Validation Acc: 0.7133, Vall f1: 0.6435, Val Precision: 0.6667, Val Recall: 0.6218, Val AUC: 0.7533
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.44it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 83/84 [01:17<00:00,  1.07it/s]
New threshold is 0.3829006552696228
train F1 is 0.7667984366416931
100%|██████████████████████████████████████████████████████████████████████████████████| 84/84 [01:17<00:00,  1.08it/s]



 86%|██████████████████████████████████████████████████████████████████████▎           | 18/21 [00:07<00:01,  2.39it/s]
New threshold is 0.32677218317985535
val F1 is 0.6499999761581421
Epoch 40/40, learning rate: 8.435655927814925e-06
Train Loss: 0.4206, Train Acc: 0.7976, Train f1: 0.7668, Train Precision: 0.7307, Train Recall: 0.8067, Train AUC: 0.8824
Valitadion Loss: 0.5979, Validation Acc: 0.7063, Vall f1: 0.6500, Val Precision: 0.6446, Val Recall: 0.6555, Val AUC: 0.7712
Training complete in 57m 16s
Best val auc: 0.678967
100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:08<00:00,  2.45it/s]




 95%|██████████████████████████████████████████████████████████████████████████████    | 20/21 [00:09<00:00,  2.42it/s]
New threshold is 0.32677218317985535
Inference complete in 0m 9s
F1 Score = : 0.650000
AUC Score = : 0.771197

100%|██████████████████████████████████████████████████████████████████████████████████| 21/21 [00:09<00:00,  2.23it/s]