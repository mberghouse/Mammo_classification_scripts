Starting training...
--------------------
train for epoch 1





































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.17it/s]
New threshold is 0.483738511800766
train F1 is 0.4991150498390198
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:16<00:00,  1.17it/s]





 96%|███████████████████████████████████████████████████████████████████████████████   | 27/28 [00:10<00:00,  2.56it/s]
New threshold is 0.5165930390357971
val F1 is 0.4591194987297058
Epoch 1/100, learning rate: 3.988185647620239e-06
Train Loss: 0.6923, Train Acc: 0.5162, Train f1: 0.4991, Train Precision: 0.5018, Train Recall: 0.4965, Train AUC: 0.5212
Valitadion Loss: 0.6977, Validation Acc: 0.5235, Vall f1: 0.4591, Val Precision: 0.4171, Val Recall: 0.5105, Val AUC: 0.5245
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.58it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.17it/s]
New threshold is 0.48749086260795593
train F1 is 0.5694799423217773
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:16<00:00,  1.17it/s]




 79%|████████████████████████████████████████████████████████████████▍                 | 22/28 [00:08<00:02,  2.53it/s]
New threshold is 0.49906131625175476
val F1 is 0.42953020334243774
Epoch 2/100, learning rate: 3.952882169438005e-06
Train Loss: 0.6848, Train Acc: 0.5684, Train f1: 0.5695, Train Precision: 0.5521, Train Recall: 0.5880, Train AUC: 0.5772
Valitadion Loss: 0.6893, Validation Acc: 0.5291, Vall f1: 0.4295, Val Precision: 0.4129, Val Recall: 0.4476, Val AUC: 0.5205
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.57it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:15<00:00,  1.17it/s]
New threshold is 0.4884393513202667
train F1 is 0.5214220881462097
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:16<00:00,  1.17it/s]




 86%|██████████████████████████████████████████████████████████████████████▎           | 24/28 [00:09<00:01,  2.54it/s]
New threshold is 0.511482298374176
val F1 is 0.4949832856655121
Epoch 3/100, learning rate: 3.894506653289044e-06
Train Loss: 0.6828, Train Acc: 0.5513, Train f1: 0.5214, Train Precision: 0.5406, Train Recall: 0.5035, Train AUC: 0.5775
Valitadion Loss: 0.6909, Validation Acc: 0.5817, Vall f1: 0.4950, Val Precision: 0.4744, Val Recall: 0.5175, Val AUC: 0.5833
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.57it/s]






































 99%|█████████████████████████████████████████████████████████████████████████████████ | 89/90 [01:15<00:00,  1.17it/s]
New threshold is 0.49720698595046997
train F1 is 0.5481758713722229
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:16<00:00,  1.17it/s]




 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.52it/s]
New threshold is 0.4841907024383545
val F1 is 0.516339898109436
Epoch 4/100, learning rate: 3.81374876826391e-06
Train Loss: 0.6748, Train Acc: 0.5872, Train f1: 0.5482, Train Precision: 0.5848, Train Recall: 0.5158, Train AUC: 0.6149
Valitadion Loss: 0.6711, Validation Acc: 0.5900, Vall f1: 0.5163, Val Precision: 0.4847, Val Recall: 0.5524, Val AUC: 0.6022
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:11<00:00,  2.54it/s]





































100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:16<00:00,  1.17it/s]
  0%|                                                                                           | 0/28 [00:00<?, ?it/s]
New threshold is 0.48887982964515686
train F1 is 0.5662431716918945





 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.51it/s]
New threshold is 0.49177831411361694
val F1 is 0.5761772990226746
Epoch 5/100, learning rate: 3.7115626167122582e-06
Train Loss: 0.6748, Train Acc: 0.5915, Train f1: 0.5662, Train Precision: 0.5843, Train Recall: 0.5493, Train AUC: 0.6125
Valitadion Loss: 0.6773, Validation Acc: 0.5762, Vall f1: 0.5762, Val Precision: 0.4771, Val Recall: 0.7273, Val AUC: 0.6179
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.57it/s]





































 97%|███████████████████████████████████████████████████████████████████████████████▎  | 87/90 [01:14<00:02,  1.18it/s]
New threshold is 0.474355012178421
train F1 is 0.559708297252655
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:16<00:00,  1.17it/s]





 89%|█████████████████████████████████████████████████████████████████████████▏        | 25/28 [00:09<00:01,  2.55it/s]
New threshold is 0.5659760236740112
val F1 is 0.579104483127594
Epoch 6/100, learning rate: 3.589155462138668e-06
Train Loss: 0.6742, Train Acc: 0.5872, Train f1: 0.5597, Train Precision: 0.5803, Train Recall: 0.5405, Train AUC: 0.6121
Valitadion Loss: 0.7176, Validation Acc: 0.6094, Vall f1: 0.5791, Val Precision: 0.5052, Val Recall: 0.6783, Val AUC: 0.6164
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.56it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.18it/s]
New threshold is 0.504584014415741
train F1 is 0.5825410485267639
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:16<00:00,  1.17it/s]





 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.53it/s]
New threshold is 0.5293324589729309
val F1 is 0.5525525808334351
Epoch 7/100, learning rate: 3.4479734661626163e-06
Train Loss: 0.6721, Train Acc: 0.5872, Train f1: 0.5825, Train Precision: 0.5722, Train Recall: 0.5933, Train AUC: 0.6175
Valitadion Loss: 0.6902, Validation Acc: 0.5873, Vall f1: 0.5526, Val Precision: 0.4842, Val Recall: 0.6434, Val AUC: 0.6146
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.55it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.18it/s]
New threshold is 0.4796154201030731
train F1 is 0.5838401317596436
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:16<00:00,  1.17it/s]





 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.53it/s]
New threshold is 0.551619291305542
val F1 is 0.5460751056671143
Epoch 8/100, learning rate: 3.2896846030512342e-06
Train Loss: 0.6681, Train Acc: 0.5906, Train f1: 0.5838, Train Precision: 0.5763, Train Recall: 0.5915, Train AUC: 0.6256
Valitadion Loss: 0.6791, Validation Acc: 0.6316, Vall f1: 0.5461, Val Precision: 0.5333, Val Recall: 0.5594, Val AUC: 0.6400
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.55it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.18it/s]
New threshold is 0.4860146939754486
train F1 is 0.6017094254493713
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:16<00:00,  1.17it/s]





 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.52it/s]
New threshold is 0.43055322766304016
val F1 is 0.5481927990913391
Epoch 9/100, learning rate: 3.1161589536786335e-06
Train Loss: 0.6610, Train Acc: 0.6017, Train f1: 0.6017, Train Precision: 0.5847, Train Recall: 0.6197, Train AUC: 0.6502
Valitadion Loss: 0.6489, Validation Acc: 0.5845, Vall f1: 0.5482, Val Precision: 0.4815, Val Recall: 0.6364, Val AUC: 0.6401
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.55it/s]





































 98%|████████████████████████████████████████████████████████████████████████████████▏ | 88/90 [01:15<00:01,  1.18it/s]
New threshold is 0.46473145484924316
train F1 is 0.624356746673584
100%|██████████████████████████████████████████████████████████████████████████████████| 90/90 [01:16<00:00,  1.17it/s]





 93%|████████████████████████████████████████████████████████████████████████████▏     | 26/28 [00:10<00:00,  2.55it/s]
New threshold is 0.482051283121109
val F1 is 0.5714285969734192
Epoch 10/100, learning rate: 2.9294466117259505e-06
Train Loss: 0.6571, Train Acc: 0.6256, Train f1: 0.6244, Train Precision: 0.6087, Train Recall: 0.6408, Train AUC: 0.6556
Valitadion Loss: 0.6510, Validation Acc: 0.6177, Vall f1: 0.5714, Val Precision: 0.5140, Val Recall: 0.6434, Val AUC: 0.6532
100%|██████████████████████████████████████████████████████████████████████████████████| 28/28 [00:10<00:00,  2.56it/s]




























 74%|█████████████████████████████████████████████████████████████                     | 67/90 [00:58<00:20,  1.15it/s]
Traceback (most recent call last):
  File "C:\Users\marcb\OneDrive\Desktop\mberghouse\Mammo_classification_scripts\cbisddsm_classification_300x500_old.py", line 567, in <module>
    model = train_model(model, model_name, criterion, optimizer, scheduler, num_epochs=epochs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\marcb\OneDrive\Desktop\mberghouse\Mammo_classification_scripts\cbisddsm_classification_300x500_old.py", line 174, in train_model
    running_loss += loss.item()
                    ^^^^^^^^^^^
KeyboardInterrupt