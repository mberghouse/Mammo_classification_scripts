
  4%|███▍                                                                               | 3/73 [00:01<00:27,  2.50it/s]
Sequential(
  (0): DaVit(
    (stem): Stem(
      (conv): Conv2d(3, 128, kernel_size=(7, 7), stride=(4, 4), padding=(3, 3))
      (norm): LayerNorm2d((128,), eps=1e-05, elementwise_affine=True)
    )
    (stages): Sequential(
      (0): DaVitStage(
        (downsample): Identity()
        (blocks): Sequential(
          (0): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=128)
                (act): Identity()
              )
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): Identity()
              (cpe2): ConvPosEnc(
                (proj): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=128)
                (act): Identity()
              )
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): Identity()
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=128)
                (act): Identity()
              )
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (proj): Linear(in_features=128, out_features=128, bias=True)
              )
              (drop_path1): Identity()
              (cpe2): ConvPosEnc(
                (proj): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=128)
                (act): Identity()
              )
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): Identity()
            )
          )
        )
      )
      (1): DaVitStage(
        (downsample): Downsample(
          (norm): LayerNorm2d((128,), eps=1e-05, elementwise_affine=True)
          (conv): Conv2d(128, 256, kernel_size=(2, 2), stride=(2, 2))
        )
        (blocks): Sequential(
          (0): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=256)
                (act): Identity()
              )
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.045)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=256)
                (act): Identity()
              )
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.045)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=256)
                (act): Identity()
              )
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (proj): Linear(in_features=256, out_features=256, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.045)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=256)
                (act): Identity()
              )
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.045)
            )
          )
        )
      )
      (2): DaVitStage(
        (downsample): Downsample(
          (norm): LayerNorm2d((256,), eps=1e-05, elementwise_affine=True)
          (conv): Conv2d(256, 512, kernel_size=(2, 2), stride=(2, 2))
        )
        (blocks): Sequential(
          (0): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.091)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.091)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.091)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.091)
            )
          )
          (1): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.136)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.136)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.136)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.136)
            )
          )
          (2): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.182)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.182)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.182)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.182)
            )
          )
          (3): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.227)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.227)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.227)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.227)
            )
          )
          (4): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.273)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.273)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.273)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.273)
            )
          )
          (5): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.318)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.318)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.318)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.318)
            )
          )
          (6): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.364)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.364)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.364)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.364)
            )
          )
          (7): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.409)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.409)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.409)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.409)
            )
          )
          (8): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.455)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.455)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (proj): Linear(in_features=512, out_features=512, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.455)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=512)
                (act): Identity()
              )
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.455)
            )
          )
        )
      )
      (3): DaVitStage(
        (downsample): Downsample(
          (norm): LayerNorm2d((512,), eps=1e-05, elementwise_affine=True)
          (conv): Conv2d(512, 1024, kernel_size=(2, 2), stride=(2, 2))
        )
        (blocks): Sequential(
          (0): Sequential(
            (0): SpatialBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=1024)
                (act): Identity()
              )
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (softmax): Softmax(dim=-1)
              )
              (drop_path1): DropPath(drop_prob=0.500)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=1024)
                (act): Identity()
              )
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.500)
            )
            (1): ChannelBlock(
              (cpe1): ConvPosEnc(
                (proj): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=1024)
                (act): Identity()
              )
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): ChannelAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
              )
              (drop_path1): DropPath(drop_prob=0.500)
              (cpe2): ConvPosEnc(
                (proj): Conv2d(1024, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), groups=1024)
                (act): Identity()
              )
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (drop1): Dropout(p=0.0, inplace=False)
                (norm): Identity()
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop2): Dropout(p=0.0, inplace=False)
              )
              (drop_path2): DropPath(drop_prob=0.500)
            )
          )
        )
      )
    )
    (norm_pre): Identity()
    (head): NormMlpClassifierHead(
      (global_pool): SelectAdaptivePool2d(pool_type=avg, flatten=Identity())
      (norm): LayerNorm2d((1024,), eps=1e-05, elementwise_affine=True)
      (flatten): Flatten(start_dim=1, end_dim=-1)
      (pre_logits): Identity()
      (drop): Dropout(p=0.0, inplace=False)
      (fc): Linear(in_features=1024, out_features=1, bias=True)
    )
  )
  (1): Sigmoid()
)
Starting training...
--------------------










 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:21<00:01,  3.23it/s]
New threshold is 0.4295155107975006
train F1 is 0.49067163467407227
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.16it/s]
 50%|██████████████████████████████████████████                                          | 2/4 [00:00<00:00,  7.38it/s]
New threshold is 0.3961848020553589
val F1 is 0.5151515007019043
Epoch 1/62, learning rate: 1.989745091059581e-05
Train Loss: 0.6806, Train Acc: 0.5317, Train f1: 0.4907, Train Precision: 0.4450, Train Recall: 0.5468, Train AUC: 0.5250
Valitadion Loss: 0.6965, Validation Acc: 0.4754, Vall f1: 0.5152, Val Precision: 0.4250, Val Recall: 0.6538, Val AUC: 0.4352
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.87it/s]










 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:21<00:01,  3.20it/s]
New threshold is 0.41608911752700806
train F1 is 0.4603330194950104
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:22<00:00,  3.18it/s]
 50%|██████████████████████████████████████████                                          | 2/4 [00:00<00:00,  7.59it/s]
New threshold is 0.3692243695259094
val F1 is 0.3921568691730499
Epoch 2/62, learning rate: 1.9591906905635932e-05
Train Loss: 0.6794, Train Acc: 0.5274, Train f1: 0.4603, Train Precision: 0.4352, Train Recall: 0.4886, Train AUC: 0.5225
Valitadion Loss: 0.7096, Validation Acc: 0.4918, Vall f1: 0.3922, Val Precision: 0.4000, Val Recall: 0.3846, Val AUC: 0.4407
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.68it/s]










 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:21<00:01,  3.18it/s]
New threshold is 0.4115912616252899
train F1 is 0.47830280661582947
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:22<00:00,  3.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.71it/s]
New threshold is 0.464153915643692
val F1 is 0.47058823704719543
Epoch 3/62, learning rate: 1.908963463733e-05
Train Loss: 0.6752, Train Acc: 0.5360, Train f1: 0.4783, Train Precision: 0.4460, Train Recall: 0.5156, Train AUC: 0.5393
Valitadion Loss: 0.7040, Validation Acc: 0.4098, Vall f1: 0.4706, Val Precision: 0.3810, Val Recall: 0.6154, Val AUC: 0.3571
train for epoch 4










 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:21<00:01,  3.22it/s]
New threshold is 0.44873273372650146
train F1 is 0.4923703074455261
val for epoch 4
New threshold is 0.42911192774772644
val F1 is 0.4583333432674408
Epoch 4/62, learning rate: 1.8400935618942642e-05
Train Loss: 0.6670, Train Acc: 0.5720, Train f1: 0.4924, Train Precision: 0.4821, Train Recall: 0.5031, Train AUC: 0.5859
Valitadion Loss: 0.7178, Validation Acc: 0.5738, Vall f1: 0.4583, Val Precision: 0.5000, Val Recall: 0.4231, Val AUC: 0.4769
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.72it/s]











 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:22<00:00,  3.21it/s]
New threshold is 0.4290967881679535
train F1 is 0.5255905389785767
val for epoch 5
New threshold is 0.3330495059490204
val F1 is 0.47826087474823
Epoch 5/62, learning rate: 1.7539934942621955e-05
Train Loss: 0.6561, Train Acc: 0.5866, Train f1: 0.5256, Train Precision: 0.4991, Train Recall: 0.5551, Train AUC: 0.6209
Valitadion Loss: 0.7890, Validation Acc: 0.6066, Vall f1: 0.4783, Val Precision: 0.5500, Val Recall: 0.4231, Val AUC: 0.4978
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:22<00:00,  3.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.82it/s]











 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:22<00:00,  3.18it/s]
New threshold is 0.42177891731262207
train F1 is 0.559440553188324
val for epoch 6
New threshold is 0.3392140865325928
val F1 is 0.5
Epoch 6/62, learning rate: 1.65242915763175e-05
Train Loss: 0.6444, Train Acc: 0.6218, Train f1: 0.5594, Train Precision: 0.5385, Train Recall: 0.5821, Train AUC: 0.6514
Valitadion Loss: 0.7471, Validation Acc: 0.6066, Vall f1: 0.5000, Val Precision: 0.5455, Val Recall: 0.4615, Val AUC: 0.5253
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:22<00:00,  3.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.69it/s]











 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:22<00:00,  3.17it/s]
New threshold is 0.427963525056839
train F1 is 0.5708812475204468
val for epoch 7
New threshold is 0.46595218777656555
val F1 is 0.5199999809265137
Epoch 7/62, learning rate: 1.5374836181545594e-05
Train Loss: 0.6476, Train Acc: 0.6158, Train f1: 0.5709, Train Precision: 0.5293, Train Recall: 0.6195, Train AUC: 0.6432
Valitadion Loss: 0.7106, Validation Acc: 0.6066, Vall f1: 0.5200, Val Precision: 0.5417, Val Recall: 0.5000, Val AUC: 0.5560
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.65it/s]











 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:22<00:00,  3.18it/s]
New threshold is 0.4141203761100769
train F1 is 0.597744345664978
val for epoch 8
New threshold is 0.40320155024528503
val F1 is 0.47058823704719543
Epoch 8/62, learning rate: 1.411514388029391e-05
Train Loss: 0.6414, Train Acc: 0.6329, Train f1: 0.5977, Train Precision: 0.5455, Train Recall: 0.6611, Train AUC: 0.6601
Valitadion Loss: 0.7407, Validation Acc: 0.5574, Vall f1: 0.4706, Val Precision: 0.4800, Val Recall: 0.4615, Val AUC: 0.5121
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:22<00:00,  3.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.87it/s]











 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:22<00:00,  3.18it/s]
New threshold is 0.39824357628822327
train F1 is 0.617241382598877
val for epoch 9
New threshold is 0.4812835156917572
val F1 is 0.5333333611488342
Epoch 9/62, learning rate: 1.277105073353882e-05
Train Loss: 0.6364, Train Acc: 0.6192, Train f1: 0.6172, Train Precision: 0.5272, Train Recall: 0.7443, Train AUC: 0.6591
Valitadion Loss: 0.7439, Validation Acc: 0.6557, Vall f1: 0.5333, Val Precision: 0.6316, Val Recall: 0.4615, Val AUC: 0.5341
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.64it/s]











 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:22<00:00,  3.18it/s]
New threshold is 0.4079444110393524
train F1 is 0.630630612373352
val for epoch 10
New threshold is 0.5401577949523926
val F1 is 0.52173912525177
Epoch 10/62, learning rate: 1.137012384831351e-05
Train Loss: 0.6234, Train Acc: 0.6484, Train f1: 0.6306, Train Precision: 0.5564, Train Recall: 0.7277, Train AUC: 0.6881
Valitadion Loss: 0.7033, Validation Acc: 0.6393, Vall f1: 0.5217, Val Precision: 0.6000, Val Recall: 0.4615, Val AUC: 0.5791
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.63it/s]











100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.17it/s]
New threshold is 0.4202134609222412
train F1 is 0.6461251378059387
val for epoch 11
New threshold is 0.5917341709136963
val F1 is 0.4680851101875305
Epoch 11/62, learning rate: 9.941095981334956e-06
Train Loss: 0.6010, Train Acc: 0.6750, Train f1: 0.6461, Train Precision: 0.5864, Train Recall: 0.7193, Train AUC: 0.7260
Valitadion Loss: 0.7291, Validation Acc: 0.5902, Vall f1: 0.4681, Val Precision: 0.5238, Val Recall: 0.4231, Val AUC: 0.5681
train for epoch 12
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.47it/s]











100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.16it/s]
New threshold is 0.4048031270503998
train F1 is 0.6510369777679443
val for epoch 12
New threshold is 0.39625608921051025
val F1 is 0.4897959232330322
Epoch 12/62, learning rate: 8.513276235366988e-06
Train Loss: 0.5950, Train Acc: 0.6681, Train f1: 0.6510, Train Precision: 0.5748, Train Recall: 0.7505, Train AUC: 0.7273
Valitadion Loss: 0.7952, Validation Acc: 0.5902, Vall f1: 0.4898, Val Precision: 0.5217, Val Recall: 0.4615, Val AUC: 0.5363
train for epoch 13
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.63it/s]










100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.16it/s]
  0%|                                                                                            | 0/4 [00:00<?, ?it/s]
New threshold is 0.4459535777568817
train F1 is 0.6360078454017639
val for epoch 13
New threshold is 0.5793806314468384
val F1 is 0.47826087474823
Epoch 13/62, learning rate: 7.115948934830289e-06
Train Loss: 0.5909, Train Acc: 0.6810, Train f1: 0.6360, Train Precision: 0.6007, Train Recall: 0.6757, Train AUC: 0.7360
Valitadion Loss: 0.7635, Validation Acc: 0.6066, Vall f1: 0.4783, Val Precision: 0.5500, Val Recall: 0.4231, Val AUC: 0.5637
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.67it/s]










 92%|███████████████████████████████████████████████████████████████████████████▎      | 67/73 [00:21<00:01,  3.19it/s]
New threshold is 0.4475221633911133
train F1 is 0.6316831707954407
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.16it/s]
 25%|█████████████████████                                                               | 1/4 [00:00<00:00,  6.85it/s]
New threshold is 0.5924966335296631
val F1 is 0.5
Epoch 14/62, learning rate: 5.777773009611733e-06
Train Loss: 0.5881, Train Acc: 0.6810, Train f1: 0.6317, Train Precision: 0.6030, Train Recall: 0.6632, Train AUC: 0.7411
Valitadion Loss: 0.7656, Validation Acc: 0.6393, Vall f1: 0.5000, Val Precision: 0.6111, Val Recall: 0.4231, Val AUC: 0.5989
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.59it/s]










 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:21<00:01,  3.18it/s]
New threshold is 0.409830778837204
train F1 is 0.6684635877609253
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.16it/s]
 50%|██████████████████████████████████████████                                          | 2/4 [00:00<00:00,  7.06it/s]
New threshold is 0.4151304066181183
val F1 is 0.5199999809265137
Epoch 15/62, learning rate: 4.526194205602367e-06
Train Loss: 0.5850, Train Acc: 0.6835, Train f1: 0.6685, Train Precision: 0.5886, Train Recall: 0.7734, Train AUC: 0.7421
Valitadion Loss: 0.8469, Validation Acc: 0.6066, Vall f1: 0.5200, Val Precision: 0.5417, Val Recall: 0.5000, Val AUC: 0.5374
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.46it/s]










 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:21<00:01,  3.16it/s]
New threshold is 0.44612252712249756
train F1 is 0.6571699976921082
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.15it/s]
 75%|███████████████████████████████████████████████████████████████                     | 3/4 [00:00<00:00,  7.13it/s]
New threshold is 0.48015129566192627
val F1 is 0.4897959232330322
Epoch 16/62, learning rate: 3.3868821774194157e-06
Train Loss: 0.5854, Train Acc: 0.6904, Train f1: 0.6572, Train Precision: 0.6049, Train Recall: 0.7193, Train AUC: 0.7379
Valitadion Loss: 0.8246, Validation Acc: 0.5902, Vall f1: 0.4898, Val Precision: 0.5217, Val Recall: 0.4615, Val AUC: 0.5549
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.51it/s]










 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:21<00:01,  3.16it/s]
New threshold is 0.4366205036640167
train F1 is 0.6538090705871582
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.15it/s]
 75%|███████████████████████████████████████████████████████████████                     | 3/4 [00:00<00:00,  7.09it/s]
New threshold is 0.38783445954322815
val F1 is 0.5357142686843872
Epoch 17/62, learning rate: 2.383204008438719e-06
Train Loss: 0.5822, Train Acc: 0.6921, Train f1: 0.6538, Train Precision: 0.6097, Train Recall: 0.7048, Train AUC: 0.7477
Valitadion Loss: 0.8160, Validation Acc: 0.5738, Vall f1: 0.5357, Val Precision: 0.5000, Val Recall: 0.5769, Val AUC: 0.5429
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.51it/s]










 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:21<00:01,  3.16it/s]
New threshold is 0.4278595447540283
train F1 is 0.6835206151008606
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.15it/s]
 50%|██████████████████████████████████████████                                          | 2/4 [00:00<00:00,  7.35it/s]
New threshold is 0.5977869629859924
val F1 is 0.4888888895511627
Epoch 18/62, learning rate: 1.5357449561463067e-06
Train Loss: 0.5734, Train Acc: 0.7101, Train f1: 0.6835, Train Precision: 0.6218, Train Recall: 0.7588, Train AUC: 0.7581
Valitadion Loss: 0.7863, Validation Acc: 0.6230, Vall f1: 0.4889, Val Precision: 0.5789, Val Recall: 0.4231, Val AUC: 0.5582
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.63it/s]










 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:21<00:01,  3.18it/s]
New threshold is 0.4512147903442383
train F1 is 0.6705202460289001
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.15it/s]
 75%|███████████████████████████████████████████████████████████████                     | 3/4 [00:00<00:00,  7.12it/s]
New threshold is 0.4410747289657593
val F1 is 0.4897959232330322
Epoch 19/62, learning rate: 8.618862522352262e-07
Train Loss: 0.5711, Train Acc: 0.7067, Train f1: 0.6705, Train Precision: 0.6248, Train Recall: 0.7235, Train AUC: 0.7593
Valitadion Loss: 0.8069, Validation Acc: 0.5902, Vall f1: 0.4898, Val Precision: 0.5217, Val Recall: 0.4615, Val AUC: 0.5626
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.50it/s]










 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:21<00:01,  3.16it/s]
New threshold is 0.41438543796539307
train F1 is 0.6819012761116028
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.14it/s]
 75%|███████████████████████████████████████████████████████████████                     | 3/4 [00:00<00:00,  7.06it/s]
New threshold is 0.4389530122280121
val F1 is 0.5199999809265137
Epoch 20/62, learning rate: 3.754486166911455e-07
Train Loss: 0.5642, Train Acc: 0.7015, Train f1: 0.6819, Train Precision: 0.6085, Train Recall: 0.7755, Train AUC: 0.7687
Valitadion Loss: 0.7746, Validation Acc: 0.6066, Vall f1: 0.5200, Val Precision: 0.5417, Val Recall: 0.5000, Val AUC: 0.5967
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.40it/s]










 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:21<00:01,  3.18it/s]
New threshold is 0.42449501156806946
train F1 is 0.6691800355911255
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.29it/s]
New threshold is 0.26505017280578613
val F1 is 0.5762711763381958
Epoch 21/62, learning rate: 8.640879732829682e-08
Train Loss: 0.5707, Train Acc: 0.6990, Train f1: 0.6692, Train Precision: 0.6121, Train Recall: 0.7380, Train AUC: 0.7578
Valitadion Loss: 0.7589, Validation Acc: 0.5902, Vall f1: 0.5763, Val Precision: 0.5152, Val Recall: 0.6538, Val AUC: 0.6055
train for epoch 22










 92%|███████████████████████████████████████████████████████████████████████████▎      | 67/73 [00:21<00:01,  3.06it/s]
New threshold is 0.41639575362205505
train F1 is 0.6971637606620789
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.13it/s]
 25%|█████████████████████                                                               | 1/4 [00:00<00:00,  6.72it/s]
New threshold is 0.26418885588645935
val F1 is 0.4897959232330322
Epoch 22/62, learning rate: 1.9999826511370455e-05
Train Loss: 0.5693, Train Acc: 0.7161, Train f1: 0.6972, Train Precision: 0.6225, Train Recall: 0.7921, Train AUC: 0.7621
Valitadion Loss: 0.8018, Validation Acc: 0.5902, Vall f1: 0.4898, Val Precision: 0.5217, Val Recall: 0.4615, Val AUC: 0.5824
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.48it/s]











 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:23<00:00,  3.14it/s]
New threshold is 0.4327041208744049
train F1 is 0.6393129825592041
val for epoch 23
New threshold is 0.4764336943626404
val F1 is 0.6440678238868713
Epoch 23/62, learning rate: 1.9969938804795108e-05
Train Loss: 0.5955, Train Acc: 0.6758, Train f1: 0.6393, Train Precision: 0.5908, Train Recall: 0.6965, Train AUC: 0.7290
Valitadion Loss: 0.6691, Validation Acc: 0.6557, Vall f1: 0.6441, Val Precision: 0.5758, Val Recall: 0.7308, Val AUC: 0.6308
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.30it/s]











 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:22<00:00,  3.16it/s]
New threshold is 0.40246179699897766
train F1 is 0.6696914434432983
val for epoch 24
New threshold is 0.17566028237342834
val F1 is 0.5614035129547119
Epoch 24/62, learning rate: 1.98888649930018e-05
Train Loss: 0.5792, Train Acc: 0.6878, Train f1: 0.6697, Train Precision: 0.5942, Train Recall: 0.7672, Train AUC: 0.7485
Valitadion Loss: 0.8127, Validation Acc: 0.5902, Vall f1: 0.5614, Val Precision: 0.5161, Val Recall: 0.6154, Val AUC: 0.5912
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.42it/s]











 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:22<00:00,  3.12it/s]
New threshold is 0.45365363359451294
train F1 is 0.6602687239646912
val for epoch 25
New threshold is 0.1789902001619339
val F1 is 0.5806451439857483
Epoch 25/62, learning rate: 1.975702131253422e-05
Train Loss: 0.5725, Train Acc: 0.6964, Train f1: 0.6603, Train Precision: 0.6132, Train Recall: 0.7152, Train AUC: 0.7576
Valitadion Loss: 0.8002, Validation Acc: 0.5738, Vall f1: 0.5806, Val Precision: 0.5000, Val Recall: 0.6923, Val AUC: 0.5846
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.31it/s]











 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:22<00:01,  3.12it/s]
New threshold is 0.4799641966819763
train F1 is 0.6734279990196228
val for epoch 26
New threshold is 0.34405484795570374
val F1 is 0.6101694703102112
Epoch 26/62, learning rate: 1.9575084654692447e-05
Train Loss: 0.5621, Train Acc: 0.7238, Train f1: 0.6734, Train Precision: 0.6574, Train Recall: 0.6902, Train AUC: 0.7690
Valitadion Loss: 0.7877, Validation Acc: 0.6230, Vall f1: 0.6102, Val Precision: 0.5455, Val Recall: 0.6923, Val AUC: 0.6066
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.10it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.35it/s]











 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:21<00:01,  3.13it/s]
New threshold is 0.42762741446495056
train F1 is 0.6666666865348816
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.10it/s]
 50%|██████████████████████████████████████████                                          | 2/4 [00:00<00:00,  6.40it/s]
New threshold is 0.6754823327064514
val F1 is 0.4897959232330322
Epoch 27/62, learning rate: 1.9343989090342975e-05
Train Loss: 0.5771, Train Acc: 0.6955, Train f1: 0.6667, Train Precision: 0.6079, Train Recall: 0.7380, Train AUC: 0.7479
Valitadion Loss: 0.8245, Validation Acc: 0.5902, Vall f1: 0.4898, Val Precision: 0.5217, Val Recall: 0.4615, Val AUC: 0.5725
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.00it/s]










 92%|███████████████████████████████████████████████████████████████████████████▎      | 67/73 [00:21<00:01,  3.12it/s]
New threshold is 0.44223475456237793
train F1 is 0.6864563822746277
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.10it/s]
  0%|                                                                                            | 0/4 [00:00<?, ?it/s]
New threshold is 0.30261901021003723
val F1 is 0.6333333253860474
Epoch 28/62, learning rate: 1.9064921074357497e-05
Train Loss: 0.5514, Train Acc: 0.7101, Train f1: 0.6865, Train Precision: 0.6198, Train Recall: 0.7692, Train AUC: 0.7804
Valitadion Loss: 0.8073, Validation Acc: 0.6393, Vall f1: 0.6333, Val Precision: 0.5588, Val Recall: 0.7308, Val AUC: 0.6077
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.19it/s]











 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:23<00:00,  3.10it/s]
New threshold is 0.4731394946575165
train F1 is 0.6808923482894897
val for epoch 29
New threshold is 0.5158661007881165
val F1 is 0.5185185074806213
Epoch 29/62, learning rate: 1.873931335430099e-05
Train Loss: 0.5511, Train Acc: 0.7178, Train f1: 0.6809, Train Precision: 0.6382, Train Recall: 0.7297, Train AUC: 0.7788
Valitadion Loss: 0.7838, Validation Acc: 0.5738, Vall f1: 0.5185, Val Precision: 0.5000, Val Recall: 0.5385, Val AUC: 0.5835
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.16it/s]











 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:22<00:00,  3.12it/s]
New threshold is 0.4197569787502289
train F1 is 0.6950092315673828
val for epoch 30
New threshold is 0.3383390009403229
val F1 is 0.6557376980781555
Epoch 30/62, learning rate: 1.836883761464222e-05
Train Loss: 0.5381, Train Acc: 0.7170, Train f1: 0.6950, Train Precision: 0.6256, Train Recall: 0.7817, Train AUC: 0.7963
Valitadion Loss: 0.7610, Validation Acc: 0.6557, Vall f1: 0.6557, Val Precision: 0.5714, Val Recall: 0.7692, Val AUC: 0.6341
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.88it/s]











 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:22<00:01,  3.13it/s]
New threshold is 0.4636944830417633
train F1 is 0.6756237745285034
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.08it/s]
 50%|██████████████████████████████████████████                                          | 2/4 [00:00<00:00,  6.41it/s]
New threshold is 0.30271396040916443
val F1 is 0.6315789222717285
Epoch 31/62, learning rate: 1.7955395894251545e-05
Train Loss: 0.5439, Train Acc: 0.7101, Train f1: 0.6756, Train Precision: 0.6275, Train Recall: 0.7318, Train AUC: 0.7871
Valitadion Loss: 0.7375, Validation Acc: 0.6557, Vall f1: 0.6316, Val Precision: 0.5806, Val Recall: 0.6923, Val AUC: 0.6440
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.86it/s]










 90%|██████████████████████████████████████████████████████████████████████████▏       | 66/73 [00:21<00:02,  3.10it/s]
New threshold is 0.46702781319618225
train F1 is 0.7028627991676331

100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.08it/s]
New threshold is 0.42000967264175415
val F1 is 0.6206896305084229
Epoch 32/62, learning rate: 1.7501110821249063e-05
Train Loss: 0.5265, Train Acc: 0.7419, Train f1: 0.7029, Train Precision: 0.6692, Train Recall: 0.7401, Train AUC: 0.8087
Valitadion Loss: 0.8069, Validation Acc: 0.6393, Vall f1: 0.6207, Val Precision: 0.5625, Val Recall: 0.6923, Val AUC: 0.6396
train for epoch 33
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.07it/s]











 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:23<00:00,  3.10it/s]
New threshold is 0.4487842917442322
train F1 is 0.7035271525382996
val for epoch 33
New threshold is 0.20256885886192322
val F1 is 0.6551724076271057
Epoch 33/62, learning rate: 1.7008314715337748e-05
Train Loss: 0.5088, Train Acc: 0.7333, Train f1: 0.7035, Train Precision: 0.6496, Train Recall: 0.7672, Train AUC: 0.8206
Valitadion Loss: 0.7540, Validation Acc: 0.6721, Vall f1: 0.6552, Val Precision: 0.5938, Val Recall: 0.7308, Val AUC: 0.6714
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.12it/s]











 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:22<00:01,  3.09it/s]
New threshold is 0.5221679210662842
train F1 is 0.7044284343719482
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.99it/s]
  0%|                                                                                           | 0/73 [00:00<?, ?it/s]
New threshold is 0.42076799273490906
val F1 is 0.6296296119689941
Epoch 34/62, learning rate: 1.6479537613570692e-05
Train Loss: 0.5085, Train Acc: 0.7539, Train f1: 0.7044, Train Precision: 0.6980, Train Recall: 0.7110, Train AUC: 0.8197
Valitadion Loss: 0.7305, Validation Acc: 0.6721, Vall f1: 0.6296, Val Precision: 0.6071, Val Recall: 0.6538, Val AUC: 0.6560











100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.07it/s]
 25%|█████████████████████                                                               | 1/4 [00:00<00:00,  6.47it/s]
New threshold is 0.4810636043548584
train F1 is 0.7108433842658997
val for epoch 35
New threshold is 0.08728380501270294
val F1 is 0.6779661178588867
Epoch 35/62, learning rate: 1.5917494281028725e-05
Train Loss: 0.5023, Train Acc: 0.7530, Train f1: 0.7108, Train Precision: 0.6874, Train Recall: 0.7360, Train AUC: 0.8291
Valitadion Loss: 0.8109, Validation Acc: 0.6885, Vall f1: 0.6780, Val Precision: 0.6061, Val Recall: 0.7692, Val AUC: 0.6868
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.09it/s]











 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:23<00:00,  3.08it/s]
New threshold is 0.45134052634239197
train F1 is 0.7236971259117126
val for epoch 36
New threshold is 0.589789867401123
val F1 is 0.6071428656578064
Epoch 36/62, learning rate: 1.532507027309615e-05
Train Loss: 0.4806, Train Acc: 0.7590, Train f1: 0.7237, Train Precision: 0.6866, Train Recall: 0.7651, Train AUC: 0.8445
Valitadion Loss: 0.7417, Validation Acc: 0.6393, Vall f1: 0.6071, Val Precision: 0.5667, Val Recall: 0.6538, Val AUC: 0.6835
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.06it/s]











 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:22<00:01,  3.08it/s]
New threshold is 0.49485519528388977
train F1 is 0.734229564666748
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  7.03it/s]
New threshold is 0.24736890196800232
val F1 is 0.5964912176132202
Epoch 37/62, learning rate: 1.470530712089148e-05
Train Loss: 0.4806, Train Acc: 0.7796, Train f1: 0.7342, Train Precision: 0.7305, Train Recall: 0.7380, Train AUC: 0.8465
Valitadion Loss: 0.8560, Validation Acc: 0.6230, Vall f1: 0.5965, Val Precision: 0.5484, Val Recall: 0.6538, Val AUC: 0.6473
train for epoch 38











100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:23<00:00,  3.05it/s]
New threshold is 0.4430437386035919
train F1 is 0.7538759708404541
val for epoch 38
New threshold is 0.311170369386673
val F1 is 0.6206896305084229
Epoch 38/62, learning rate: 1.4061386715911841e-05
Train Loss: 0.4715, Train Acc: 0.7822, Train f1: 0.7539, Train Precision: 0.7060, Train Recall: 0.8087, Train AUC: 0.8497
Valitadion Loss: 0.7296, Validation Acc: 0.6393, Vall f1: 0.6207, Val Precision: 0.5625, Val Recall: 0.6923, Val AUC: 0.6879
train for epoch 39
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.80it/s]











 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:23<00:00,  3.09it/s]
New threshold is 0.4615894854068756
train F1 is 0.7527093887329102
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:24<00:00,  3.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.95it/s]
  0%|                                                                                           | 0/73 [00:00<?, ?it/s]
New threshold is 0.22815454006195068
val F1 is 0.6153846383094788
Epoch 39/62, learning rate: 1.3396614974060996e-05
Train Loss: 0.4640, Train Acc: 0.7847, Train f1: 0.7527, Train Precision: 0.7154, Train Recall: 0.7942, Train AUC: 0.8561
Valitadion Loss: 0.7922, Validation Acc: 0.6721, Vall f1: 0.6154, Val Precision: 0.6154, Val Recall: 0.6154, Val AUC: 0.7011











100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:24<00:00,  3.04it/s]
  0%|                                                                                            | 0/4 [00:00<?, ?it/s]
New threshold is 0.4720136523246765
train F1 is 0.7487386465072632
val for epoch 40
New threshold is 0.47204309701919556
val F1 is 0.6315789222717285
Epoch 40/62, learning rate: 1.2714404862930523e-05
Train Loss: 0.4488, Train Acc: 0.7864, Train f1: 0.7487, Train Precision: 0.7275, Train Recall: 0.7713, Train AUC: 0.8684
Valitadion Loss: 0.7453, Validation Acc: 0.6557, Vall f1: 0.6316, Val Precision: 0.5806, Val Recall: 0.6923, Val AUC: 0.7165
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.87it/s]











 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:23<00:00,  3.04it/s]
New threshold is 0.4296543598175049
train F1 is 0.7592955231666565
val for epoch 41
New threshold is 0.2694425582885742
val F1 is 0.6000000238418579
Epoch 41/62, learning rate: 1.2018258879472905e-05
Train Loss: 0.4452, Train Acc: 0.7890, Train f1: 0.7593, Train Precision: 0.7172, Train Recall: 0.8067, Train AUC: 0.8700
Valitadion Loss: 0.8296, Validation Acc: 0.6721, Vall f1: 0.6000, Val Precision: 0.6250, Val Recall: 0.5769, Val AUC: 0.6945
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:24<00:00,  3.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.68it/s]











100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:24<00:00,  3.02it/s]
 25%|█████████████████████                                                               | 1/4 [00:00<00:00,  6.52it/s]
New threshold is 0.4361070394515991
train F1 is 0.7638484239578247
val for epoch 42
New threshold is 0.3269449472427368
val F1 is 0.5882353186607361
Epoch 42/62, learning rate: 1.1311751068026944e-05
Train Loss: 0.4352, Train Acc: 0.7916, Train f1: 0.7638, Train Precision: 0.7172, Train Recall: 0.8170, Train AUC: 0.8767
Valitadion Loss: 0.7734, Validation Acc: 0.6557, Vall f1: 0.5882, Val Precision: 0.6000, Val Recall: 0.5769, Val AUC: 0.7275
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.79it/s]











 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:22<00:01,  3.05it/s]
New threshold is 0.47791093587875366
train F1 is 0.7704917788505554
val for epoch 43
New threshold is 0.600470244884491
val F1 is 0.6521739363670349
Epoch 43/62, learning rate: 1.0598508671015642e-05
Train Loss: 0.4201, Train Acc: 0.8079, Train f1: 0.7705, Train Precision: 0.7596, Train Recall: 0.7817, Train AUC: 0.8867
Valitadion Loss: 0.7683, Validation Acc: 0.7377, Vall f1: 0.6522, Val Precision: 0.7500, Val Recall: 0.5769, Val AUC: 0.7231
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:24<00:00,  3.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.71it/s]











 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:23<00:00,  3.04it/s]
New threshold is 0.4621294140815735
train F1 is 0.7809330821037292
val for epoch 44
New threshold is 0.42881080508232117
val F1 is 0.6545454263687134
Epoch 44/62, learning rate: 9.882193506522859e-06
Train Loss: 0.4034, Train Acc: 0.8148, Train f1: 0.7809, Train Precision: 0.7624, Train Recall: 0.8004, Train AUC: 0.8980
Valitadion Loss: 0.7805, Validation Acc: 0.6885, Vall f1: 0.6545, Val Precision: 0.6207, Val Recall: 0.6923, Val AUC: 0.7088
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:24<00:00,  3.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.73it/s]











 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:22<00:01,  3.02it/s]
New threshold is 0.4674202501773834
train F1 is 0.801210880279541
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:24<00:00,  3.00it/s]
 50%|██████████████████████████████████████████                                          | 2/4 [00:00<00:00,  6.39it/s]
New threshold is 0.2088770568370819
val F1 is 0.7272727489471436
Epoch 45/62, learning rate: 9.166483168356895e-06
Train Loss: 0.3965, Train Acc: 0.8310, Train f1: 0.8012, Train Precision: 0.7784, Train Recall: 0.8254, Train AUC: 0.8997
Valitadion Loss: 0.7270, Validation Acc: 0.7541, Vall f1: 0.7273, Val Precision: 0.6897, Val Recall: 0.7692, Val AUC: 0.7516
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.75it/s]











 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:23<00:00,  3.01it/s]
New threshold is 0.431307315826416
train F1 is 0.7849355936050415
val for epoch 46
New threshold is 0.7580748796463013
val F1 is 0.7272727489471436
Epoch 46/62, learning rate: 8.455052145120891e-06
Train Loss: 0.3995, Train Acc: 0.8139, Train f1: 0.7849, Train Precision: 0.7500, Train Recall: 0.8233, Train AUC: 0.8973
Valitadion Loss: 0.6605, Validation Acc: 0.8033, Vall f1: 0.7273, Val Precision: 0.8889, Val Recall: 0.6154, Val AUC: 0.7714
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:24<00:00,  3.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.70it/s]











 92%|███████████████████████████████████████████████████████████████████████████▎      | 67/73 [00:22<00:02,  3.00it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:24<00:00,  3.01it/s]
  0%|                                                                                            | 0/4 [00:00<?, ?it/s]
train F1 is 0.7988450527191162
val for epoch 47
New threshold is 0.39573347568511963
val F1 is 0.6545454263687134
Epoch 47/62, learning rate: 7.751552955225432e-06
Train Loss: 0.3927, Train Acc: 0.8208, Train f1: 0.7988, Train Precision: 0.7437, Train Recall: 0.8628, Train AUC: 0.9024
Valitadion Loss: 0.8206, Validation Acc: 0.6885, Vall f1: 0.6545, Val Precision: 0.6207, Val Recall: 0.6923, Val AUC: 0.7033
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.78it/s]











 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:23<00:01,  3.03it/s]
New threshold is 0.41899028420448303
train F1 is 0.7925636172294617
val for epoch 48
New threshold is 0.3235315680503845
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:24<00:00,  3.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.60it/s]
Epoch 48/62, learning rate: 7.059597394697126e-06
Train Loss: 0.3896, Train Acc: 0.8182, Train f1: 0.7926, Train Precision: 0.7486, Train Recall: 0.8420, Train AUC: 0.9038
Valitadion Loss: 0.6509, Validation Acc: 0.7541, Vall f1: 0.7368, Val Precision: 0.6774, Val Recall: 0.8077, Val AUC: 0.7725
train for epoch 49











 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:23<00:00,  3.02it/s]
New threshold is 0.44879794120788574
train F1 is 0.7979999780654907
val for epoch 49
New threshold is 0.5242469906806946
val F1 is 0.6792452931404114
Epoch 49/62, learning rate: 6.382737994057677e-06
Train Loss: 0.3936, Train Acc: 0.8268, Train f1: 0.7980, Train Precision: 0.7688, Train Recall: 0.8295, Train AUC: 0.9001
Valitadion Loss: 0.6874, Validation Acc: 0.7213, Vall f1: 0.6792, Val Precision: 0.6667, Val Recall: 0.6923, Val AUC: 0.7747
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:24<00:00,  2.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.66it/s]












100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:24<00:00,  2.99it/s]
New threshold is 0.4730274975299835
train F1 is 0.8024691343307495
val for epoch 50
New threshold is 0.2725738286972046
val F1 is 0.6545454263687134
Epoch 50/62, learning rate: 5.724449779474729e-06
Train Loss: 0.3729, Train Acc: 0.8353, Train f1: 0.8025, Train Precision: 0.7943, Train Recall: 0.8108, Train AUC: 0.9131
Valitadion Loss: 0.6946, Validation Acc: 0.6885, Vall f1: 0.6545, Val Precision: 0.6207, Val Recall: 0.6923, Val AUC: 0.7560
train for epoch 51
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.55it/s]
 12%|██████████▏                                                                        | 9/73 [00:03<00:21,  2.95it/s]
 21%|████████████████▊                                                                 | 15/73 [00:05<00:19,  2.99it/s]
 29%|███████████████████████▌                                                          | 21/73 [00:07<00:17,  3.00it/s]
 37%|██████████████████████████████▎                                                   | 27/73 [00:09<00:15,  3.01it/s]
 45%|█████████████████████████████████████                                             | 33/73 [00:11<00:13,  2.98it/s]
 53%|███████████████████████████████████████████▊                                      | 39/73 [00:13<00:11,  3.02it/s]
 62%|██████████████████████████████████████████████████▌                               | 45/73 [00:15<00:09,  2.99it/s]
 70%|█████████████████████████████████████████████████████████▎                        | 51/73 [00:17<00:07,  2.98it/s]
 78%|████████████████████████████████████████████████████████████████                  | 57/73 [00:19<00:05,  2.98it/s]
 86%|██████████████████████████████████████████████████████████████████████▊           | 63/73 [00:21<00:03,  2.99it/s]
 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:23<00:01,  3.01it/s]
 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:23<00:01,  3.01it/s]
New threshold is 0.40987399220466614
train F1 is 0.7980391979217529
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.49it/s]
New threshold is 0.5355962514877319
val F1 is 0.6666666865348816
Epoch 51/62, learning rate: 5.088112431823452e-06
Train Loss: 0.3701, Train Acc: 0.8233, Train f1: 0.7980, Train Precision: 0.7551, Train Recall: 0.8462, Train AUC: 0.9140
Valitadion Loss: 0.7234, Validation Acc: 0.7377, Vall f1: 0.6667, Val Precision: 0.7273, Val Recall: 0.6154, Val AUC: 0.7637
  7%|█████▋                                                                             | 5/73 [00:01<00:23,  2.87it/s]
 15%|████████████▎                                                                     | 11/73 [00:03<00:20,  2.98it/s]
 23%|███████████████████                                                               | 17/73 [00:05<00:18,  3.00it/s]
 32%|█████████████████████████▊                                                        | 23/73 [00:07<00:16,  3.01it/s]
 40%|████████████████████████████████▌                                                 | 29/73 [00:09<00:14,  3.00it/s]
 48%|███████████████████████████████████████▎                                          | 35/73 [00:11<00:12,  3.00it/s]
 56%|██████████████████████████████████████████████                                    | 41/73 [00:13<00:10,  2.99it/s]
 64%|████████████████████████████████████████████████████▊                             | 47/73 [00:15<00:08,  2.99it/s]
 73%|███████████████████████████████████████████████████████████▌                      | 53/73 [00:17<00:06,  2.99it/s]
 81%|██████████████████████████████████████████████████████████████████▎               | 59/73 [00:19<00:04,  2.99it/s]
 89%|█████████████████████████████████████████████████████████████████████████         | 65/73 [00:21<00:02,  2.98it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:23<00:00,  3.00it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:23<00:00,  3.00it/s]
New threshold is 0.4636387228965759
train F1 is 0.8087214827537537
val for epoch 52
New threshold is 0.24200941622257233
val F1 is 0.6296296119689941
Epoch 52/62, learning rate: 4.476992935255127e-06
Train Loss: 0.3717, Train Acc: 0.8345, Train f1: 0.8087, Train Precision: 0.7727, Train Recall: 0.8482, Train AUC: 0.9123
Valitadion Loss: 0.8284, Validation Acc: 0.6721, Vall f1: 0.6296, Val Precision: 0.6071, Val Recall: 0.6538, Val AUC: 0.7209
  0%|                                                                                           | 0/73 [00:00<?, ?it/s]
  8%|██████▊                                                                            | 6/73 [00:02<00:22,  2.92it/s]
 18%|██████████████▌                                                                   | 13/73 [00:04<00:19,  3.01it/s]
 25%|████████████████████▏                                                             | 18/73 [00:06<00:18,  3.00it/s]
 33%|██████████████████████████▉                                                       | 24/73 [00:08<00:16,  2.97it/s]
 41%|█████████████████████████████████▋                                                | 30/73 [00:10<00:14,  2.97it/s]
 49%|████████████████████████████████████████▍                                         | 36/73 [00:12<00:12,  2.98it/s]
 58%|███████████████████████████████████████████████▏                                  | 42/73 [00:14<00:10,  2.97it/s]
 66%|█████████████████████████████████████████████████████▉                            | 48/73 [00:16<00:08,  2.99it/s]
 74%|████████████████████████████████████████████████████████████▋                     | 54/73 [00:18<00:06,  3.01it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 60/73 [00:20<00:04,  2.97it/s]
 90%|██████████████████████████████████████████████████████████████████████████▏       | 66/73 [00:22<00:02,  2.99it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:24<00:00,  2.99it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:24<00:00,  2.99it/s]
New threshold is 0.42348605394363403
train F1 is 0.8060301542282104
val for epoch 53
New threshold is 0.6324387192726135
val F1 is 0.6800000071525574
Epoch 53/62, learning rate: 3.894228804355683e-06
Train Loss: 0.3712, Train Acc: 0.8345, Train f1: 0.8060, Train Precision: 0.7802, Train Recall: 0.8337, Train AUC: 0.9130
Valitadion Loss: 0.6864, Validation Acc: 0.7377, Vall f1: 0.6800, Val Precision: 0.7083, Val Recall: 0.6538, Val AUC: 0.7626
  3%|██▎                                                                                | 2/73 [00:00<00:29,  2.45it/s]
 11%|█████████                                                                          | 8/73 [00:02<00:22,  2.93it/s]
 19%|███████████████▋                                                                  | 14/73 [00:04<00:19,  2.97it/s]
 27%|██████████████████████▍                                                           | 20/73 [00:06<00:17,  2.95it/s]
 36%|█████████████████████████████▏                                                    | 26/73 [00:08<00:15,  2.97it/s]
 44%|███████████████████████████████████▉                                              | 32/73 [00:10<00:13,  2.98it/s]
 52%|██████████████████████████████████████████▋                                       | 38/73 [00:12<00:11,  2.96it/s]
 60%|█████████████████████████████████████████████████▍                                | 44/73 [00:14<00:09,  2.95it/s]
 68%|████████████████████████████████████████████████████████▏                         | 50/73 [00:16<00:07,  2.97it/s]
 77%|██████████████████████████████████████████████████████████████▉                   | 56/73 [00:18<00:05,  2.95it/s]
 85%|█████████████████████████████████████████████████████████████████████▋            | 62/73 [00:21<00:03,  2.97it/s]
 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:23<00:01,  2.96it/s]
 93%|████████████████████████████████████████████████████████████████████████████▍     | 68/73 [00:23<00:01,  2.96it/s]
New threshold is 0.46095025539398193
train F1 is 0.8263959288597107
 25%|█████████████████████                                                               | 1/4 [00:00<00:00,  6.01it/s]
 25%|█████████████████████                                                               | 1/4 [00:00<00:00,  6.01it/s]
New threshold is 0.28355643153190613
val F1 is 0.6428571343421936
Epoch 54/62, learning rate: 3.3428119760067316e-06
Train Loss: 0.3462, Train Acc: 0.8533, Train f1: 0.8264, Train Precision: 0.8075, Train Recall: 0.8462, Train AUC: 0.9280
Valitadion Loss: 0.8091, Validation Acc: 0.6721, Vall f1: 0.6429, Val Precision: 0.6000, Val Recall: 0.6923, Val AUC: 0.7209
  5%|████▌                                                                              | 4/73 [00:01<00:24,  2.77it/s]
 12%|██████████▏                                                                        | 9/73 [00:03<00:21,  2.94it/s]
 21%|████████████████▊                                                                 | 15/73 [00:05<00:19,  2.98it/s]
 29%|███████████████████████▌                                                          | 21/73 [00:07<00:17,  2.99it/s]
 37%|██████████████████████████████▎                                                   | 27/73 [00:09<00:15,  2.96it/s]
 45%|█████████████████████████████████████                                             | 33/73 [00:11<00:13,  2.97it/s]
 53%|███████████████████████████████████████████▊                                      | 39/73 [00:13<00:11,  2.99it/s]
 62%|██████████████████████████████████████████████████▌                               | 45/73 [00:15<00:09,  2.96it/s]
 70%|█████████████████████████████████████████████████████████▎                        | 51/73 [00:17<00:07,  2.96it/s]
 78%|████████████████████████████████████████████████████████████████                  | 57/73 [00:19<00:05,  2.96it/s]
 86%|██████████████████████████████████████████████████████████████████████▊           | 63/73 [00:21<00:03,  2.97it/s]
 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:23<00:01,  2.94it/s]
 95%|█████████████████████████████████████████████████████████████████████████████▌    | 69/73 [00:23<00:01,  2.94it/s]
New threshold is 0.4371384382247925
train F1 is 0.8447082042694092
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  6.34it/s]
New threshold is 0.5063945055007935
val F1 is 0.6800000071525574
Epoch 55/62, learning rate: 2.8255734486489703e-06
Train Loss: 0.3296, Train Acc: 0.8654, Train f1: 0.8447, Train Precision: 0.8057, Train Recall: 0.8877, Train AUC: 0.9346
Valitadion Loss: 0.7544, Validation Acc: 0.7377, Vall f1: 0.6800, Val Precision: 0.7083, Val Recall: 0.6538, Val AUC: 0.7626
  7%|█████▋                                                                             | 5/73 [00:01<00:24,  2.79it/s]
 14%|███████████▏                                                                      | 10/73 [00:03<00:21,  2.93it/s]
 22%|█████████████████▉                                                                | 16/73 [00:05<00:19,  2.93it/s]
 30%|████████████████████████▋                                                         | 22/73 [00:07<00:17,  2.96it/s]
 38%|███████████████████████████████▍                                                  | 28/73 [00:09<00:15,  2.95it/s]
 47%|██████████████████████████████████████▏                                           | 34/73 [00:11<00:13,  2.95it/s]
 55%|████████████████████████████████████████████▉                                     | 40/73 [00:13<00:11,  2.97it/s]
 63%|███████████████████████████████████████████████████▋                              | 46/73 [00:15<00:09,  2.95it/s]
 71%|██████████████████████████████████████████████████████████▍                       | 52/73 [00:17<00:07,  2.95it/s]
 79%|█████████████████████████████████████████████████████████████████▏                | 58/73 [00:19<00:05,  2.97it/s]
 88%|███████████████████████████████████████████████████████████████████████▉          | 64/73 [00:21<00:03,  2.96it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:23<00:01,  2.95it/s]
 96%|██████████████████████████████████████████████████████████████████████████████▋   | 70/73 [00:23<00:01,  2.95it/s]
New threshold is 0.4596722722053528
train F1 is 0.8246153593063354
val for epoch 56
New threshold is 0.27218589186668396
val F1 is 0.6909090876579285
Epoch 56/62, learning rate: 2.3451687478107256e-06
Train Loss: 0.3383, Train Acc: 0.8533, Train f1: 0.8246, Train Precision: 0.8138, Train Recall: 0.8358, Train AUC: 0.9299
Valitadion Loss: 0.7321, Validation Acc: 0.7213, Vall f1: 0.6909, Val Precision: 0.6552, Val Recall: 0.7308, Val AUC: 0.7681
  0%|                                                                                           | 0/73 [00:00<?, ?it/s]
  8%|██████▊                                                                            | 6/73 [00:02<00:23,  2.89it/s]
 16%|█████████████▍                                                                    | 12/73 [00:04<00:20,  2.96it/s]
 23%|███████████████████                                                               | 17/73 [00:05<00:18,  2.98it/s]
 32%|█████████████████████████▊                                                        | 23/73 [00:07<00:16,  2.95it/s]
 40%|████████████████████████████████▌                                                 | 29/73 [00:09<00:14,  2.96it/s]
 48%|███████████████████████████████████████▎                                          | 35/73 [00:12<00:12,  2.96it/s]
 56%|██████████████████████████████████████████████                                    | 41/73 [00:14<00:10,  2.96it/s]
 64%|████████████████████████████████████████████████████▊                             | 47/73 [00:16<00:08,  3.00it/s]
 73%|███████████████████████████████████████████████████████████▌                      | 53/73 [00:18<00:06,  2.97it/s]
 81%|██████████████████████████████████████████████████████████████████▎               | 59/73 [00:20<00:04,  2.94it/s]
 89%|█████████████████████████████████████████████████████████████████████████         | 65/73 [00:22<00:02,  2.94it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:24<00:00,  2.92it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:24<00:00,  2.92it/s]
New threshold is 0.43664810061454773
train F1 is 0.8316633105278015
val for epoch 57
New threshold is 0.21752287447452545
val F1 is 0.6785714030265808
Epoch 57/62, learning rate: 1.9040642925221363e-06
Train Loss: 0.3480, Train Acc: 0.8559, Train f1: 0.8317, Train Precision: 0.8027, Train Recall: 0.8628, Train AUC: 0.9233
Valitadion Loss: 0.8019, Validation Acc: 0.7049, Vall f1: 0.6786, Val Precision: 0.6333, Val Recall: 0.7308, Val AUC: 0.7264
  1%|█▏                                                                                 | 1/73 [00:00<00:37,  1.90it/s]
  8%|██████▊                                                                            | 6/73 [00:02<00:23,  2.87it/s]
 16%|█████████████▍                                                                    | 12/73 [00:04<00:20,  2.91it/s]
 25%|████████████████████▏                                                             | 18/73 [00:06<00:18,  2.94it/s]
 33%|██████████████████████████▉                                                       | 24/73 [00:08<00:16,  2.92it/s]
 41%|█████████████████████████████████▋                                                | 30/73 [00:10<00:14,  2.93it/s]
 49%|████████████████████████████████████████▍                                         | 36/73 [00:12<00:12,  2.96it/s]
 58%|███████████████████████████████████████████████▏                                  | 42/73 [00:14<00:10,  2.94it/s]
 66%|█████████████████████████████████████████████████████▉                            | 48/73 [00:16<00:08,  2.90it/s]
 73%|███████████████████████████████████████████████████████████▌                      | 53/73 [00:18<00:06,  2.94it/s]
 81%|██████████████████████████████████████████████████████████████████▎               | 59/73 [00:20<00:04,  2.96it/s]
 89%|█████████████████████████████████████████████████████████████████████████         | 65/73 [00:22<00:02,  2.96it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:24<00:00,  2.93it/s]
 97%|███████████████████████████████████████████████████████████████████████████████▊  | 71/73 [00:24<00:00,  2.93it/s]
New threshold is 0.4969838857650757
train F1 is 0.8329854011535645
val for epoch 58
New threshold is 0.37666404247283936
val F1 is 0.6538461446762085
Epoch 58/62, learning rate: 1.5045247326105404e-06
Train Loss: 0.3433, Train Acc: 0.8628, Train f1: 0.8330, Train Precision: 0.8365, Train Recall: 0.8295, Train AUC: 0.9276
Valitadion Loss: 0.8364, Validation Acc: 0.7049, Vall f1: 0.6538, Val Precision: 0.6538, Val Recall: 0.6538, Val AUC: 0.7451
  1%|█▏                                                                                 | 1/73 [00:00<00:38,  1.89it/s]
 10%|███████▉                                                                           | 7/73 [00:02<00:23,  2.86it/s]
 18%|██████████████▌                                                                   | 13/73 [00:04<00:20,  2.91it/s]
 26%|█████████████████████▎                                                            | 19/73 [00:06<00:18,  2.93it/s]
 34%|████████████████████████████                                                      | 25/73 [00:08<00:16,  2.93it/s]
 41%|█████████████████████████████████▋                                                | 30/73 [00:10<00:14,  2.94it/s]
 49%|████████████████████████████████████████▍                                         | 36/73 [00:12<00:12,  2.94it/s]
 58%|███████████████████████████████████████████████▏                                  | 42/73 [00:14<00:10,  2.94it/s]
 66%|█████████████████████████████████████████████████████▉                            | 48/73 [00:16<00:08,  2.92it/s]
 74%|████████████████████████████████████████████████████████████▋                     | 54/73 [00:18<00:06,  2.96it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 60/73 [00:20<00:04,  2.95it/s]
 90%|██████████████████████████████████████████████████████████████████████████▏       | 66/73 [00:22<00:02,  2.94it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:24<00:00,  2.92it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:24<00:00,  2.92it/s]
New threshold is 0.38050392270088196
train F1 is 0.833984375
val for epoch 59
New threshold is 0.12170574069023132
val F1 is 0.7368420958518982
Epoch 59/62, learning rate: 1.1486013218878658e-06
Train Loss: 0.3279, Train Acc: 0.8542, Train f1: 0.8340, Train Precision: 0.7864, Train Recall: 0.8877, Train AUC: 0.9342
Valitadion Loss: 0.7887, Validation Acc: 0.7541, Vall f1: 0.7368, Val Precision: 0.6774, Val Recall: 0.8077, Val AUC: 0.7516
  1%|█▏                                                                                 | 1/73 [00:00<00:37,  1.93it/s]
 10%|███████▉                                                                           | 7/73 [00:02<00:22,  2.87it/s]
 18%|██████████████▌                                                                   | 13/73 [00:04<00:20,  2.95it/s]
 26%|█████████████████████▎                                                            | 19/73 [00:06<00:18,  2.90it/s]
 34%|████████████████████████████                                                      | 25/73 [00:08<00:16,  2.93it/s]
 42%|██████████████████████████████████▊                                               | 31/73 [00:10<00:14,  2.92it/s]
 51%|█████████████████████████████████████████▌                                        | 37/73 [00:12<00:12,  2.95it/s]
 59%|████████████████████████████████████████████████▎                                 | 43/73 [00:14<00:10,  2.95it/s]
 66%|█████████████████████████████████████████████████████▉                            | 48/73 [00:16<00:08,  2.94it/s]
 74%|████████████████████████████████████████████████████████████▋                     | 54/73 [00:18<00:06,  2.95it/s]
 82%|███████████████████████████████████████████████████████████████████▍              | 60/73 [00:20<00:04,  2.93it/s]
 90%|██████████████████████████████████████████████████████████████████████████▏       | 66/73 [00:22<00:02,  2.93it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:24<00:00,  2.94it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:24<00:00,  2.94it/s]
New threshold is 0.4343753755092621
train F1 is 0.8426395654678345
val for epoch 60
New threshold is 0.6015892028808594
val F1 is 0.6122449040412903
Epoch 60/62, learning rate: 8.381213869226201e-07
Train Loss: 0.3324, Train Acc: 0.8671, Train f1: 0.8426, Train Precision: 0.8234, Train Recall: 0.8628, Train AUC: 0.9323
Valitadion Loss: 0.8320, Validation Acc: 0.6885, Vall f1: 0.6122, Val Precision: 0.6522, Val Recall: 0.5769, Val AUC: 0.7209
  3%|██▎                                                                                | 2/73 [00:00<00:29,  2.42it/s]
 11%|█████████                                                                          | 8/73 [00:02<00:22,  2.90it/s]
 19%|███████████████▋                                                                  | 14/73 [00:04<00:20,  2.95it/s]
 26%|█████████████████████▎                                                            | 19/73 [00:06<00:18,  2.92it/s]
 34%|████████████████████████████                                                      | 25/73 [00:08<00:16,  2.94it/s]
 42%|██████████████████████████████████▊                                               | 31/73 [00:10<00:14,  2.96it/s]
 51%|█████████████████████████████████████████▌                                        | 37/73 [00:12<00:12,  2.96it/s]
 59%|████████████████████████████████████████████████▎                                 | 43/73 [00:14<00:10,  2.94it/s]
 67%|███████████████████████████████████████████████████████                           | 49/73 [00:16<00:08,  2.93it/s]
 75%|█████████████████████████████████████████████████████████████▊                    | 55/73 [00:18<00:06,  2.91it/s]
 84%|████████████████████████████████████████████████████████████████████▌             | 61/73 [00:20<00:04,  2.93it/s]
 90%|██████████████████████████████████████████████████████████████████████████▏       | 66/73 [00:22<00:02,  2.94it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:24<00:00,  2.91it/s]
 99%|████████████████████████████████████████████████████████████████████████████████▉ | 72/73 [00:24<00:00,  2.91it/s]
New threshold is 0.4147019386291504
train F1 is 0.8288288116455078
val for epoch 61
New threshold is 0.3210269808769226
val F1 is 0.6666666865348816
Epoch 61/62, learning rate: 5.746789454643014e-07
Train Loss: 0.3354, Train Acc: 0.8533, Train f1: 0.8288, Train Precision: 0.7992, Train Recall: 0.8607, Train AUC: 0.9308
Valitadion Loss: 0.8009, Validation Acc: 0.7213, Vall f1: 0.6667, Val Precision: 0.6800, Val Recall: 0.6538, Val AUC: 0.7374
  3%|██▎                                                                                | 2/73 [00:00<00:29,  2.45it/s]
 11%|█████████                                                                          | 8/73 [00:02<00:22,  2.90it/s]
 19%|███████████████▋                                                                  | 14/73 [00:04<00:20,  2.91it/s]
 27%|██████████████████████▍                                                           | 20/73 [00:06<00:17,  2.94it/s]
 36%|█████████████████████████████▏                                                    | 26/73 [00:09<00:15,  2.94it/s]
 44%|███████████████████████████████████▉                                              | 32/73 [00:11<00:13,  2.94it/s]
 51%|█████████████████████████████████████████▌                                        | 37/73 [00:12<00:12,  2.91it/s]
 59%|████████████████████████████████████████████████▎                                 | 43/73 [00:14<00:10,  2.94it/s]
 67%|███████████████████████████████████████████████████████                           | 49/73 [00:16<00:08,  2.91it/s]
 75%|█████████████████████████████████████████████████████████████▊                    | 55/73 [00:18<00:06,  2.93it/s]
 84%|████████████████████████████████████████████████████████████████████▌             | 61/73 [00:20<00:04,  2.94it/s]
 92%|███████████████████████████████████████████████████████████████████████████▎      | 67/73 [00:23<00:02,  2.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:25<00:00,  2.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 73/73 [00:25<00:00,  2.91it/s]
New threshold is 0.4494415819644928
train F1 is 0.8379999995231628
val for epoch 62
New threshold is 0.42609694600105286
val F1 is 0.6538461446762085
Epoch 62/62, learning rate: 3.596265226855932e-07
Train Loss: 0.3334, Train Acc: 0.8611, Train f1: 0.8380, Train Precision: 0.8073, Train Recall: 0.8711, Train AUC: 0.9315
Valitadion Loss: 0.7796, Validation Acc: 0.7049, Vall f1: 0.6538, Val Precision: 0.6538, Val Recall: 0.6538, Val AUC: 0.7418
Training complete in 25m 29s
Best val auc: 0.736842
  0%|                                                                                           | 0/18 [00:00<?, ?it/s]
 28%|███████████████████████                                                            | 5/18 [00:05<00:07,  1.70it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 13/18 [00:07<00:01,  3.89it/s]
 72%|███████████████████████████████████████████████████████████▏                      | 13/18 [00:07<00:01,  3.89it/s]
New threshold is 0.3713696002960205
Inference complete in 0m 8s
F1 Score = : 0.707224
AUC Score = : 0.771197
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:08<00:00,  2.20it/s]
100%|██████████████████████████████████████████████████████████████████████████████████| 18/18 [00:08<00:00,  2.20it/s]